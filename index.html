<!--
  Copyright 2020-2023 PicClick Inc. All Rights Reserved.
  
  https://dkb.io/post/google-search-is-dying
  https://news.ycombinator.com/item?id=30347719
  https://www.reddit.com/r/technology/comments/st9ri1/google_search_is_dying/
  https://www.androidauthority.com/reddit-web-search-queries-poll-results-3119551/
  https://www.theverge.com/23365101/tiktok-search-google-replacement
-->
<!doctype html>
<html lang="en">
<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-P5GVTM8EJR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-P5GVTM8EJR');
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="referrer" content="origin">
  <meta name="description" content="Search Google, YouTube, Instagram, TikTok, Twitter, Reddit, Amazon, Images, News, &amp; more. See all results by swiping — no clicking."/>
  <meta property="og:url" content="https://swurl.com/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="Swurl"/>
  <meta property="og:title" content="Swurl - Search everything"/>
  <meta property="og:description" content="Search Google, YouTube, Instagram, TikTok, Twitter, Reddit, Amazon, Images, News, &amp; more. See all results by swiping — no clicking."/>
  <meta property="og:image" content="https://swurl.com/img/swurl.com-screenshot.png"/>
  <meta property="fb:app_id" content="651139363411277"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:site" content="@swurl"/>
  <meta name="twitter:title" content="Swurl - Search everything"/>
  <meta name="twitter:description" content="Search Google, YouTube, Instagram, TikTok, Twitter, Reddit, Amazon, Images, News, &amp; more. See all results by swiping — no clicking."/>
  <meta name="twitter:image" content="https://swurl.com/img/swurl.com-screenshot.png"/>
  <meta name="apple-mobile-web-app-title" content="Swurl"/>
  <meta name="application-name" content="Swurl"/>
  <title>Swurl - Search everything</title>
  <link rel="preload" href="https://swurl.com/swurl.png" as="image"/>
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.2/jquery.min.js" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.10.5/typeahead.bundle.min.js" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.bundle.min.js" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-duration-format/2.3.2/moment-duration-format.min.js" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    var language = navigator.languages && navigator.languages[0] || navigator.language || navigator.userLanguage;    // https://zzz.buzz/2016/01/13/detect-browser-language-in-javascript/
    var LANG = language.slice(0, 2).toLowerCase();
    var COUNTRY = language.slice(3, 5).toLowerCase();
    if(COUNTRY=='gb')
      COUNTRY = 'uk';
    document.getElementsByTagName('html')[0].setAttribute('lang', LANG);
    if(LANG=='ar')
    {
      document.write('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.rtl.min.css" integrity="sha512-tC3gnye8BsHmrW3eRP3Nrj/bs+CSVUfzkjOlfLNrfvcbKXFxk5+b8dQCZi9rgVFjDudwipXfqEhsKMMgRZGCDw==" crossorigin="anonymous" referrerpolicy="no-referrer" />');
      document.getElementsByTagName('html')[0].setAttribute('dir', 'rtl');
    }
    else
      document.write('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css" integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA==" crossorigin="anonymous" referrerpolicy="no-referrer" />');
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"/>
  <script type="application/ld+json">
    {
      "@context":"http://schema.org",
      "@type":"Organization",
      "name":"Swurl",
      "url":"https://swurl.com/",
      "logo":"https://swurl.com/swurl.png",
      "foundingDate":"2020"
    }
  </script>
  <script type="application/ld+json">
    {
      "@context":"http://schema.org",
      "@type":"WebSite",
      "name":"Swurl",
      "url":"https://swurl.com/",
      "potentialAction":{
        "@type":"SearchAction",
        "target":"https://swurl.com/?q={search_term_string}",
        "query-input":"required name=search_term_string"
      }
    }
  </script>
  <link rel="apple-touch-icon" sizes="180x180" href="https://swurl.com/apple-touch-icon.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="https://swurl.com/favicon-32x32.png"/>
  <link rel="icon" type="image/png" sizes="16x16" href="https://swurl.com/favicon-16x16.png"/>
  <link rel="shortcut icon" href="https://swurl.com/favicon.ico"/>
  <link rel="manifest" href="https://swurl.com/site.webmanifest"/>
  <link rel="mask-icon" href="https://swurl.com/safari-pinned-tab.svg" color="#333333"/>
  <meta name="msapplication-TileColor" content="#ffffff"/>
  <meta name="theme-color" content="#ffffff"/>
  <link rel="search" href="https://swurl.com/opensearch.php" type="application/opensearchdescription+xml" title="Swurl"/>
<style>
:root{
  --bs-light-rgb:224, 224, 224;
  --bs-dark-rgb:17,17,17;          /* .border-dark .text-dark .bg-dark */
  --bs-body-color-rgb:34,34,34;    /* .text-body */
  --bs-body-color:#222;
  --bs-border-color:#ddd;
}
body{
  position:relative;
  min-height:100vh;
  min-height:-webkit-fill-available;
  overflow:hidden;
}
body > .alert{
  position:fixed;
  bottom:16px;
  right:16px;
  min-width:280px;
  z-index:1000;
}
html{
  height:-webkit-fill-available;
}
nav{
  z-index:1031!important;;
}
nav .dropdown-toggle{
  outline:none;
}
.alert-secondary{
  --bs-alert-color:#444;
  --bs-alert-bg:#f6f6f6;
  --bs-alert-border-color:#e6e6e6;
}
.form-control:focus{
  box-shadow:none;
}
.form-control::placeholder{
  color:rgb(13,119,253);
color:#bbb;
font-weight:normal;
}
.text-danger{
  font-weight:600;
  color:#ff0000!important;
}
.btn-light{
  --bs-btn-bg:#eee;
  --bs-btn-border-color:#eee;
  --bs-btn-hover-bg:#ddd;
  --bs-btn-hover-border-color:#ddd;
  --bs-btn-active-bg:#ccc;
  --bs-btn-active-border-color:#ccc;
}
.btn-dark{
  --bs-btn-bg:#333;
  --bs-btn-border-color:#333;
  --bs-btn-hover-bg: #222;
  --bs-btn-hover-border-color:#222;
  --bs-btn-active-bg:#111;
  --bs-btn-active-border-color:#111;
}
.btn-outline-secondary{
  --bs-btn-color:#888;
  --bs-btn-border-color:#999;
  --bs-btn-hover-color:#fff;
  --bs-btn-hover-bg:#999;
  --bs-btn-hover-border-color:#999;
  --bs-btn-active-color:#fff;
  --bs-btn-active-bg:#888;
  --bs-btn-active-border-color:#888;
}
.btn-light{
  --bs-btn-bg:#eee;
  --bs-btn-border-color:#eee;
  --bs-btn-hover-bg:#ddd;
  --bs-btn-hover-border-color:#ddd;
  --bs-btn-active-bg:#ccc;
  --bs-btn-active-border-color:#ccc;
}
.btn-clear{
  --bs-btn-color:rgba(0, 0, 0, 0.2);
  --bs-btn-hover-color:rgba(0, 0, 0, 0.7);
  --bs-btn-active-color:rgba(0, 0, 0, 0.9);
  --bs-btn-active-border-color:rgba(0, 0, 0, 0);
}
main>div.flex-column > .dropdown{
  z-index:1000;
}
main>div.flex-column > .dropdown .btn-sm{
  --bs-btn-padding-x:1rem;
}
.btn-tab{
  border-width:0;
  border-bottom-width:3px;
  --bs-btn-color:#444;
  --bs-btn-border-color:#fff;
  --bs-btn-border-radius:0;
  --bs-btn-hover-color:#444;
  --bs-btn-hover-bg:transparent;
  --bs-btn-hover-border-color:#bbb;
  --bs-btn-active-color:#444;
  --bs-btn-active-bg:transparent;
  --bs-btn-active-border-color:#444;
}
@media (hover:none){
  .btn-tab{
    --bs-btn-hover-color:#444;
    --bs-btn-hover-bg:transparent;
    --bs-btn-hover-border-color:#fff;
  }
}
#search{
  position:relative;
}
#search #q{
  caret-color:rgb(13,119,253);
  padding-left:44px;
  padding-right:44px;
  color:#000;
font-weight:500;
  background-color:#f4f4f4!important;
  border:1px solid transparent!important;
}
#search #q::-ms-clear{
  display:none;
}
#search .btn-link{
  color:#808080;
}
#search .btn{
  border-color:transparent;
  box-shadow:none;
  -moz-user-select:none;
  -webkit-user-select:none;
  -ms-user-select:none;
  user-select:none;
}
#search #reset{
  display:none;
  color:#808080;
  background-color:transparent;
  outline:none;
  -moz-user-select:none;
  -webkit-user-select:none;
  -ms-user-select:none;
  user-select:none;
}
#search.filled #reset{
  display:block;
}
#scrollto{
  top:64px;
  z-index:800;
  /*FireFox*/
  scrollbar-width:none;
  /*IE10+*/
  -ms-overflow-style:-ms-autohiding-scrollbar;
}
#scrollto::-webkit-scrollbar{
  display:none;
}
#scrollto .list-inline-item{
  margin:0;
}
#scrollto .list-inline-item .btn{
  position:relative;
  width:42px;
  height:38px;
  padding-left:0;
  padding-right:0;
}
#share{
  top:64px;
  z-index:1000;
display:none!important;
}
body.homepage{
  margin:0 auto;
  padding-top:32vh;
  max-width:550px;
  overflow:visible;
}
body.homepage .fixed-top{
  position:static;
}
body.homepage #share{
  position:static!important;
  display:block!important;
  padding-left:0!important;
  padding-right:0!important;
  text-align:center;
display:none!important;
}
body.homepage main{
  display:none!important;
}
main{
  position:relative;
  height:100vh;
  height:-webkit-fill-available;
  max-height:100vh;
  overflow-x:auto;
  overflow-y:hidden;
  scroll-snap-type:x mandatory;
//  -webkit-overflow-scrolling:touch;    /* Fixes bug with scrollbar disappearing in iOS */
  scrollbar-width:none;
  /*IE10+*/
  -ms-overflow-style:-ms-autohiding-scrollbar;
  overscroll-behavior-x:contain;    // Based on HN feedback... https://news.ycombinator.com/item?id=33263923
}
main::-webkit-scrollbar{
  display:none;
}
main>div.flex-column{
  position:relative;
  margin-top:65px;
margin-top:118px;
  width:336px;
width:352px;
  scroll-snap-align:start;
}
main>div#instagram.flex-column blockquote{
  margin-bottom:0;
  min-height:268px;
  background-color:#fff;
}
main>div#instagram.flex-column iframe{
  margin-bottom:0!important;
  min-width:320px!important;
}
@media (min-width: 1200px){
  main>div#web.flex-column{
//    width:428px;
  }
}
main>div.flex-column>a{
//  border-bottom:1px solid rgba(0, 0, 0, .04);
  font-size:18px;
  font-weight:500;
  z-index:1;
}
main>div.flex-column>a.shadowbelow{
  box-shadow:rgb(0 0 0 / 12%) 0px 8px 8px -8px;
}
@media (max-width:414px){
  main>div.flex-column>a{
//    display:none;
  }
}
.list-group{
  --bs-list-group-color:#222;
}
#scrollto .list-inline-item .btn img{
  margin-top:2px;
  width:16px;
  height:16px;
  vertical-align:text-top;
//  -webkit-filter:grayscale(100%); /* Safari 6.0 - 9.0 */
//  filter:grayscale(100%);
}
main>div.flex-column>a>img{
  margin-top:3px;
  width:16px;
  height:16px;
  vertical-align:text-top;
//  -webkit-filter:grayscale(100%); /* Safari 6.0 - 9.0 */
//  filter:grayscale(100%);
}
main>div.flex-column>a:hover>.text{
  text-decoration:underline;
}
.scrollarea{
  overflow-x:hidden;
  overflow-y:auto;
//  -webkit-overflow-scrolling:touch; /* Fixes bug with scrollbar disappearing in iOS */
//  -webkit-transform:translate3d(0, 0, 0);   /* https://stackoverflow.com/questions/9807620/ipad-safari-scrolling-causes-html-elements-to-disappear-and-reappear-with-a-dela */
  will-change:transform;    /* Can use will-change instead of translate3d https://developer.mozilla.org/en-US/docs/Web/CSS/will-change */
}


// https://stackoverflow.com/questions/9060421/css3-how-to-restore-webkit-scrollbar-property-to-the-default-scroll-bar
.scrollarea::-webkit-scrollbar {
//  width: 7px;
}
.scrollarea::-webkit-scrollbar-track {
//  background:transparent;
}
.scrollarea::-webkit-scrollbar-thumb {
//  background-color:rgb(70, 70, 70);
//  border-radius:3px;
}
.scrollarea::-webkit-scrollbar-thumb:window-inactive {
//  background: none;
}





.b-example-divider{
  margin-top:68px;
margin-top:114px;
  background-color:transparent;
  border-left:1px solid rgba(0, 0, 0, .12);
}
.b-example-vr{
  flex-shrink:0;
  width:1px;
  height:100vh;
}
.b-example-vr:last-child{
//  padding-right:120px;
//padding-right:100vw;
}
ol li a{
  text-decoration:none !important;
}
ol li a h5{
//  max-height:48px;
  overflow:hidden;
  display:-webkit-box;
//  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
}
ol li a h6{
  overflow:hidden;
}
ol li a:hover h5,
ol li a:hover h6,
ol li.amazon a:hover div,
ol li ul li a:hover,
ol li a.alert-link:hover,
ol li a:hover span.givenname,
ol li a.datepublished:hover{
  text-decoration:underline!important;
}
/* https://ferie.medium.com/detect-a-touch-device-with-only-css-9f8e30fa1134 */
@media (hover: none) and (pointer: coarse){
  ol li a:hover h5,
  ol li a:hover h6,
  ol li.amazon a:hover div,
  ol li ul li a:hover,
  ol li a.alert-link:hover{
    text-decoration:none;
  }
}
#images ol li a:hover>div>div.text-truncate{
  text-decoration:underline;
}
/* https://ferie.medium.com/detect-a-touch-device-with-only-css-9f8e30fa1134 */
@media (hover: none) and (pointer: coarse){
  #images ol li a:hover>div>div.text-truncate{
    text-decoration:none;
  }
}
#web ol li > a:visited:not(:active):not(:focus):not(.btn){
  color:#6a29b9;
}
ol li > div.snippet{
//  max-height:52.5px;
  overflow:hidden;
//  display:-webkit-box;
//  -webkit-line-clamp:3;
//  -webkit-box-orient:vertical;
}
ol li > div.snippet.more{
//  max-height:70px;
//  -webkit-line-clamp:4;
}
.url{
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.url img{
  margin-top:2px;
  width:13px;
  height:13px;
  vertical-align:text-top;
}
.frame{
  position:relative;
  overflow:hidden;
  z-index:1;    /* Fix for overflow hidden in Safari for placeholder rounded-1 opacity https://stackoverflow.com/questions/42297303/css-opacity-transition-ignoring-overflowhidden-in-chrome-safari */
}
.s-image-overlay-grey.border{
  border-color:#f0f0f0!important;
}
.s-image-overlay-grey:after{
  position:absolute;
  content:'';
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:#000;
  opacity:.03;
  pointer-events:none;
}
/* For speed for many large images https://stackoverflow.com/questions/16071260/down-sized-images-are-slow-in-chrome */
#images .frame img{
  image-rendering:-webkit-optimize-contrast;
}
#web .frame,
#reddit .frame{
  max-height:110px;
}
#stock .tradingview-widget-container{
  width:320px;
  height:320px;
  background-color:#111!important;
  border-color:#111!important;
  will-change:transform;  /* Fixes problem with border-radius and overflow hidden and ifrmae? https://stackoverflow.com/questions/14383632/webkit-border-radius-and-overflow-bug-when-using-any-animation-transition/16681137 */
}
#stock .tradingview-widget-container > div{
  position:relative;
  top:-1px;
  left:-1px;
  width:320px;
  height:320px;
}
#map{
  min-height:240px;
}
#map iframe{
  width:100%;
  height:100%;
}
@media (min-width: 1200px){
  #map{
//    min-height:380px;
  }
}
#news h6{
//  font-family:georgia,'times new roman',times,serif;
  font-weight:700;
//  line-height:1.3;
}
#youtube .frame{
  width:100%;
  padding-bottom:56.25%;
}
#youtube .frame img{
  position:absolute;
  top:-16.6666%;
  z-index:1;
}
#youtube .frame .overlay{
//  background-color:rgba(0,0,0,.05);
  height:100%;
  left:0;
  position:absolute;
  top:0;
  width:100%;
  z-index:2;
}
#youtube .frame .overlay .play{
  position:absolute;
  background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4IiBmaWxsPSIjZmZmIj48cGF0aCBkPSJNMjQgNEMxMi45NSA0IDQgMTIuOTUgNCAyNHM4Ljk1IDIwIDIwIDIwIDIwLTguOTUgMjAtMjBTMzUuMDUgNCAyNCA0em0tNCAyOVYxNWwxMiA5LTEyIDl6Ii8+PC9zdmc+);
  background-size:88px 88px;
  bottom:0;
  color:#fff;
  left:0;
  height:88px;
  margin:auto;
  opacity:0.8;
  right:0;
  top:0;
  width:88px;
}
#youtube .duration{
  position:absolute;
  right:6px;
  bottom:6px;
  padding:3px 5px;
  font-size:12px;
  font-weight:500;
  color:#fff;
  background-color:rgba(0, 0, 0, 0.6);
  border-radius:2px;
  overflow:hidden;
  z-index:3;
}
#youtube iframe{
  position:absolute;
  z-index:100;
}
#images .size{
  position:absolute;
  left:0;
  bottom:0;
  padding:4px 8px;
  font-size:12px;
  font-weight:500;
  color:#fff;
  background-color:rgba(0, 0, 0, 0.6);
  border-top-right-radius:2px;
}
#twitter div.twitter-timeline{
//  margin:-4px -4px -10px!important;
//  max-width:360px!important;
  max-width:320px!important;
}
.prime{
  font-weight:bold;
  color:#2192c1;
}
#ebay h6 small{
  font-weight:normal;
  font-size:13px;
}
#weather{
  min-height:208px!important;
  will-change:transform;
}
#wikipedia ul{
  margin-bottom:16px;
}
#tweets ol li:hover{
  background-color:rgba(0, 0, 0, 0.03);
  cursor:pointer;
}
#tweets ol li .snippet a{
  color:rgb(29, 155, 240);
}
#tweets ol li .snippet a:hover{
  text-decoration:underline!important;;
}
#tweets ol li .frame{
  margin-top:12px!important;
}
#tweets ol li a.tweet i.fa-comment,
#tweets ol li a.retweet i.fa-retweet,
#tweets ol li a.like i.fa-heart{
  display:inline-block;
  padding:10px 0;
  width:34px;
  text-align:center;
  border-radius:20px;
}
#tweets ol li a.tweet:hover{
  color:rgb(29, 155, 240)!important;
}
#tweets ol li a.tweet:hover i.fa-comment{
  background-color:rgba(29, 155, 240, 0.1);
}
#tweets ol li a.retweet:hover{
  color:rgb(0, 186, 124)!important;
}
#tweets ol li a.retweet:hover i.fa-retweet{
  background-color:rgba(0, 186, 124, 0.1);
}
#tweets ol li a.like:hover{
  color:rgb(249, 24, 128)!important;
}
#tweets ol li a.like:hover i.fa-heart{
  background-color:rgba(249, 24, 128, 0.1);
}
/*---------------------------------------------------*/
.twitter-typeahead{
  display:block!important;
}
.tt-hint{
  color:#999!important;
}
.tt-dropdown-menu{
  margin-top:-1px;
  width:100%;
  background-color:#fff;
  border:1px solid #ddd;
  box-shadow:0 6px 12px rgba(0, 0, 0, 0.175);
  border-radius:10px;
  overflow:hidden;
}
.tt-suggestion > p{
  margin:0;
  padding:2px 5px;
  font-weight:700;
  line-height:normal;
  color:#000;
  overflow:hidden;
}
@media (min-width:768px){
  .tt-suggestion > p{
//    padding-top:5px;
//    padding-bottom:5px;
  }
}
.tt-suggestion:first-child > p{
  padding-top:4px;
}
.tt-suggestion:last-child > p{
  padding-bottom:4px;
}
.tt-suggestion > p.recent{
  color:#6a29b9;
}
.tt-suggestion > p img{
  width:32px;
  height:32px;
  vertical-align:middle;
}
.tt-suggestion > p > .fa{
  margin-right:6px;
  font-weight:normal;
  color:#808080;
}
.tt-suggestion > p > strong{
  font-weight:normal;
}
.tt-suggestion > p > a{
  font-weight:normal;
}
.tt-suggestion > p > a{
  text-decoration:none !important;
}
.tt-suggestion > p > a:hover{
  text-decoration:underline !important;
}
/* https://ferie.medium.com/detect-a-touch-device-with-only-css-9f8e30fa1134 */
@media (hover: none) and (pointer: coarse){
  .tt-suggestion > p > a:hover{
    text-decoration:none !important;
  }
}
.tt-suggestion > p > a > strong{
  font-weight:700;
}
.tt-suggestion.tt-cursor p{
  background-color:#f4f4f4;
  cursor:pointer;
}
/*---------------------------------------------------*/
.btn-transparent{
  --bs-btn-color: #fff;
  --bs-btn-bg: rgba(0, 0, 0, 0.5);
  --bs-btn-border-color: rgba(0, 0, 0, 0);
  --bs-btn-hover-color: #fff;
  --bs-btn-hover-bg: rgba(0, 0, 0, 0.7);
  --bs-btn-hover-border-color: rgba(0, 0, 0, 0);
  --bs-btn-active-color: #fff;
  --bs-btn-active-bg: rgba(0, 0, 0, 0.9);
  --bs-btn-active-border-color:rgba(0, 0, 0, 0);
}
@media (hover:none){
  .btn-transparent{
    --bs-btn-hover-bg: rgba(0, 0, 0, 0.5);
  }
}
.backtotop{
  display:none;
  margin-bottom:32px;
  padding-left:0;
  padding-right:0;
  width:48px;
  z-index:1000;
}
/*---------------------------------------------------*/
[data-theme="dark"]{
  --bs-primary-rgb:138,180,248;
  --bs-light-rgb:51, 51, 51;
  --bs-dark-rgb:238,238,238;
  --bs-white-rgb:34,34,34;
  --bs-body-color-rgb:187,187,187;
  --bs-body-bg:#222;
  --bs-link-color:#8ab4f8;
  --bs-link-hover-color:#5996f8;
}
[data-theme="dark"] img.logo{
  filter:invert(1);
}
[data-theme="dark"] .navbar{
  --bs-navbar-color:rgba(255, 255, 255, 0.55);
  --bs-navbar-hover-color:rgba(255, 255, 255, 0.7);
}
[data-theme="dark"] .alert-secondary{
  --bs-alert-color:#bbb;
  --bs-alert-bg: #333;
  --bs-alert-border-color:#333;
}
[data-theme="dark"] .form-control::placeholder{
  color:#555;
}
[data-theme="dark"] .btn-primary{
  --bs-btn-color:#000;
  --bs-btn-bg:#8ab4f8;
  --bs-btn-border-color:#8ab4f8;
  --bs-btn-hover-color:#000;
  --bs-btn-hover-bg:#5996f8;
  --bs-btn-hover-border-color:#5996f8;
  --bs-btn-active-color:#000;
  --bs-btn-active-bg:#4086f8;
  --bs-btn-active-border-color:#4086f8;
}
[data-theme="dark"] #search #q{
  caret-color:#8ab4f8;
  color:#fff;
  background-color:#333!important;
}
[data-theme="dark"] .dropdown-menu{
  --bs-dropdown-bg:#333;
  --bs-dropdown-link-color:#eee;
  --bs-dropdown-link-hover-color:#eee;
  --bs-dropdown-link-hover-bg:#222;
  --bs-dropdown-link-active-color:#000;
  --bs-dropdown-link-active-bg:#8ab4f8;
  --bs-dropdown-link-disabled-color:#555;
}
[data-theme="dark"] .btn-outline-secondary{
  --bs-btn-color:#999;
  --bs-btn-border-color:#999;
  --bs-btn-hover-color:#fff;
  --bs-btn-hover-bg:#555;
  --bs-btn-hover-border-color:#555;
  --bs-btn-active-color:#fff;
  --bs-btn-active-bg:#444;
  --bs-btn-active-border-color:#444;
}
[data-theme="dark"] .btn-light{
  --bs-btn-bg:#ccc;
  --bs-btn-border-color:#ccc;
  --bs-btn-hover-bg:#bbb;
  --bs-btn-hover-border-color:#bbb;
  --bs-btn-active-bg:#aaa;
  --bs-btn-active-border-color:#aaa;
}
[data-theme="dark"] .btn-dark{
  --bs-btn-bg:#444;
  --bs-btn-border-color:#444;
  --bs-btn-hover-bg: #555;
  --bs-btn-hover-border-color:#555;
  --bs-btn-active-bg:#666;
  --bs-btn-active-border-color:#666;
}
[data-theme="dark"] .text-black-50{
  color: rgba(255, 255, 255, 0.5) !important;
}
[data-theme="dark"] .btn-clear{
  --bs-btn-color:rgba(255, 255, 255, 0.2);
  --bs-btn-hover-color:rgba(255, 255, 255, 0.7);
  --bs-btn-active-color:rgba(255, 255, 255, 0.9);
  --bs-btn-active-border-color:rgba(255, 255, 255, 0);
}
[data-theme="dark"] .btn-tab{
  --bs-btn-color:#bbb;
  --bs-btn-border-color:#222;
  --bs-btn-hover-color:#bbb;
  --bs-btn-hover-border-color:#444;
  --bs-btn-active-color:#bbb;
  --bs-btn-active-border-color:#bbb;
}
[data-theme="dark"] main>div.flex-column>a.shadowbelow{
  box-shadow:rgb(0 0 0 / 50%) 0px 8px 8px -8px;
}
[data-theme="dark"] .list-group{
  --bs-list-group-color:#bbb;
  --bs-list-group-bg:transparent;
}
[data-theme="dark"] .card{
  --bs-card-border-color:#333;
  --bs-card-bg:#333;
}
[data-theme="dark"] #web ol li > a:visited:not(:active):not(:focus):not(.btn){
  color:#c58af9;
}
[data-theme="dark"] .s-image-overlay-grey.border{
  background-color:#fff;
  border-color: #ddd!important;
}
[data-theme="dark"] .s-image-overlay-grey:after{
  opacity:.1;
}
[data-theme="dark"] #amazon ol li > div.snippet h6 img{
  filter:contrast(0);
}
[data-theme="dark"] .b-example-divider{
  border-left:1px solid rgba(255, 255, 255, .12);
}
[data-theme="dark"] .tt-dropdown-menu{
  background-color:#333;
  border:1px solid rgba(0, 0, 0, 0.175);;
  box-shadow:0 6px 12px rgba(0, 0, 0, 0.3);
}
[data-theme="dark"] .tt-suggestion > p{
  color:#eee;
}
[data-theme="dark"] .tt-suggestion > p.recent{
  color:#c58af9;
}
[data-theme="dark"] .tt-suggestion.tt-cursor p{
  background-color:#222;
}
#screenshot{
  width:320px;
  height:168px;
  overflow:hidden;
}
#screenshot iframe{
  width:1600px;
  height:840px;
  transform-origin:0 0;
  transform:scale(.19875);
  pointer-events:none;
}
body#iframe main{
  height:auto!important;
  overflow-x:hidden;
}
body#iframe .scrollarea{
  overflow-y:hidden;
}
</style>
<script>
// Copyright 2020-2023 PicClick Inc. All Rights Reserved.
var i18n = {
  'Search everything':{
    'de':'Alles durchsuchen',
    'fr':'Rechercher tout',
    'it':'Cerca tutto',
    'es':'Busca todo',
    'nl':'Zoek alles',
    'zh':'搜索一切',
    'ko':'모든 것을 검색',
    'ja':'すべてを検索',
    'ar':'ابحث في كل شيء'
  },
  'Set Swurl Search as default':{
    'de':'Swurl-Suche als Standard festlegen',
    'fr':'Définir la recherche Swurl par défaut',
    'it':'Imposta Ricerca Swurl come predefinita',
    'es':'Establecer búsqueda de Swurl como predeterminada',
    'nl':'Stel Swurl Zoeken in als standaard',
    'zh':'将 Swurl 搜索设置为默认值',
    'ko':'Swurl 검색을 기본값으로 설정',
    'ja':'Swurl 検索をデフォルトに設定',
    'ar':'قم بتعيين بحث Swurl كملف افتراضي'
  },
  'Images':{
    'de':'Bilder',
    'fr':'Images',
    'it':'Immagini',
    'es':'Imágenes',
    'nl':'Afbeeldingen',
    'zh':'图片',
    'ko':'이미지',
    'ja':'画像',
    'ar':'صور'
  },
  'News':{
    'de':'Nachrichten',
    'fr':'Actualités',
    'it':'Notizie',
    'es':'Noticias',
    'nl':'Nieuws',
    'zh':'新闻',
    'ko':'소식',
    'ja':'ニュース',
    'ar':'الأخبار'
  },
  'Shopping':{
    'de':'Einkaufen',
    'fr':'Achats',
    'it':'Shopping',
    'es':'Compras',
    'nl':'Boodschappen doen',
    'zh':'购物',
    'ko':'쇼핑',
    'ja':'ショッピング',
    'ar':'التسوّق'
  },
  'SafeSearch':{
    'de':'Sichere Suche',
    'fr':'Recherche sécurisée',
    'it':'Ricerca sicura',
    'es':'Búsqueda segura',
    'nl':'Veilige zoekopdracht',
    'zh':'安全搜索',
    'ko':'안전 검색',
    'ja':'安全な検索',
    'ar':'بحث آمن'
  },
  'Personalization':{
    'de':'Personalisierung',
    'fr':'Personnalisation',
    'it':'Personalizzazione',
    'es':'Personalización',
    'nl':'Personalisatie',
    'zh':'个性化',
    'ko':'개인화',
    'ja':'パーソナライゼーション',
    'ar':'إضفاء الطابع الشخصي'
  },
  'Autocomplete':{
    'de':'Automatische Vervollständigung',
    'fr':'Saisie automatique',
    'it':'Completamento automatico',
    'es':'Autocompletar',
    'nl':'Automatisch aanvullen',
    'zh':'自动完成',
    'ko':'자동완성',
    'ja':'オートコンプリート',
    'ar':'الإكمال التلقائي'
  },
  'Dark Mode':{
    'de':'Dunkler Modus',
    'fr':'Mode sombre',
    'it':'Modalità scura',
    'es':'Modo oscuro',
    'nl':'Donkere modus',
    'zh':'黑暗模式',
    'ko':'다크 모드',
    'ja':'ダークモード',
    'ar':'الوضع الداكن'
  },
  'About Us':{
    'de':'Über uns',
    'fr':'À propos de nous',
    'it':'Chi siamo',
    'es':'Sobre nosotros',
    'nl':'Over ons',
    'zh':'关于我们',
    'ko':'회사 소개',
    'ja':'私たちに関しては',
    'ar':''
  },
  'Terms of Service':{
    'de':'Nutzungsbedingungen',
    'fr':'Conditions d\'utilisation',
    'it':'Termini di servizio',
    'es':'Términos de servicio',
    'nl':'Servicevoorwaarden',
    'zh':'服务条款',
    'ko':'회사 소개',
    'ja':'利用規約',
    'ar':'معلومات عنا'
  },
  'Privacy Policy':{
    'de':'Datenschutz-Bestimmungen',
    'fr':'Politique de confidentialité',
    'it':'Informativa sulla privacy',
    'es':'Política de privacidad',
    'nl':'Privacybeleid',
    'zh':'隐私隐私政策',
    'ko':'개인 정보 정책',
    'ja':'プライバシーポリシー',
    'ar':'سياسة الخصوصية'
  },
  'Back to Top':{
    'de':'Zurück nach oben',
    'fr':'Retour en haut',
    'it':'Torna all\'inizio',
    'es':'Volver arriba',
    'nl':'Terug naar boven',
    'zh':'回到顶部',
    'ko':'맨 위로',
    'ja':'トップに戻る',
    'ar':'العودة إلى الأعلى'
  },
  'Showing results for':{
    'de':'Ergebnisse für',
    'fr':'Résultats pour',
    'it':'Risultati relativi a',
    'es':'Se muestran resultados de',
    'nl':'Resultaten voor,',
    'zh':'显示结果',
    'ko':'에 대한 결과 표시 중',
    'ja':'の結果を表示しています',
    'ar':''
  },
  'Search instead for':{
    'de':'Stattdessen suchen nach',
    'fr':'Essayez avec l\'orthographe',
    'it':'Cerca invece',
    'es':'Buscar, en cambio,',
    'nl':'Zoek in plaats daarvan naar',
    'zh':'搜索代替',
    'ko':'대신 검색',
    'ja':'代わりに検索',
    'ar':'عرض النتائج ل'
  },
  'No results found for':{
    'de':'Keine Ergebnisse gefunden für',
    'fr':'Aucun résultat trouvé pour',
    'it':'Nessun risultato trovato per',
    'es':'No se han encontrado resultados para',
    'nl':'Geen resultaten gevonden voor',
    'zh':'找不到与的结果',
    'ko':'에 대한 검색결과가 없습니다',
    'ja':'の結果が見つかりませんでした',
    'ar':'لا يوجد نتائج ل'
  },
  'Did you mean':{
    'de':'Meintest du',
    'fr':'Essayez avec cette orthographe',
    'it':'Forse cercavi',
    'es':'Quizás quisiste decir',
    'nl':'Bedoelde je',
    'zh':'你的意思',
    'ko':'를 의미 한거야',
    'ja':'もしかして',
    'ar':'هل تعني'
  },
  'Your search':{
    'de':'Ihre Suche',
    'fr':'Votre recherche',
    'it':'La tua ricerca',
    'es':'Su búsqueda',
    'nl':'Uw zoekopdracht',
    'zh':'您的搜索',
    'ko':'귀하의 검색',
    'ja':'検索結果'
  },
  'did not match any results.</p><p>Suggestions:</p><ul><li>Make sure all words are spelled correctly.</li><li>Try different keywords.</li><li>Try more general keywords.</li><li>Try fewer keywords.</li></ul>':{
    'de':'stimmte nicht mit den Ergebnissen überein.</p><p>Vorschläge:</p><ul><li>Stellen Sie sicher, dass alle Wörter richtig geschrieben sind.</li><li>Probieren Sie verschiedene Schlüsselwörter aus.</li><li>Probieren Sie allgemeinere Suchbegriffe.</li><li>Versuchen Sie es mit weniger Schlüsselwörtern.</li></ul>',
    'fr':'ne correspond à aucun résultat.</p><p>Suggestions:</p><ul><li>Assurez-vous que tous les mots sont épelés correctement.</li><li>Essayez différents mots-clés.</li><li>Essayez des mots clés plus généraux.</li><li>Essayez moins de mots clés.</li></ul>',
    'it':'non ha prodotto risultati.</p><p>Suggerimenti:</p><ul><li>Assicurarsi che tutte le parole siano state digitate correttamente.</li><li>Prova parole chiave diverse.</li><li>Prova con parole chiave più generiche.</li><li>Prova meno parole chiave.</li></ul>',
    'es':'no arrojó ningún resultado.</p><p>Sugerencias:</p><ul><li>Asegúrese de que todas las palabras estén escritas correctamente.</li><li>Pruebe diferentes palabras clave.</li><li>Prueba palabras clave más generales.</li><li>Pruebe con menos palabras clave.</li></ul>',
    'nl':'leverde geen resultaten op.</p><p>Suggesties:</p><ul><li>Zorg ervoor dat alle woorden correct gespeld zijn.</li><li>Probeer verschillende trefwoorden.</li><li>Probeer meer algemene trefwoorden te gebruiken.</li><li>Probeer minder zoekwoorden.</li></ul>',
    'zh':'没有任何结果。</p><p>意见建议：</p><ul><li>确保所有单词拼写正确。</li><li>尝试使用其他关键字。</li><li>尝试使用更宽泛的关键字。</li><li>尝试较少的关键字。</li></ul>',
    'ko':'일치하는 결과가 없습니다.</p><p>제안:</p><ul><li>모든 단어의 철자가 올바른지 확인하십시오.</li><li>Try different keywords.</li><li>다른 키워드를 사용해 보세요.</li><li>더 적은 수의 키워드를 사용해 보십시오.</li></ul>',
    'ja':'に一致する結果はありませんでした。</p><p>Suggestions:</p><ul><li>すべての単語のスペルが正しいことを確認してください。</li><li>さまざまなキーワードを試してください。</li><li>より一般的なキーワードを試してください。</li><li>キーワードの数を減らしてください。</li></ul>'
  },
  'In the menu choose <strong>Safari</strong> > <strong>Preferences</strong>, click <i class="fa-solid fa-gear"></i> <strong>General</strong>':{
    'de':'Im Menü wählen <strong>Safari</strong> > <strong>Einstellungen</strong>, klicke auf <i class="fa-solid fa-gear"></i> <strong>Allgemein</strong>',
    'fr':'Dans le menu choisissez <strong>Safari</strong> > <strong>Préférences</strong>, cliquez sur <i class="fa-solid fa-gear"></i> <strong>Général</strong>',
    'it':'Nel menu scegli <strong>Safari</strong> > <strong>Preferenze</strong>, fai clic su <i class="fa-solid fa-gear"></i> <strong>Generali</strong>',
    'es':'En el menú selecciona <strong>Safari</strong> > <strong>Preferencias</strong>, haga clic en <i class="fa-solid fa-gear"></i> <strong>General</strong>',
    'nl':'In het menu staat kies je <strong>Safari</strong> > <strong>Voorkeuren</strong>, klik op <i class="fa-solid fa-gear"></i> <strong>Algemeen</strong>',
    'zh':'In the menu choose <strong>Safari</strong> > <strong>Preferences</strong>, click <i class="fa-solid fa-gear"></i> <strong>General</strong>'
  },
  'Under <strong>New windows open with</strong> choose <strong>Homepage</strong>':{
    'de':'Geben Sie unter <strong>Neue Fenster öffnen mit</strong> wählen <strong>Homepage</strong>',
    'fr':'Sous <strong>Ouvrir les nouvelles fenêtres en utilisant</strong> choisissez <strong>Page d’accueil</strong>',
    'it':'In <strong>Apri nuove finestre con</strong> scegli <strong>“Pagina iniziale”</strong>',
    'es':'Under <strong>Abrir ventanas nuevas con</strong> selecciona <strong>Página de inicio</strong>',
    'nl':'Voer onder <strong>Open nieuwe vensters met</strong> kiezen <strong>Homepage</strong>',
    'zh':'Under <strong>New windows open with</strong> choose <strong>Homepage</strong>'
  },
  'Under <strong>New tabs open with</strong>, choose <strong>Homepage</strong>':{
    'de':'Geben Sie unter <strong>Neue Tabs öffnen mit</strong> wählen <strong>Homepage</strong>',
    'fr':'Sous <strong>Ouverture des nouveaux onglets avec</strong> choisissez <strong>Page d’accueil</strong>',
    'it':'In <strong>Apri nuovi pannelli con</strong> scegli <strong>“Pagina iniziale”</strong>',
    'es':'Under <strong>Abrir pestañas nuevas con</strong> selecciona <strong>Página de inicio</strong>',
    'nl':'Voer onder <strong>Open nieuwe tabbladen met</strong> kiezen <strong>Homepage</strong>',
    'zh':'Under <strong>New tabs open with</strong>, choose <strong>Homepage</strong>'
  },
  'Under <strong>Homepage</strong> enter <strong>swurl.com</strong>':{
    'de':'Geben Sie unter <strong>Homepage</strong> typ <strong>swurl.com</strong>',
    'fr':'Sous <strong>Page d’accueil</strong> saisissez <strong>swurl.com</strong>',
    'it':'In <strong>“Pagina iniziale”</strong> inserisci <strong>swurl.com</strong>',
    'es':'Under <strong>Página de inicio</strong> escribe <strong>swurl.com</strong>',
    'nl':'Voer onder <strong>Homepage</strong> typ <strong>swurl.com</strong>',
    'zh':'Under <strong>Homepage</strong> enter <strong>swurl.com</strong>'
  },
  'Done':{
    'de':'Fertig',
    'fr':'Fait',
    'it':'Fatto',
    'es':'Hecho',
    'nl':'Gedaan',
    'zh':'完毕',
    'ko':'완료',
    'ja':'終わり',
    'ar':'فعله'
  },
  'Share':{
    'de':'Teilen',
    'fr':'Partager',
    'it':'Condividi',
    'es':'Compartir',
    'nl':'Delen',
    'zh':'分享',
    'ko':'공유',
    'ja':'シェア',
    'ar':'يشارك'
  },
  'Help Spread Swurl':{
    'de':'Mithelfen, um Swurl bekannter zu machen',
    'fr':'Aidez-nous à faire connaître Swurl',
    'it':'Aiuta a diffondere Swurl',
    'es':'Ayuda a difundir Swurl',
    'nl':'Help Swurl te verspreiden!',
    'zh':'协助推广 Swurl',
    'ko':'Swurl를 더 많은 사람들에게 알려주세요',
    'ja':'Swurlを広めましょう',
    'ar':'مساعدة انتشار Swurl'
  },
  'Friends help friends search wonderfully.':{
    'de':'Freunde helfen Freunden bei der Suche wunderbar.',
    'fr':'Les amis aident leurs amis à rechercher à merveille.',
    'it':'Gli amici aiutano gli amici a cercare meravigliosamente.',
    'es':'Los amigos ayudan a los amigos a buscar maravillosamente.',
    'nl':'Vrienden helpen vrienden geweldig zoeken.',
    'zh':'好友帮好友搜索精彩。',
    'ko':'친구는 친구가 훌륭하게 검색하도록 도와줍니다.',
    'ja':'友達は、友達が素晴らしい検索を手伝ってくれます。',
    'ar':'الأصدقاء يساعدون الأصدقاء في البحث بشكل رائع.'
  },
  'Friends help friends search everything.':{
    'de':'Freunde helfen Freunden alles durchsuchen.',
    'fr':'Les amis aident leurs amis à tout rechercher.',
    'it':'Gli amici aiutano gli amici a cercare tutto.',
    'es':'Los amigos ayudan a los amigos a buscar todo.',
    'nl':'Vrienden helpen vrienden om alles te zoeken.',
    'zh':'朋友帮助朋友搜索一切。',
    'ko':'친구는 친구가 모든 것을 검색하도록 도와줍니다.',
    'ja':'友達は、友達がすべてを検索するのを助けます。',
    'ar':'يساعد الأصدقاء الأصدقاء في البحث عن كل شيء.'
  },
  'Friends help friends search better.':{
    'de':'Freunde helfen Freunden, besser zu suchen.',
    'fr':'Les amis aident leurs amis à mieux chercher.',
    'it':'Gli amici aiutano gli amici a cercare meglio.',
    'es':'Los amigos ayudan a los amigos a buscar mejor.',
    'nl':'Vrienden helpen vrienden beter te zoeken.',
    'zh':'朋友帮助朋友更好地搜索。',
    'ko':'친구는 친구가 더 잘 검색하도록 도와줍니다.',
    'ja':'友達は、友達がよりよく検索できるようにします。',
    'ar':'يساعد الأصدقاء الأصدقاء في البحث بشكل أفضل.'
  },
  'Friends help friends search Swurl.':{
    'de':'Freunde helfen Freunden bei der Swurl-Suche.',
    'fr':'Les amis aident leurs amis à rechercher Swurl.',
    'it':'Gli amici aiutano gli amici a cercare su Swurl.',
    'es':'Los amigos ayudan a los amigos a buscar en Swurl.',
    'nl':'Vrienden helpen vrienden zoeken op Swurl.',
    'zh':'朋友帮朋友搜索Swurl。',
    'ko':'친구는 친구가 Swurl을 검색하도록 도와줍니다.',
    'ja':'友達は、友達が Swurl を検索するのを助けます。',
    'ar':'يساعد الأصدقاء الأصدقاء في البحث في Swurl.'
  },
  'Friends help friends search with Swurl.':{
    'de':'Freunde helfen Freunden bei der Suche mit Swurl.',
    'fr':'Les amis aident leurs amis à rechercher avec Swurl.',
    'it':'Gli amici aiutano gli amici a cercare con Swurl.',
    'es':'Los amigos ayudan a los amigos a buscar con Swurl.',
    'nl':'Vrienden helpen vrienden zoeken met Swurl.',
    'zh':'朋友帮助朋友使用 Swurl 进行搜索。',
    'ko':'친구는 친구가 Swurl로 검색할 수 있도록 도와줍니다.',
    'ja':'友達は、友達が Swurl で検索するのを手伝ってくれます。',
    'ar':'يساعد الأصدقاء الأصدقاء في البحث باستخدام Swurl.'
  },
  'Friends don\'t let friends search the old way.':{
    'de':'Freunde lassen Freunde nicht auf die alte Art und Weise suchen.',
    'fr':'Les amis ne laissent pas les amis rechercher à l\'ancienne.',
    'it':'Gli amici non permettono agli amici di cercare nel vecchio modo.',
    'es':'Los amigos no dejan que los amigos busquen a la antigua.',
    'nl':'Vrienden laten vrienden niet op de oude manier zoeken.',
    'zh':'朋友们不要让朋友们用老办法搜索。',
    'ko':'친구는 친구가 옛날 방식으로 검색하도록 허용하지 않습니다.',
    'ja':'友達は友達に古い方法で検索させません。',
    'ar':'يساعد الأصدقاء الأصدقاء في البحث علا يسمح الأصدقاء للأصدقاء بالبحث بالطريقة القديمة.'
  },
  'Share this awesome search result':{
    'de':'Teilen Sie dieses tolle Suchergebnis',
    'fr':'Partagez ce résultat de recherche impressionnant',
    'it':'Condividi questo fantastico risultato di ricerca',
    'es':'Comparte este increíble resultado de búsqueda',
    'nl':'Deel dit geweldige zoekresultaat',
    'zh':'分享这个很棒的搜索结果',
    'ko':'이 멋진 검색 결과를 공유하세요',
    'ja':'このすばらしい検索結果を共有する',
    'ar':'شارك نتيجة البحث الرائعة هذه'
  }
};
var IP = '';
function __(str)
{ 
  if(LANG!=='en' && typeof i18n[str]!=='undefined' && typeof i18n[str][LANG]!=='undefined')
    return escapeHtml(i18n[str][LANG]);
  return str;
}
function getParameterByName(name)
{
  name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
  var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
  var results = regex.exec(window.location.href);
  return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " ")).replace(/^\s+|\s+$/gm,'');    // Added trim() regex on end
}
function escapeHtml(text)
{
  return text
//    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#039;');
}
function unescapeHtml(text)
{
  return text
//    .replace(/&amp;/g, '&')
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
    .replace(/&quot;/g, '"')
    .replace(/&#039;/g, '\'');
}
var isTouch = ('ontouchstart' in window || window.navigator.msMaxTouchPoints);
// https://www.abeautifulsite.net/detecting-mobile-devices-with-javascript
var isMobile = {
  Android: function(){
    return navigator.userAgent.match(/Android/i);
  },
  BlackBerry: function(){
    return navigator.userAgent.match(/BlackBerry/i);
  },
  iOS: function(){
    return navigator.userAgent.match(/iPhone|iPad|iPod/i);
  },
  Opera: function(){
    return navigator.userAgent.match(/Opera Mini/i);
  },
  Windows: function(){
    return navigator.userAgent.match(/IEMobile/i);
  },
  any: function(){
    return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
  }
};
// https://stackoverflow.com/questions/4565112/javascript-how-to-find-out-if-the-user-browser-is-chrome
var isChromium = window.chrome;
var winNav = window.navigator;
var vendorName = winNav.vendor;
var isOpera = typeof window.opr !== "undefined";
var isIEedge = winNav.userAgent.indexOf("Edg") > -1;
var isIOSChrome = winNav.userAgent.match("CriOS");
// https://stackoverflow.com/questions/7000190/detect-all-firefox-versions-in-js
var isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
// https://stackoverflow.com/questions/7944460/detect-safari-browser
var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
// https://gist.github.com/johan/2209957
(function($) {
  function img(url) {
  var i = new Image;
  i.src = url;
  return i;
  }

  if ('naturalWidth' in (new Image)) {
  $.fn.naturalWidth  = function() { return this[0].naturalWidth; };
  $.fn.naturalHeight = function() { return this[0].naturalHeight; };
  return;
  }
  $.fn.naturalWidth  = function() { return img(this[0].src).width; };
  $.fn.naturalHeight = function() { return img(this[0].src).height; };
})(jQuery);
// https://alvarotrigo.com/blog/move-cursor-to-the-end-of-input-or-textarea/ with Ryan modification to plain javascript
function moveCursorToEnd()
{
  var originalValue = document.getElementById('q').value;
  document.getElementById('q').value = '';
  document.getElementById('q').blur();
  document.getElementById('q').focus();
  document.getElementById('q').value = originalValue;
}
// http://blog.maverickgroups.com/javascript/time-ago-function-with-javascript/
function timeago(time)
{
  var diff = Date.now() - Date.parse(time);

  var second = 1000,
  minute = second * 60,
  hour = minute * 60,
  day = hour * 24;
  month = day * 30;
  year = day * 365;

  if(isNaN(diff) || diff<0)
    return '';    // return blank string if unknown
  if(diff<minute)
    return '<span class="text-danger">'+Math.floor(diff/second)+' second'+((Math.floor(diff/second)>1) ? 's' : '')+' ago</span>';
  if(diff<hour)
    return '<span class="text-danger">'+Math.floor(diff/minute)+' minute'+((Math.floor(diff/minute)>1) ? 's' : '')+' ago</span>';
  if(diff<day)
    return '<span class="text-danger">'+Math.floor(diff/hour)+' hour'+((Math.floor(diff/hour)>1) ? 's' : '')+' ago</span>';
  if(diff<month)
    return Math.floor(diff/day)+' day'+((Math.floor(diff/day)>1) ? 's' : '')+' ago';
  if(diff<year)
    return Math.floor(diff/month)+' month'+((Math.floor(diff/month)>1) ? 's' : '')+' ago';
  else
    return Math.floor(diff/year)+' year'+((Math.floor(diff/year)>1) ? 's' : '')+' ago';
}
function timeago2(time)
{
  var datetime =  Date.parse(time);
  var diff = Date.now() - datetime;

  var second = 1000,
  minute = second * 60,
  hour = minute * 60,
  day = hour * 24;
  month = day * 30;
  year = day * 365;
  
  if(isNaN(diff) || diff<0)
    return '';    // return blank string if unknown
  if(diff<minute)
    return Math.floor(diff/second)+'s';
  if(diff<hour)
    return Math.floor(diff/minute)+'m';
  if(diff<day)
    return Math.floor(diff/hour)+'h';
  if(new Date(datetime).getFullYear()==new Date().getFullYear())
    return new Date(datetime).toLocaleString('default', {month:'short', day:'numeric'});
  else
    return new Date(datetime).toLocaleString('default', {month:'short', day:'numeric', year:'numeric'});
}
// https://stackoverflow.com/questions/8498592/extract-hostname-name-from-string
function extractHostname(url)
{
  var hostname;
  //find & remove protocol (http, ftp, etc.) and get hostname
  if(url.indexOf("//") > -1)
    hostname = url.split('/')[2];
  else
    hostname = url.split('/')[0];
  //find & remove port number
  hostname = hostname.split(':')[0];
  //find & remove "?"
  hostname = hostname.split('?')[0];
  return hostname;
}
var q = getParameterByName('q');
if(q)
{
  // UPS
  if(q.match(/\b(1Z ?[0-9A-Z]{3} ?[0-9A-Z]{3} ?[0-9A-Z]{2} ?[0-9A-Z]{4} ?[0-9A-Z]{3} ?[0-9A-Z])\b/i)!==null)
  {
    pagehide();
    window.location.href = 'http://wwwapps.ups.com/WebTracking/track?track=yes&trackNums='+encodeURIComponent(q);
  }
  // FedEx
  else if(q.match(/(\b96\d{20}\b)|(\b\d{15}\b)/i)!==null ||
     q.match(/\b((98\d\d\d\d\d?\d\d\d\d|98\d\d) ?\d\d\d\d ?\d\d\d\d( ?\d\d\d)?)\b/i)!==null ||
     q.match(/^[0-9]{15}$/i)!==null)
  {
    pagehide();
    window.location.href = 'https://www.fedex.com/fedextrack/?tracknumbers='+encodeURIComponent(q);
  }
/*
  // DHL
  else if(q.match(//i)!==null)
  {
    pagehide();
    window.location.href = 'https://webtrack.dhlglobalmail.com/?mobile=&trackingnumber='+encodeURIComponent(q);
  }
*/
  // USPS, but can be DHL...
  else if(q.match(/(\b\d{30}\b)|(\b\d{20}\b)|(\b\d{26}\b)| ^E\D{1}\d{9}\D{2}$|^9\d{15,21}$| ^91[0-9]+$| ^[A-Za-z]{2}[0-9]+US$/i)!==null)
  {
    pagehide();
    window.location.href = 'https://tools.usps.com/go/TrackConfirmAction?tLabels='+encodeURIComponent(q);
  }
/*
  else if($(window).width()>768 && $(window).height()>768)
  {
    ads = true;
    (function(d, script){
      script = d.createElement('script');
      script.type = 'text/javascript';
      script.async = true;
      script.src = 'https://s.flocdn.com/@s1/embedded-search/embedded-search.js';
      d.getElementsByTagName('head')[0].appendChild(script);
    }(document));
    $.getJSON('/signature.php?q='+encodeURIComponent(q), function(signature){
      ga(function(tracker){
        window.s1search = window.s1search || function(){ (window.s1search.q = window.s1search.q || []).push(arguments) };
        window.s1search('config', {
          category:'web',
          domain:'swurl.com',
          partnerId:41300,
          isTest:false,
          onComplete:function(data){ if(data.adcount) document.getElementById('ads').style.minHeight = 0; else document.getElementById('ads').remove(); },
          onError:function(){ document.getElementById('ads').remove(); },
          query:q,
          segment:'swurl2',
          signature:signature,
          gdprOptIn:true,
          clickTrackingUrl:'https://www.google-analytics.com/collect?v=1&t=event&ec=ads&ea=click&el={extra_args[position]}&cid='+tracker.get('clientId')+'&tid='+tracker.get('trackingId')+'&z='+(new Date().getTime())
        });
      });
    });
  }
*/
  document.title = q+' - Swurl';
}
var nospellingcorrection = getParameterByName('nospellingcorrection');
var sort = getParameterByName('sort');
var scrolled = {};
function scroll(ev){
  scrolled[ev.currentTarget.parentNode.id] = true;
}
$(window).resize(function(){
  for(const key in scrolled)
    scrolled[key] = true;
});
var siteloading = {};
var sitedata = {};
var backtotophtml = '<button class="backtotop btn btn-lg btn-transparent rounded-pill position-absolute bottom-0 end-0 me-3" onclick="$(this).prev().animate({scrollTop:0});if((!isTouch || (!isMobile.iOS() && !isMobile.Android())) && document.getElementById(\'q\'))moveCursorToEnd();" title="'+__('Back to Top')+'"><i class="fa-solid fa-up-long" aria-hidden="true"></i></button>';
var d1 = atob('aHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20v');
var a1 = atob('a2V5PUFJemFTeUJVejJyV0djY3BqTzRVUnpWc2h4UWxPalYxQ2VmLU1TbyY=');
var c1 = atob('Y3g9MDEzOTc3MDIzNzQ4MjI0ODcyMTE5OnlidzBxbDFpanBtJg==');
var a2 = atob('ZGFhNDY1Y2QyZjdkNGM1NDljNjA5MDUxNjdhNzYzNzg=');
var a3 = atob('YTVkYTMzNTY1ZTdjNDViNGE3Y2UxMTNjOGM1NzYxMzQ=');
var a4 = atob('YzllODc1YTFiNTJlNGRmMWFjNzg5ZjRmMjNmNmM0OGU=');
function web(q)
{
  var functionid = 'web';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100) || (typeof sitedata[functionid].webPages!=='undefined' && typeof sitedata[functionid].webPages.totalEstimatedMatches!=='undefined' && $('#web > ol > li.bing').length<1000 && $('#web > ol > li.bing').length<sitedata[functionid].webPages.totalEstimatedMatches)))
  {
    siteloading[functionid] = true;
    if($('#web').length==0)
    {
      $('#scrollto').append('<li id="item-web" class="list-inline-item"><label for="web" title="'+((Cookies.get('enablebing')===undefined) ? 'Google' : 'Bing')+'" aria-label="'+((Cookies.get('enablebing')===undefined) ? 'Google' : 'Bing')+'" class="btn btn-tab active" onclick="scrollto(this);">'+((Cookies.get('enablebing')===undefined) ? '<img src="/img/logo/google.svg">' : '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.microsoft.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">')+'</label></li>');
      $('#main').append('<div id="web" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.'+((Cookies.get('enablebing')===undefined) ? 'google' : 'bing')+'.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body">'+((Cookies.get('enablebing')===undefined) ? '<img src="/img/logo/google.svg">' : '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.microsoft.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">')+' <span class="text">'+((Cookies.get('enablebing')===undefined) ? 'Google' : 'Bing')+'<span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#web > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#web > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled['web'] = false;
      $('#web > ol').scroll(scroll);
    }
// Needed for retry hint below???
//    if($('#web > ol > li.loading').length==0)
      $('#web > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h5 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h5></div><div class="frame rounded-3 float-end ms-2"><div class="placeholder" style="width:110px;height:82.5px;"></div></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div></li>'.repeat(10));
    $.ajax(
      (Cookies.get('enablebing')===undefined) ? 
      {
        url:d1+'customsearch/v1?'+a1+c1+'q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+'&hl='+encodeURIComponent(LANG)+'&gl='+encodeURIComponent(COUNTRY)+((Cookies.get('disablesafesearch')!==undefined) ? '&safe=off' : '&safe=active')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
        cache:true,
        dataType:'jsonp',
        jsonp:'callback',
        jsonpCallback:'googleweb'
      } :
      {
        url:'https://api.bing.microsoft.com/v7.0/search?q='+encodeURIComponent(((nospellingcorrection==1) ? '+' : '')+q)+'&count=10&offset='+$('#web > ol > li.bing').length+'&mkt='+encodeURIComponent(language)+'&textDecorations=true&textFormat=HTML'+((Cookies.get('disablesafesearch')!==undefined) ? '&safeSearch=Off' : '')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&freshness=Month' : ''),
        cache:true,
        beforeSend:function(xhr){
          xhr.setRequestHeader('Ocp-Apim-Subscription-Key', a2);
          if(IP!='')
            xhr.setRequestHeader('X-MSEdge-ClientIP', IP);
          if(isMobile.any())
            xhr.setRequestHeader('User-Agent', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36');    // Need to set user agent so Bing API returns desktop URLS, not mobile!!!
        }
      }
    ).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      // Error, retry
      if(typeof data.error!=='undefined' && data.error.code==503 && $('#web > ol > li.loading').length<=20)
      {
        console.log('Error, retry');
        delete siteloading[functionid];
        setTimeout(function(){web(q);}, 1000);
        return false;
      }
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      if(typeof data.spelling!=='undefined' && $('#web > ol > li:not(.loading)').length==0 && document.getElementById('showingresultsfor')==null)
      {
        if(nospellingcorrection=='')
        {
          $('#web > ol').prepend('<li id="showingresultsfor" class="list-group-item border-0 pt-0 pb-3 lh-sm">'+__('Showing results for')+' <a href="/?q='+encodeURIComponent(data.spelling.correctedQuery).replace(/['()]/g, escape).replace(/%20/g, '+')+((sort!='') ? '&sort='+encodeURIComponent(sort) : '')+'" onclick="pagehide()">'+data.spelling.htmlCorrectedQuery+'</a><br><small>'+((typeof data.items!=='undefined') ? __('Search instead for')+' <a href="/?q='+encodeURIComponent(q).replace(/['()]/g, escape).replace(/%20/g, '+')+'&nospellingcorrection=1'+((sort!='') ? '&sort='+encodeURIComponent(sort) : '')+'" onclick="pagehide()">'+escapeHtml(q)+'</a>' : __('No results found for')+' <b>'+escapeHtml(q))+'</b></small></li>');
          q = data.spelling.correctedQuery;
          delete sitedata[functionid];
          delete siteloading[functionid];
          web(q);
          return false;
        }
        else
          $('#web > ol').prepend('<li class="list-group-item border-0 pt-0 pb-3 lh-sm">'+__('Did you mean')+': <a href="/?q='+encodeURIComponent(data.spelling.correctedQuery).replace(/['()]/g, escape).replace(/%20/g, '+')+((sort!='') ? '&sort='+encodeURIComponent(sort) : '')+'" onclick="pagehide()">'+data.spelling.htmlCorrectedQuery+'</a></li>');
      }
      // Do it here so we get spell corrected result...
      if(typeof localStorage!=='undefined' && q.length<=30 && Cookies.get('disablerecentsearches')===undefined && Cookies.get('disableautocomplete')===undefined)
      {
        var recentsearches = (localStorage.getItem('recentsearches')!==null) ? JSON.parse(localStorage.getItem('recentsearches')) : [];
        recentsearches.unshift(q.toLowerCase());
        recentsearches = recentsearches.filter(function(el, index, arr){ return index == arr.indexOf(el); });
        recentsearches = recentsearches.slice(0, 1000);
        localStorage.setItem('recentsearches', JSON.stringify(recentsearches));
      }
      var first = '';
      var second = '';
      var html = '';
      var shopping = false;
      var word = '';
      var mapq = '';
      var stocksymbol = '';
      var weatherlocation = '';
      var newscount = 0;
      if(typeof data.items==='undefined')
      {
        data.items = [];
        data.searchInformation = {formattedTotalResults:'0'};
        if(typeof data.webPages!=='undefined')
        {
          data.items = data.webPages.value;
          if(typeof data.webPages.totalEstimatedMatches!=='undefined')
            data.searchInformation.formattedTotalResults = data.webPages.totalEstimatedMatches.toLocaleString();
        }
      }
      $.each(data.items, function(key, val){
        // Bing
        if(typeof val.url!=='undefined')
        {
          val.link = val.url;
          val.displayLink = extractHostname(val.link);
          val.title = val.name.replace(/<\/?[^>]+(>|$)/g, '');
          val.htmlSnippet = val.snippet.replace('&lt;p&gt;', '');
          if(typeof val.thumbnailUrl!=='undefined')
            val.pagemap = {cse_thumbnail:[{src:val.thumbnailUrl}]};
        }
        var id = val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null)
        {
          // Setup
          if(typeof val.title==='undefined')
            val.title = val.link;
          if(typeof val.htmlSnippet==='undefined')
            val.htmlSnippet = val.title;
          var extra = '';
          // if(typeof val.pagemap!=='undefined' && typeof val.pagemap.SportsEvent==='object')
          // {
          //  console.log(val.pagemap.SportsEvent);
          //  extra += '<ul class="small" style="list-style-type: disc; ">';
          //  for(var i=0, len=val.pagemap.SportsEvent.length; i<len; i++)
          //    extra += '<li>'+((typeof val.pagemap.SportsEvent[i].url!=='undefined') ? '<a href="'+escapeHtml(val.pagemap.SportsEvent[i].url)+'" onclick="pagehide()">' : '')+escapeHtml(val.pagemap.SportsEvent[i].name)+((typeof val.pagemap.SportsEvent[i].url!=='undefined') ? '</a>' : '')+'<br>'+escapeHtml(new Date(Date.parse(val.pagemap.SportsEvent[i].startDate)).toDateString())+'</li>';
          //  extra += '</ul>';
          // }
          // Make result HTML
//            var item = '<li id="'+id+'" class="google '+((val.displayLink.indexOf('www.amazon.')==0) ? 'amazon ' : '')+((val.displayLink.indexOf('.ebay.')!==-1) ? 'ebay ' : '')+((val.link.match(/^https:\/\/[a-z]+\.youtube\.com\/watch\?v=/)===null) ? 'web' : 'video" onmouseleave="videoend()')+'"><a href="'+val.link+'" onclick="ga(\'send\', \'event\', \'web\', \'click\', \''+val.displayLink.replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'\');saverecentlyviewed(this);this.blur();return a(this);" oncontextmenu="this.blur();"><div class="frame"><div class="image"'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_thumbnail!=='undefined' && val.link.indexOf('.linkedin.com/')==-1) ? ' style="background-image:url(\''+val.pagemap.cse_thumbnail[0].src+'\');"' : '')+' title="'+escapeHtml(val.title)+'"><img loading="eager" src="'+((val.link.match(/^https:\/\/[a-z]+\.youtube\.com\/watch/)===null) ? ((typeof val.fileFormat!=='undefined' && val.fileFormat!=='text/plain' && val.fileFormat!=='text/xml') ? 'https://api.swurl.com/screenshot?url='+encodeURIComponent('https://docs.google.com/viewer?url='+encodeURIComponent(val.link)) : ((val.link.indexOf('.linkedin.com/')!=-1 && typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined' && val.pagemap.metatags[0]['og:image'].indexOf('-shrink_200_200')!=-1) ? val.pagemap.metatags[0]['og:image']+'" class="profile' : 'https://api.swurl.com/screenshot?url='+encodeURIComponent(val.link)+(((val.displayLink=='www.amazon.com' || val.displayLink=='www.amazon.de' || val.displayLink=='www.amazon.co.uk') && typeof val.cacheId!=='undefined') ? '&cacheId='+encodeURIComponent(val.cacheId) : '')+'" onload="ocr(this)')) : 'https://i.ytimg.com/vi/'+val.link.replace(/^https:\/\/[a-z]+\.youtube\.com\/watch(\?v=|\/)/, '').replace(/&.+/, '')+'/hqdefault.jpg" id="'+val.link.replace(/^https:\/\/[a-z]+\.youtube\.com\/watch(\?v=|\/)/, '').replace(/&.+/, '')+'" onmouseenter="videostart(this)')+'" alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" onerror="this.setAttribute(\'srcreplaced\', this.src);this.src=\'/404.gif\';" /></div></div><div class="text"><div class="url" title="'+escapeHtml(val.link)+'"><img loading="eager" src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.link.indexOf('https://')==0) ? 'https://' : 'http://')+val.displayLink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+val.displayLink.replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+((0/*val.displayLink.replace(/^www[0-9]?\./, '') in merchants*/) ? '<small class="text-body text-opacity-50"> &middot; '+__('supporter')+'</small>' : '')+'</div><h3 title="'+escapeHtml(val.title)+'">'+((typeof val.fileFormat!=='undefined' && val.fileFormat=='PDF/Adobe Acrobat') ? '<sup><small>[PDF]</small></sup> ' : '')+escapeHtml(val.title)+'</h3><div class="snippet">'+((val.htmlSnippet.indexOf(' ago <b>...</b> ')!=-1) ? '<span class="text-body text-opacity-50"'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']!=='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0]['article:published_time'])).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].lastpublisheddate)).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].pubdate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].pubdate)).toLocaleString())+'"' : '')+'><span class="text-danger">'+val.htmlSnippet.replace(' ago <b>...</b> ', ' ago</span> &middot;</span> ') : val.htmlSnippet).replace('¶.', '').replace('&lt;p&gt;', '').replace(/<br>/gi, ' ')+'</div></div></a></li>';
//          var item = '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()"><div class="url mb-1 small text-body" title="'+escapeHtml(val.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.link.indexOf('https://')==0) ? 'https://' : 'http://')+val.displayLink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+val.displayLink.replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div><div class="d-flex w-100 align-items-center justify-content-between"><h5 class="mb-1 fw-normal" title="'+escapeHtml(val.title)+'">'+escapeHtml(val.title)+'</h5></div>'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_image!=='undefined' && typeof val.pagemap.cse_image[0]!=='undefined' && typeof val.pagemap.cse_image[0].src!=='undefined') ? '<div class="frame rounded-3 bg-light float-end ms-2"'+((typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined' && typeof val.pagemap.cse_thumbnail[0].width!=='undefined' && typeof val.pagemap.cse_thumbnail[0].height!=='undefined') ? ' style="background:top/cover no-repeat url(\''+val.pagemap.cse_thumbnail[0].src+'\');width:100px;height:'+Math.round((val.pagemap.cse_thumbnail[0].height*100)/val.pagemap.cse_thumbnail[0].width)+'px;"' : '')+'><img src="'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined' && val.pagemap.metatags[0]['og:image'].indexOf('dst-jpg_s150x150')!=-1) ? '/instagramprofileimage.php?url='+encodeURIComponent(val.pagemap.metatags[0]['og:image']) : ((val.pagemap.cse_image[0].src.charAt(0)=='/'/* This bug found on tutorialrepublic.com with search stackpath php sort */ && val.link.indexOf('https://'+val.displayLink+'/')==0) ? 'https://'+val.displayLink+'/' : '')+val.pagemap.cse_image[0].src).replace('_normal.jpg', '_200x200.jpg').replace('_normal.jpeg', '_200x200.jpeg')/* Twitter fix */+'" width="100" alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" onerror="'+((typeof val.pagemap.cse_thumbnail!=='undefined') ? 'this.src=\''+val.pagemap.cse_thumbnail[0].src+'\'' : '$(this).parent().remove()')+'" /></div>' : '')+'</a><div class="snippet mb-1 text-body text-opacity-75 small">'+((val.htmlSnippet.indexOf(' ago <b>...</b> ')!=-1) ? '<span'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']!=='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0]['article:published_time'])).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].lastpublisheddate)).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].pubdate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].pubdate)).toLocaleString())+'"' : '')+'><span class="text-danger">'+val.htmlSnippet.replace(' ago <b>...</b> ', ' ago</span> — ') : val.htmlSnippet).replace(' <b>...</b> ', ' — ').replace(' ¶', '').replace('&lt;p&gt;', '').replace(/<br>/gi, ' ')+((0&&typeof val.pagemap!=='undefined' && typeof val.pagemap.answer!=='undefined' && typeof val.pagemap.answer[0]!=='undefined' && typeof val.pagemap.answer[0].text!=='undefined') ? '<div class="alert alert-primary mt-1 p-2 small" role="alert"><strong>Answer: </strong>'+escapeHtml(val.pagemap.answer[0].text)+'</div>' : '')+'</div></li>';
          var item = '<li id="'+id+'" class="result '+((typeof val.url!=='undefined') ? 'bing ' : '')+'list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()"><div class="url mb-1 small text-body" title="'+escapeHtml(val.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.link.indexOf('https://')==0) ? 'https://' : 'http://')+val.displayLink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+val.displayLink.replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div><div class="d-flex w-100 align-items-center justify-content-between"><h5 class="mb-1 fw-normal" title="'+escapeHtml(val.title)+'">'+escapeHtml(val.title)+'</h5></div>'+((typeof val.pagemap!=='undefined' && ((typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined' && val.displayLink!='twitter.com' && val.displayLink!='mobile.twitter.com') || (typeof val.pagemap.cse_image!=='undefined' && typeof val.pagemap.cse_image[0]!=='undefined' && typeof val.pagemap.cse_image[0].src!=='undefined' && val.displayLink!='www.instagram.com') || (typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined') || (typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['image']!=='undefined'))) ? '<div class="frame rounded-3 float-end ms-2"><img src="'+((typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined' && val.displayLink!='twitter.com' && val.displayLink!='mobile.twitter.com') ? val.pagemap.cse_thumbnail[0].src : ((typeof val.pagemap.cse_image!=='undefined' && typeof val.pagemap.cse_image[0]!=='undefined' && typeof val.pagemap.cse_image[0].src!=='undefined' && val.displayLink!='www.instagram.com') ? val.pagemap.cse_image[0].src.replace(/^(https:\/\/pbs\.twimg\.com\/profile_images\/.+)_normal\.([a-z]+)/i, "$1_200x200.$2")/* Twitter fix */ : ((typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined') ? ((val.pagemap.metatags[0]['og:image'].indexOf('dst-jpg_s150x150')!=-1) ? '/instagramprofileimage.php?url='+encodeURIComponent(val.pagemap.metatags[0]['og:image']) : val.pagemap.metatags[0]['og:image']) : val.pagemap.metatags[0]['image'])))+'" width="110"'+((typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined' && typeof val.pagemap.cse_thumbnail[0].width!=='undefined' && typeof val.pagemap.cse_thumbnail[0].height!=='undefined') ? ' height="'+((val.pagemap.cse_thumbnail[0].height*110)/val.pagemap.cse_thumbnail[0].width).toFixed(4)+'"' : '')+' alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" onerror="$(this).parent().remove();" /></div>' : '')+'</a><div class="snippet mb-1 text-body text-opacity-75 small">'+((val.htmlSnippet.indexOf(' ago <b>...</b> ')!=-1) ? '<span'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']!=='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0]['article:published_time'])).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].lastpublisheddate)).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].pubdate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].pubdate)).toLocaleString())+'"' : '')+'><span class="text-danger">'+val.htmlSnippet.replace(' ago <b>...</b> ', ' ago</span> — ') : val.htmlSnippet).replace(' <b>...</b> ', ' — ').replace(' ¶', '').replace('&lt;p&gt;', '').replace(/<br>/gi, ' ')+((0&&typeof val.pagemap!=='undefined' && typeof val.pagemap.answer!=='undefined' && typeof val.pagemap.answer[0]!=='undefined' && typeof val.pagemap.answer[0].text!=='undefined') ? '<div class="alert alert-primary mt-1 p-2 small" role="alert"><strong>Answer: </strong>'+escapeHtml(val.pagemap.answer[0].text)+'</div>' : '')+'</div>'+extra+'</li>';
          html += item;
//            if(val.link.replace(/\?.+$/, '').match(/^https:\/\/www\.instagram\.com\/[^\/]+\/$/i)!==null)
//              html += '<li class="list-group-item border-0 mb-3 p-0 lh-sm border-top border-bottom"><blockquote class="instagram-media" data-instgrm-permalink="'+val.link+'" data-instgrm-version="14" style="width:100%;overflow:hidden;margin-top:-100px;"></blockquote></li>';
          // If first page, check if define, if map, if stock, if weather
          //if(typeof data.queries!=='undefined' && typeof data.queries.request!=='undefined' && typeof data.queries.request[0]!=='undefined' && data.queries.request[0].startIndex==1)
          // Bing
          if($('#web > ol > li:not(.loading)').length<=5)    // Could be spell correction or something
          {
            // Video intent
            if(typeof sitedata[functionid].sort==='undefined' && key==0 && val.link.indexOf('https://www.youtube.com/watch?v=')!=-1)
              $('#web > ol').prepend('<li class="list-group-item border-0 pt-0 pb-1 lh-sm"><iframe class="d-block rounded-3" width="320" height="180" src="https://www.youtube.com/embed/'+val.link.substr(32)+'" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></li>');
            // Navigational intent
            if(typeof sitedata[functionid].sort==='undefined' && key==0 && q.trim().split(/\s+/).length<=4 /* Because of "rancho santa fe home insurance" search */ && val.link.length<=44 && (val.link.match(/^https?:\/\/[^\/]+\/$/i)!==null || val.link.match(/^https?:\/\/[^\/]+\/[^\/\.\?]+\/?$/i)!==null || ((val.displayLink=='www.instagram.com' || val.displayLink=='twitter.com' || val.displayLink=='www.tiktok.com') && val.link.match(/^https?:\/\/[^\/]+\/[^\/\.]+\/?\??.+$/i)!==null) || (val.link.match(/^https?:\/\/[^\/]+\/[^\/\.]+\/[^\/\.\?]+[\/\.]?$/i)!==null && val.link.length<=40 /* Because of "best smartphone" search */)))
              $('#web > ol').prepend('<li id="directlink" class="list-group-item border-0 pt-0 pb-3 lh-sm text-nowrap"><a class="btn btn-primary rounded-pill fw-semibold" href="'+val.link+'" onclick="pagehide()"><h4 class="m-0 small">'+escapeHtml(val.link.replace(/^https?:\/\//i, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\?.*$/i, '').replace(/\/$/i, ''))+' &nbsp;<i class="fa-solid fa-up-right-from-square"></i></h4></a></li>');
            else if(key==0 && ((!isIOSChrome && isChromium !== null && typeof isChromium !== "undefined" && vendorName === "Google Inc." && isOpera === false && isIEedge === false) || (isSafari && !isMobile.any()) || isFirefox || isIOSChrome) && Cookies.get('disabledefaultprompt')===undefined)
              $('#web > ol').prepend('<li id="defaultprompt" class="list-group-item border-0 pt-0 pb-3 lh-sm text-nowrap"><a class="btn btn-dark rounded-pill fw-semibold" href="/default.html" onclick="pagehide()"><h4 class="m-0 small">&#8594; '+__('Set Swurl Search as default')+'</h4></a><button type="button" class="btn btn-link btn-sm text-black-50 text-decoration-none" onclick="$(\'#defaultprompt\').fadeOut();Cookies.set(\'disabledefaultprompt\', 1, {expires:365, path:\'/\'});">'+__('Done')+'</button></li>');
            // if(val.link.match(/^https:\/\/(www\.tomsguide\.com|css-tricks\.com)\/.+/i)!==null)
            //  iframe(val.displayLink.replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, ''), val.link);
            if((new RegExp('^https?:\/\/'+val.displayLink+'\/[a-z]*$')).test(val.link)==false && $('#amazon').length==0 && 
              (val.displayLink=='www.amazon.com' || //  && val.link.indexOf('/dp/')!=-1  WILL ONLY NEED FOR EURO LATER
              val.displayLink=='www.amazon.co.uk' ||
              val.displayLink=='www.amazon.com.au' ||
              val.displayLink=='www.amazon.at' ||
              val.displayLink=='www.amazon.ca' ||
              val.displayLink=='www.amazon.fr' ||
              val.displayLink=='www.amazon.de' ||
              val.displayLink=='www.amazon.it' ||
              val.displayLink=='www.amazon.nl' ||
              val.displayLink=='www.amazon.es' ||
              val.displayLink=='www.wayfair.com' ||      // $0.15 EPC and a lot of clicks
              val.displayLink=='www.walmart.com' ||      // $0.05 EPC and a lot of clicks
              val.displayLink=='www.shopdisney.com'))    // $2.39 EPC and a lot of clicks
              amazon(q);
            if((new RegExp('^https?:\/\/'+val.displayLink+'\/[a-z]*$')).test(val.link)==false && $('#ebay').length==0 && 
              (val.displayLink=='www.ebay.com.au' ||
              val.displayLink=='www.ebay.at' ||
              val.displayLink=='ebay.be' ||
              val.displayLink=='www.ebay.be' ||
              val.displayLink=='www.benl.ebay.be' ||
              val.displayLink=='www.befr.ebay.be' ||
              val.displayLink=='www.ebay.be' ||
              val.displayLink=='www.ebay.ca' ||
              val.displayLink=='www.cafr.ebay.ca' ||
              val.displayLink=='www.ebay.fr' ||
              val.displayLink=='www.ebay.de' ||
              val.displayLink=='www.ebay.ie' ||
              val.displayLink=='www.ebay.it' ||
              val.displayLink=='www.ebay.nl' ||
              val.displayLink=='www.ebay.es' ||
              val.displayLink=='www.ebay.ch' ||
              val.displayLink=='www.ebay.co.uk' ||
              val.displayLink=='www.ebay.com' ||
              val.displayLink=='pages.ebay.com' ||
              val.displayLink=='charity.ebay.com'))
              ebay(q, val);
            if(key<7 && word=='' && val.link.match(/^https:\/\/www\.merriam-webster\.com\/(dictionary|thesaurus)\/[^\/]+/i)!==null && $('#dictionary').length==0)
            {
// API has origin, and international.  Test more later
// Could later switch to https://developer.wordnik.com/pricing, Duckduckgo uses it, or Not, maybe not as good as Google's one
              // https://medium.com/@martin.breuss/finding-a-useful-dictionary-api-52084a01503d
              word = val.link.match(/^https:\/\/www\.merriam-webster\.com\/(dictionary|thesaurus)\/([^\/]+)/i)[2];
              dictionary(word);
            }
            if(key<7 && stocksymbol=='' && val.link.indexOf('https://finance.yahoo.com/quote/')!=-1 && val.link.match(/https:\/\/finance\.yahoo\.com\/quote\/([a-z0-9-]+)/i)!=null && $('#stock').length==0)
            {
              stocksymbol = decodeURIComponent(val.link.match(/https:\/\/finance\.yahoo\.com\/quote\/([a-z0-9-]+)/i)[1]).replace(/-/, '');    // .replace for bitcoin/dogecoin/etc
              stock(stocksymbol);
              if($('#news').length==0)
                news(q);
            }
            if(key<7 && weatherlocation=='' && val.link.match(/^https:\/\/weather\.com\/.*weather\/(tenday|hourbyhour)\/l\/([^?:]+)/i)!=null && $('#weather').length==0)
            {
              weatherlocation = decodeURIComponent(val.link.match(/https:\/\/weather\.com\/.*weather\/(tenday|hourbyhour)\/l\/([^?:]+)/i)[2]).replace(/\+/g, ' ');
              weather(weatherlocation);
            }
            if(key<=5 &&    // https://swurl.com/?q=trail+salad
              (val.link.match(/redfin\.com\/[a-z]+\/.+/i)!=null ||                  // There is a postal address in meta here, that can be used to improve map like for "15553 Las Planideras dalzell"
              val.link.indexOf('zillow.com/homedetails/')!=-1 ||
              val.link.indexOf('zillow.com/b/')!=-1 ||                             // For buildings, like in NYC
              val.link.indexOf('realtor.com/realestateandhomes-detail/')!=-1 ||    // There is a postal address in meta here, that can be used to improve map like for "15553 Las Planideras dalzell"
              val.link.indexOf('loopnet.com/Listing/')!=-1 ||
              val.link.indexOf('www.google.com/maps')!=-1 ||
              val.link.indexOf('maps.google.com/maps')!=-1 ||
              val.link.match(/tripadvisor\.[a-z\.]+\/Hotel_Review-.+/i)!=null ||
              val.link.match(/tripadvisor\.[a-z\.]+\/Restaurant_Review-.+/i)!=null ||
              val.link.match(/https:\/\/www\.viator\.com\/[a-z0-9\-]+\/.+/i)!=null ||
              val.link.match(/expedia\.[a-z\.]+\/.+/i)!=null ||
//                  val.link.match(/marriott\.[a-z\.]+\/hotels\//i)!=null ||    // Didn't help for "Barcelona" search
              val.link.match(/www\.mapquest\.com\/[a-z]+\/[a-z]+/i)!=null ||
              val.link.match(/www\.city-data\.com\/locations\/[a-z]+/i)!=null ||
              val.link.match(/\.yelp\.com\/search/i)!=null ||
              val.link.match(/\.yelp\.com\/biz\//i)!=null) && $('#map').length==0 && $('#wikipedia').length==0 /* https://swurl.com/?q=bite+of+china */)
            {
              if(val.link.indexOf('zillow.com/homedetails/')!=-1 && (mapq=='' || mapq==q))
                mapq = val.title.replace(/\|.+$/, '');
              else if(mapq=='')
                mapq = q;
              map(mapq);
            }

            // ========================================================================
            // Recipe websites
            if(val.link.match(/^https:\/\/www\.allrecipes\.com\/.+/i)!==null && $('#allrecipes').length==0)
//              recipes(q);
              site(q, 'allrecipes', 'Allrecipes', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.allrecipes.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.allrecipes.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.allrecipes.com/recipe/');
            if(val.link.match(/^https:\/\/www\.foodandwine\.com\/.+/i)!==null && $('#foodandwine').length==0)
              site(q, 'foodandwine', 'Food & Wine', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.foodandwine.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.foodandwine.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.foodandwine.com/recipes/');
            if(val.link.match(/^https:\/\/www\.tasteofhome\.com\/.+/i)!==null && $('#delish').length==0)
              site(q, 'tasteofhome', 'Taste of Home', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.tasteofhome.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.tasteofhome.com/?s='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.tasteofhome.com/recipes/');
            if(val.link.match(/^https:\/\/www\.delish\.com\/cooking\/.+/i)!==null && $('#delish').length==0)
              site(q, 'delish', 'Delish', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.delish.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.delish.com/search/?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.delish.com/cooking/recipe-ideas/recipes/');
            if(val.link.match(/^https:\/\/www\.thepioneerwoman\.com\/food-cooking\/.+/i)!==null && $('#thepioneerwoman').length==0)
              site(q, 'thepioneerwoman', 'The Pioneer Woman', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.thepioneerwoman.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.thepioneerwoman.com/search/?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.thepioneerwoman.com/food-cooking/recipes/');
            if(val.link.match(/^https:\/\/www\.goodhousekeeping\.com\/food-recipes\/.+/i)!==null && $('#goodhousekeeping').length==0)
              site(q, 'goodhousekeeping', 'Good Housekeeping', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.goodhousekeeping.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.goodhousekeeping.com/search/?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.goodhousekeeping.com/food-recipes/');
            if(val.link.match(/^https:\/\/www\.epicurious\.com\/recipes.+/i)!==null && $('#epicurious').length==0)
              site(q, 'epicurious', 'Epicurious', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.epicurious.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.epicurious.com/search/'+encodeURIComponent(q), 'www.epicurious.com/recipes/');
            if(val.link.match(/^https:\/\/www\.foodnetwork\.com\/recipes\/.+/i)!==null && $('#foodnetwork').length==0)
              site(q, 'foodnetwork', 'Food Network', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.foodnetwork.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.foodnetwork.com/search/'+encodeURIComponent(q).replaceAll('%20', '-')+'-', 'www.foodnetwork.com/recipes/');
            if(val.link.match(/^https:\/\/www\.bonappetit\.com\/.*recipe.*/i)!==null && $('#bonappetit').length==0)
              site(q, 'bonappetit', 'Bon Appétit', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.bonappetit.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.bonappetit.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.bonappetit.com/recipe/');
            // ========================================================================

            // ========================================================================
            // Coding websites
            if(val.link.match(/^https:\/\/github\.com\/.+/i)!==null && $('#github').length==0)
              site(q+' -gist', 'github', 'GitHub', '<i class="fa-brands fa-github" aria-hidden="true"></i>', 'https://github.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'github.com');
            if(val.link.match(/^https:\/\/gist\.github\.com\/.+/i)!==null && $('#githubgist').length==0)
              site(q, 'githubgist', 'GitHub Gist', '<i class="fa-brands fa-github" aria-hidden="true"></i>', 'https://gist.github.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'gist.github.com');
            if(val.link.match(/^https:\/\/www\.php\.net\/manual\/.+/i)!==null && $('#php').length==0)
              site(q, 'php', 'PHP', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.php.net&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.php.net/manual-lookup.php?pattern='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.php.net/manual/');
            if(val.link.match(/^https:\/\/www\.w3schools\.com\/[^\/]+\/.*/i)!==null && $('#w3schools').length==0)
              site(q, 'w3schools', 'W3Schools', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.w3schools.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.w3schools.com/#gsc.tab=0&gsc.q='+encodeURIComponent(q), 'www.w3schools.com');
            // ========================================================================

            // ========================================================================
            // Med websites
            if(val.link.match(/^https:\/\/medlineplus\.gov\/.+/i)!==null && $('#medlineplus').length==0)
              site(q, 'medlineplus', 'MedlinePlus', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://medlineplus.gov&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://vsearch.nlm.nih.gov/vivisimo/cgi-bin/query-meta?v%3Aproject=medlineplus&v%3Asources=medlineplus-bundle&query='+encodeURIComponent(q).replaceAll('%20', '+'), 'medlineplus.gov');
            if(val.link.match(/^https:\/\/www\.webmd\.com\/.+/i)!==null && $('#webmd').length==0)
              site(q, 'webmd', 'WebMD', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.webmd.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.webmd.com/search/search_results/default.aspx?query='+encodeURIComponent(q), 'www.webmd.com');
            if(val.link.match(/^https:\/\/www\.mayoclinic\.org\/.+/i)!==null && $('#mayoclinic').length==0)
              site(q, 'mayoclinic', 'Mayo Clinic', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.mayoclinic.org&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.mayoclinic.org/search/search-results?q='+encodeURIComponent(q), 'www.mayoclinic.org');
            if(val.link.match(/^https:\/\/www\.healthline\.com\/.+/i)!==null && $('#healthline').length==0)
              site(q, 'healthline', 'Healthline', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.healthline.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.healthline.com/search?q1='+encodeURIComponent(q), 'www.healthline.com');
            if(val.link.match(/^https:\/\/www\.cdc\.gov\/.+\.html/i)!==null && $('#cdc').length==0)
            site(q, 'cdc', 'CDC', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.cdc.gov&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://search.cdc.gov/search/?query='+encodeURIComponent(q)+'&dpage=1', 'www.cdc.gov');
            // ========================================================================

            // ========================================================================
            // Review websites
            if(val.link.match(/^https:\/\/www\.nytimes\.com\/wirecutter\/reviews\/.+/i)!==null && $('#wirecutter').length==0)
              site(q, 'wirecutter', 'Wirecutter', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.nytimes.com/wirecutter/&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.nytimes.com/wirecutter/search/?s='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.nytimes.com/wirecutter/reviews/');
            if(val.link.match(/^https:\/\/www\.consumerreports\.org\/[^\/]+\//i)!==null && $('#consumerreports').length==0)
              site(q, 'consumerreports', 'Consumer Reports', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.consumerreports.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.consumerreports.org/search/?query='+encodeURIComponent(q), 'www.consumerreports.org');
            // ========================================================================

            // ========================================================================
            // Question websites
            if(val.link.match(/^https:\/\/www\.quora\.com\/.+/i)!==null && $('#quora').length==0)
              site(q, 'quora', 'Quora', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.quora.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.quora.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.quora.com');
            if(val.link.match(/^https:\/\/.*stackexchange\.com\/questions\/.+/i)!==null && $('#stackexchange').length==0)
              site(q, 'stackexchange', 'Stack Exchange', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://stackexchange.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://stackexchange.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'stackexchange.com/questions/');
            if(val.link.match(/^https:\/\/stackoverflow\.com\/questions\/.+/i)!==null && $('#stackoverflow').length==0)
              site(q, 'stackoverflow', 'Stack Overflow', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://stackoverflow.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://stackoverflow.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'stackoverflow.com/questions/');
            // ========================================================================

            // ========================================================================
            // People websites
            if(val.link.match(/^https:\/\/[a-z]+\.linkedin\.com\/in\/.+/i)!==null && $('#linkedin').length==0)
            {
              site(q, 'linkedin', 'LinkedIn', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.linkedin.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.linkedin.com/search/results/people/?keywords='+encodeURIComponent(q), 'www.linkedin.com/in/');
//              images(q);
            }
            // ========================================================================

            // ========================================================================
            // NFT/Crypto websites
            if(val.link.match(/^https:\/\/opensea\.io\/.+/i)!==null && $('#opensea').length==0)
              site(q, 'opensea', 'OpenSea', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://opensea.io&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://opensea.io/assets?search[query]='+encodeURIComponent(q), 'opensea.io');
            if(val.link.match(/^https:\/\/www\.coindesk\.com\/.+/i)!==null && $('#coindesk').length==0)
              site(q, 'coindesk', 'CoinDesk', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.coindesk.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.coindesk.com/search?s='+encodeURIComponent(q), 'www.coindesk.com');
            // ========================================================================

            // ========================================================================
            // Shopping websites
            if(val.link.match(/^https:\/\/www\.etsy\.com\/(c|(market)|(listing))\/.+/i)!==null && $('#etsy').length==0)
              site(q, 'etsy', 'Etsy', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.etsy.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.etsy.com/search?q='+encodeURIComponent(q), 'www.etsy.com/listing/');
            if(val.link.match(/^https:\/\/www\.target\.com\/(s|p|(listing))\/.+/i)!==null && $('#target').length==0)
              site(q, 'target', 'Target', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.target.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.target.com/s?searchTerm='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.target.com/p/');
            if(val.link.match(/^https:\/\/www\.walmart\.com\/((ip)|(browse))\/.+/i)!==null && $('#walmart').length==0)
              site(q, 'walmart', 'Walmart', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.walmart.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://www.walmart.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'www.walmart.com/ip/');
            // ========================================================================

            if(val.link.match(/^https:\/\/www\.youtube\.com\/.+/i)!==null && $('#youtube').length==0)
               youtube(q);
            if(val.link.match(/^https:\/\/[a-z]+\.wikipedia\.org\/wiki\/[^#]+/i)!==null && val.htmlSnippet.indexOf(' may refer to: ')==-1 && $('#wikipedia').length==0)
              wikipedia(val);
            if(val.link.match(/^https:\/\/(mobile\.)?twitter\.com\/[^\/]+$/i)!==null && val.link.match(/twitter\.com\/login$/i)===null && val.link.match(/twitter\.com\/explore$/i)===null && $('#twitter').length==0)
//              twitter(val);
              tweets(q);
            if(val.link.match(/^https:\/\/www\.instagram\.com\/[^\/]+/i)!==null && $('#instagram').length==0)
              instagram(q);
            if((val.link.match(/^https:\/\/www\.tiktok\.com\/.+/i)!==null || (val.link.match(/^https:\/\/www\.instagram\.com\/[^\/]+/i)!==null && key<3)) && $('#tiktok').length==0)
              tiktok(q);
            if(val.link.match(/^https:\/\/www\.reddit\.com\/[^\/]+/i)!==null && $('#reddit').length==0)
              reddit(q);

            if(val.displayLink!='www.consumerreports.org' && val.displayLink!='www.tomsguide.com' && typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']!=='undefined' && val.htmlSnippet.indexOf(' <b>...</b> ')!=-1 /* Sometimes spam websites have published_time, but not real */)
            {
              if(Date.now()-Date.parse(val.pagemap.metatags[0]['article:published_time'])<=2592000000*1)
              {
                if($('#news').length==0)
                  news(q);
              }
              if(Date.now()-Date.parse(val.pagemap.metatags[0]['article:published_time'])<=2592000000*12)
                newscount++;
            }
            // This can break down on real estate results
            else if(val.displayLink!='www.zillow.com' && val.displayLink!='twitter.com' && (val.htmlSnippet.indexOf(' days ago <b>...</b> ')!=-1 || val.htmlSnippet.indexOf(' day ago <b>...</b> ')!=-1 ||val.htmlSnippet.indexOf(' hours ago <b>...</b> ')!=-1 || val.htmlSnippet.indexOf(' hour ago <b>...</b> ')!=-1 || val.htmlSnippet.indexOf(' seconds ago <b>...</b> ')!=-1 /* Sometimes no article:published_time, but is recent article, like https://www.motor1.com/news/609863/bmw-m5-cs-gpower-hurricane/ */))
            {
              if($('#news').length==0)
                news(q);
              newscount++;
            }
          }
        }
      });
      //if(typeof data.queries!=='undefined' && typeof data.queries.request!=='undefined' && typeof data.queries.request[0]!=='undefined' && data.queries.request[0].startIndex==1)
      // Bing
      if($('#web > ol > li:not(.loading)').length<=5)    // Could be spell correction or something
      {
        if(newscount>=3 && $('#news').length==0)
          news(q);
        if($('#youtube').length==0)
          youtube(q);
        if($('#images').length==0)
          images(q);
        if($('#instagram').length==0 && ($('#twitter').length || $('#tweets').length || $('#news').length))
          instagram(q);
        if($('#news').length==0)
          news(q);
        if($('#instagram').length==0)
          instagram(q);
//        if($('#twitter').length==0 && $('#tweets').length==0)
        if($('#tweets').length==0)
          tweets(q);
        if($('#reddit').length==0)
          reddit(q);
//        if($('#tiktok').length==0)
//          tiktok(q);
//        if($('#hackernews').length==0)
//          site(q, 'hackernews', 'Hacker News', '<img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://news.ycombinator.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL">', 'https://hn.algolia.com/?q='+encodeURIComponent(q).replaceAll('%20', '+'), 'news.ycombinator.com/item');
//        if($('#setdefault').length==0)
//          setdefault();
        setmenu();
// @@@@@@@@@@@@ don't do this later???!!!
        $.getJSON('https://duckduckgo.com/?q='+encodeURIComponent(q)+'&format=json&callback=?&no_redirect=1&skip_disambig=1', function(data){if(Cookies.get('debug')!==undefined)console.log(data);
          if(typeof data.Answer==='string' && data.Answer!='' && data.AnswerType!='duckduckgo')
          {
            $('#web > ol').prepend('<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><div id="answer" class="alert alert-primary m-0 p-2" role="alert"><h6 class="alert-heading"><strong>Answer:</strong></h6>'+data.Answer.replace('https://duckduckgo.com/?q=', 'https://swurl.com/?q=').replace('&iar=maps_maps', '')+'</div></li>');
//                ga('send', 'event', 'answer', 'show', q);
          }
          else if(data.Redirect!='')    // https://duckduckgo.com/api !bang redirect
          {
//                ga('send', 'event', 'answer', 'redirect', q);
            pagehide();
            window.location.replace(data.Redirect);
          }
          else if(data.AnswerType=='calc' || data.AnswerType=='conversions')
          {
            $.getJSON('https://suggestqueries.google.com/complete/search?client=chrome&hl='+encodeURIComponent(LANG)+'&gl='+encodeURIComponent(COUNTRY)+'&q='+encodeURIComponent(q)+'&callback=?', function(data){if(Cookies.get('debug')!==undefined)console.log(data);
              if(data[2][0]=='Calculator')
              {
                $('#web > ol').prepend('<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><div id="answer" class="alert alert-primary m-0 p-2" role="alert"><h6 class="alert-heading"><strong>Answer:</strong></h6>'+escapeHtml(q)+' '+escapeHtml(data[1][0]).replace('= ', '= <strong>')+'</strong></div></li>');
//                    ga('send', 'event', 'answer', 'calc', q);
              }
            });
          }
        });
//          if((!document.referrer || document.referrer.indexOf('https://picclick.')==-1) && shopping)
//            shop(q);
/*
        else if($(window).width()>768 && $(window).height()>768)
        {
          $('#web > ol').before('<div id="ads" data-s1search="mainline-top"></div>');
          (function(d, script){
            script = d.createElement('script');
            script.type = 'text/javascript';
            script.async = true;
            script.src = 'https://s.flocdn.com/@s1/embedded-search/embedded-search.js';
            d.getElementsByTagName('head')[0].appendChild(script);
          }(document));
          $.getJSON('/signature.php?q='+encodeURIComponent(q), function(signature){
            ga(function(tracker){
              window.s1search = window.s1search || function(){ (window.s1search.q = window.s1search.q || []).push(arguments) };
              window.s1search('config', {
                category:'web',
                domain:'swurl.com',
                partnerId:41300,
                isTest:false,
                onComplete:function(data){ if(data.adcount) document.getElementById('ads').style.minHeight = 0; else document.getElementById('ads').remove(); },
                onError:function(){ document.getElementById('ads').remove(); },
                query:q,
                segment:'swurl2',
                signature:signature,
                gdprOptIn:true,
                clickTrackingUrl:'https://www.google-analytics.com/collect?v=1&t=event&ec=ads&ea=click&el={extra_args[position]}&cid='+tracker.get('clientId')+'&tid='+tracker.get('trackingId')+'&z='+(new Date().getTime())
              });
            });
          });
        }
*/
      }
      $('#web .loading').remove();
      if(html!='')
      {
        $('#web > ol').append(first+second+html);
        // Default intent
//        if($('#web > ol > li:not(.loading)').length<=15 && !isIOSChrome && isChromium !== null && typeof isChromium !== "undefined" && vendorName === "Google Inc." && isOpera === false && isIEedge === false && Cookies.get('disabledefaultprompt')===undefined)
//          $('#web > ol').append('<li id="defaultprompt" class="list-group-item border-0 pt-0 pb-3 lh-sm text-nowrap"><a class="btn btn-primary rounded-pill fw-semibold" href="/default.html" onclick="pagehide()"><h4 class="m-0 small">'+__('Set Swurl Search as default')+'</h4></a><button type="button" class="btn btn-link btn-sm text-black-50" onclick="$(\'#defaultprompt\').remove();Cookies.set(\'disabledefaultprompt\', 1, {expires:365, path:\'/\'});"><i class="fa-solid fa-xmark"></i></button></li>');
        $('#web .numresults').html(data.searchInformation.formattedTotalResults);
        delete siteloading[functionid];
        if($('#web > ol > li').length!=0 && $('#web > ol').height()>=$('#web > ol')[0].scrollHeight-100)
        {
          scrolled['web'] = true;
          checkscroll();
        }
      }
      if($('#web > ol > li').length==0)
      {
        $('#web').append('<div id="noresults" class="px-3 small"><p>'+__('Your search')+' - <strong>'+escapeHtml(q)+'</strong> - '+__('did not match any results.</p><p>Suggestions:</p><ul><li>Make sure all words are spelled correctly.</li><li>Try different keywords.</li><li>Try more general keywords.</li><li>Try fewer keywords.</li></ul></div>'));
        $('#web .numresults').html(0);
      }
    });
  }
}
var youtubenewcount = 0;
function youtube(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  if(typeof sitedata['youtube2']!=='undefined')
  {
    youtube2(q);
    return;
  }
  // ##### could use this later!
  // https://www.youtube.com/feeds/videos.xml?channel_id=UCOWcZ6Wicl-1N34H0zZe38w
  var functionid = 'youtube';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || typeof sitedata[functionid].nextPageToken!=='undefined'))
  {
    siteloading[functionid] = true;
    if($('#youtube').length==0)
    {
      $('#scrollto').append('<li id="item-youtube" class="list-inline-item"><label for="youtube" title="YouTube" aria-label="YouTube" class="btn btn-tab" onclick="scrollto(this);"><img src="/img/logo/youtube.png"></label></li>');
      $('#main').append('<div id="youtube" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.youtube.com/results?search_query='+encodeURIComponent(q).replaceAll('%20', '+')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="/img/logo/youtube.png"> <span class="text">YouTube</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle pb-2" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#youtube > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].nextPageToken=\'\';if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#youtube > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].nextPageToken=\'\';if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#youtube > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].nextPageToken=\'\';if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'viewCount\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by view count')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#youtube > ol').scroll(scroll);
    }
    $('#youtube > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder"></div><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="mb-1 small"><span class="placeholder rounded-1 col-5"></span></div></li>'.repeat(10));
    $.ajax({
      url:d1+'youtube/v3/search?'+a1+'q='+encodeURIComponent(q)+'&part=snippet&type=video&maxResults=10'+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].nextPageToken!=='undefined') ? '&pageToken='+encodeURIComponent(sitedata[functionid].nextPageToken) : '')+((COUNTRY!='') ? '&regionCode='+encodeURIComponent((COUNTRY=='uk') ? 'gb' : COUNTRY) : '')+'&relevanceLanguage='+encodeURIComponent(LANG)+((Cookies.get('disablesafesearch')!==undefined) ? '&safeSearch=none' : '')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&order='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true,
      dataType:'jsonp',
      jsonp:'callback',
      jsonpCallback:'googlevideos'
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      $.each(data.items, function(key, val){
        var id = 'youtube-'+('https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)).toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
//        html += '<li onmouseleave="videoend()"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)+'" onclick="ga(\'send\', \'event\', \'videos\', \'click\', \'youtube.com\');this.blur();" oncontextmenu="this.blur();"><div class="frame"><div class="image" title="'+escapeHtml(val.snippet.title)+'"><img loading="eager" src="https://i.ytimg.com/vi/'+val.id.videoId+'/hqdefault.jpg" id="'+val.id.videoId+'" alt="'+escapeHtml(val.snippet.title)+'" title="'+escapeHtml(val.snippet.title)+'" onerror="this.src=\'/404.gif\'" onmouseenter="videostart(this)" /></div></div><div class="text"><div class="url" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)+'"><img loading="eager" src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube' +'<span class="text-body text-opacity-50"> &middot; '+escapeHtml(val.snippet.channelTitle)+'</span></div><h3 title="'+escapeHtml(val.snippet.title)+'">'+escapeHtml(val.snippet.title)+'</h3><div class="url text-body text-opacity-50" title="'+escapeHtml(new Date(Date.parse(val.snippet.publishedAt)).toLocaleString())+'">'+timeago(val.snippet.publishedAt)/* +' &middot; '+escapeHtml(val.snippet.channelTitle) */+'</div><div class="snippet">'+escapeHtml(val.snippet.description)+'</div></div></a></li>';
        html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-dark" title="'+escapeHtml(val.snippet.title)+'"><img src="https://i.ytimg.com/vi/'+val.id.videoId+'/hqdefault.jpg" width="320" height="240" alt="'+escapeHtml(val.snippet.title)+'" title="'+escapeHtml(val.snippet.title)+'" onerror="this.src=\'/404.gif\'" /><div class="overlay"><span class="play"></span></div></div><div class="url mb-1 small text-body" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.snippet.channelTitle)+'</span></div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.snippet.title)+'">'+escapeHtml(val.snippet.title)+'</h6></div></a><div class="mb-1 text-body text-opacity-50 small"><span title="'+escapeHtml(new Date(Date.parse(val.snippet.publishedAt)).toLocaleString())+'">'+timeago(val.snippet.publishedAt)+'</span></div></li>';
//        html += '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-black" title="'+escapeHtml(val.snippet.title)+'"><iframe width="288" height="162" src="https://www.youtube-nocookie.com/embed/'+encodeURIComponent(val.id.videoId)+'" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><div class="url mb-1 small text-body" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.id.videoId)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube' +'<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.snippet.channelTitle)+'</span></div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.snippet.title)+'">'+escapeHtml(val.snippet.title)+'</h6></div></a><div class="mb-1 text-body text-opacity-50 small"><span title="'+escapeHtml(new Date(Date.parse(val.snippet.publishedAt)).toLocaleString())+'">'+timeago(val.snippet.publishedAt)+'</span></div></li>';
        if(key<20 && Date.now()-Date.parse(val.snippet.publishedAt)<=86400000*5)
          youtubenewcount++;
      });
      $('#youtube .loading').remove();
      if(html!='')
      {
        // if(youtubenewcount>5 && $('#youtube > ol > li').length==0)
        // {
        //  $('#web').next().after($('#youtube'), $('#youtube').next());
        //  $('#item-web').after($('#item-youtube'));
        //  setmenu();
        // }
        $('#youtube > ol').append(html);
        $('#youtube .numresults').html(data.pageInfo.totalResults.toLocaleString());
        delete siteloading[functionid];
        if($('#youtube > ol').height()>=$('#youtube > ol')[0].scrollHeight-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else
      {
        if(typeof data.error!=='undefined')
          youtube2(q);
        else if($('#youtube > ol > li').length==0)
        {
          $('#youtube').next().remove();
          $('#youtube').remove();
          $('#item-youtube').remove();
          delete scrolled[functionid];
          setmenu();
        }
      }
    });
  }
}
var youtubenewcount2 = 0;
// https://stackoverflow.com/questions/9461621/format-a-number-as-2-5k-if-a-thousand-or-more-otherwise-900
function nFormatter(num, digits) {
  const lookup = [
  { value: 1, symbol: "" },
  { value: 1e3, symbol: "K" },
  { value: 1e6, symbol: "M" },
  { value: 1e9, symbol: "G" },
  { value: 1e12, symbol: "T" },
  { value: 1e15, symbol: "P" },
  { value: 1e18, symbol: "E" }
  ];
  const rx = /\.0+$|(\.[0-9]*[1-9])0+$/;
  var item = lookup.slice().reverse().find(function(item) {
  return num >= item.value;
  });
  return item ? (num / item.value).toFixed(digits).replace(rx, "$1") + item.symbol : "0";
}
function youtube2(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'youtube2';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100)))
  {
    siteloading[functionid] = true;
    $('#youtube > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder"></div><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="mb-1 small"><span class="placeholder rounded-1 col-5"></span></div></li>'.repeat(10));
    $.ajax({
      url:d1+'customsearch/v1?'+a1+c1+'siteSearch=www.youtube.com%2Fwatch&siteSearchFilter=i&q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true,
      dataType:'jsonp',
      jsonp:'callback',
      jsonpCallback:'googleyoutube'
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      $.each(data.items, function(key, val){
        var id = 'youtube-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null && typeof val.pagemap.videoobject!=='undefined')
        {
          // Setup
          if(typeof val.title==='undefined')
            val.title = val.link;
          if(typeof val.htmlSnippet==='undefined')
            val.htmlSnippet = val.title;
          // Make result HTML
          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-dark" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'"><img src="https://i.ytimg.com/vi/'+val.pagemap.videoobject[0].videoid+'/hqdefault.jpg" width="320" height="240" alt="'+escapeHtml(val.pagemap.videoobject[0].name)+'" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'" onerror="this.src=\'/404.gif\'" /><div class="overlay"><span class="play"></span></div><div class="duration">'+moment.duration(val.pagemap.videoobject[0].duration).format('hh:mm:ss').replace(/^0/, '')+'</div></div><div class="url mb-1 small text-body" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.pagemap.person[0].name)+'</span></div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'">'+escapeHtml(val.pagemap.videoobject[0].name)+'</h6></div></a><div class="mb-1 text-body text-opacity-50 small"><span title="'+escapeHtml(val.pagemap.videoobject[0].interactioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'">'+nFormatter(val.pagemap.videoobject[0].interactioncount)+' view'+((val.pagemap.videoobject[0].interactioncount!=1) ? 's' : '')+'</span> &bull; <span title="'+escapeHtml(new Date(Date.parse(val.pagemap.videoobject[0].datepublished)).toLocaleString())+'">'+timeago(val.pagemap.videoobject[0].datepublished)+'</span></div></li>';
//          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-black" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'"><iframe width="288" height="162" src="https://www.youtube-nocookie.com/embed/'+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><div class="url mb-1 small text-body" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube' +'<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.pagemap.person[0].name)+'</span></div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'">'+escapeHtml(val.pagemap.videoobject[0].name)+'</h6></div></a><div class="mb-1 text-body text-opacity-50 small">'+((typeof val.pagemap.videoobject[0].interactioncount!=='undefined') ? '<span title="'+escapeHtml(val.pagemap.videoobject[0].interactioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'">'+nFormatter(val.pagemap.videoobject[0].interactioncount)+' view'+((val.pagemap.videoobject[0].interactioncount!=1) ? 's' : '')+'</span> &bull; ' : '')+'<span title="'+escapeHtml(new Date(Date.parse(val.pagemap.videoobject[0].datepublished)).toLocaleString())+'">'+timeago(val.pagemap.videoobject[0].datepublished)+'</span></div></li>';
//          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-light" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'" onmouseenter="play(this, \''+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'\');" onmouseleave="stop(this);"><img src="https://i.ytimg.com/vi/'+val.pagemap.videoobject[0].videoid+'/hqdefault.jpg" width="288" height="216" alt="'+escapeHtml(val.pagemap.videoobject[0].name)+'" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'" onerror="this.src=\'/404.gif\'" /><div class="overlay"><span class="play"></span></div><div class="duration">'+moment.duration(val.pagemap.videoobject[0].duration).format('hh:mm:ss').replace(/^0/, '')+'</div></div><div class="url mb-1 small text-body" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube' +'<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.pagemap.person[0].name)+'</span></div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'">'+escapeHtml(val.pagemap.videoobject[0].name)+'</h6></div></a><div class="mb-1 text-body text-opacity-50 small"><span title="'+escapeHtml(val.pagemap.videoobject[0].interactioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'">'+nFormatter(val.pagemap.videoobject[0].interactioncount)+' view'+((val.pagemap.videoobject[0].interactioncount!=1) ? 's' : '')+'</span> &bull; <span title="'+escapeHtml(new Date(Date.parse(val.pagemap.videoobject[0].datepublished)).toLocaleString())+'">'+timeago(val.pagemap.videoobject[0].datepublished)+'</span></div></li>';
//          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-light" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'" onclick="play(this, \''+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'\');return false;" onmouseleave="stop(this);"><img src="https://i.ytimg.com/vi/'+val.pagemap.videoobject[0].videoid+'/hqdefault.jpg" width="288" height="216" alt="'+escapeHtml(val.pagemap.videoobject[0].name)+'" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'" onerror="this.src=\'/404.gif\'" /><div class="overlay"><span class="play"></span></div><div class="duration">'+moment.duration(val.pagemap.videoobject[0].duration).format('hh:mm:ss').replace(/^0/, '')+'</div></div><div class="url mb-1 small text-body" title="https://www.youtube.com/watch?v='+encodeURIComponent(val.pagemap.videoobject[0].videoid)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.youtube.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> YouTube' +'<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.pagemap.person[0].name)+'</span></div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.pagemap.videoobject[0].name)+'">'+escapeHtml(val.pagemap.videoobject[0].name)+'</h6></div></a><div class="mb-1 text-body text-opacity-50 small"><span title="'+escapeHtml(val.pagemap.videoobject[0].interactioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'">'+nFormatter(val.pagemap.videoobject[0].interactioncount)+' view'+((val.pagemap.videoobject[0].interactioncount!=1) ? 's' : '')+'</span> &bull; <span title="'+escapeHtml(new Date(Date.parse(val.pagemap.videoobject[0].datepublished)).toLocaleString())+'">'+timeago(val.pagemap.videoobject[0].datepublished)+'</span></div></li>';
          if(key<20 && Date.now()-Date.parse(val.pagemap.videoobject[0].datepublished)<=86400000*5)
            youtubenewcount++;
        }
        else
          if(Cookies.get('debug')!==undefined)console.log('videoobject undefined!!!');
      });
      $('#youtube .loading').remove();
      if(html!='')
      {
        // if(youtubenewcount>5 && $('#youtube > ol > li').length==0)
        // {
        //  $('#web').next().after($('#youtube'), $('#youtube').next());
        //  $('#item-web').after($('#item-youtube'));
        //  setmenu();
        // }
        $('#youtube > ol').append(html);
        $('#youtube .numresults').html(data.searchInformation.formattedTotalResults);
        delete siteloading[functionid];
        if($('#youtube > ol').height()>=$('#youtube > ol')[0].scrollHeight-100)
        {
          scrolled['youtube'] = true;
          checkscroll();
        }
      }
      else if($('#youtube > ol > li').length==0)
      {
        $('#youtube').next().remove();
        $('#youtube').remove();
        $('#item-youtube').remove();
        delete scrolled['youtube'];
        setmenu();
      }
    });
  }
}
// But getting too complicated, https://stackoverflow.com/questions/53546704/playing-one-youtube-video-at-a-time 
function play(el, videoid)
{
  if(Cookies.get('debug')!==undefined)console.log(el);
  if($(el).find('iframe').length==0)
    $(el).append('<iframe width="288" height="162" src="https://www.youtube.com/embed/'+encodeURIComponent(videoid)+'?autoplay=1&mute=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');
}
function stop(el)
{
  $(el).find('iframe').remove();
}
var offsetimages = 0;
function images_old(q)
{
// Because no further q should have site: in it
//q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'images';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || ($('#images > ol > li').length<1000 && $('#images > ol > li').length<sitedata[functionid].totalEstimatedMatches)))
  {
    siteloading[functionid] = true;
    if($('#images').length==0)
    {
      $('#scrollto').append('<li id="item-images" class="list-inline-item"><label for="images" title="'+__('Images')+'" aria-label="'+__('Images')+'" class="btn btn-tab" onclick="scrollto(this);"><img src="/img/logo/images.png"></label></li>');
      // old link: https://www.bing.com/images/search?q=
      $('#main').append('<div id="images" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.google.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+')+'&tbm=isch" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="/img/logo/images.png"> <span class="text">'+__('Images')+'</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="/?q='+encodeURIComponent(q).replace(/['()]/g, escape).replace(/%20/g, '+')+((nospellingcorrection==1) ? '&nospellingcorrection=1' : '')+'" onclick="pagehide()"><i class="fa-solid fa-check'+((sort=='') ? '' : ' invisible')+'"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="/?q='+encodeURIComponent(q).replace(/['()]/g, escape).replace(/%20/g, '+')+((nospellingcorrection==1) ? '&nospellingcorrection=1' : '')+'&sort=date" onclick="pagehide()"><i class="fa-solid fa-check'+((sort=='date') ? '' : ' invisible')+'"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#images > ol').scroll(scroll);
    }
    $('#images > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="w-100 align-items-center justify-content-between"><div class="small"><span class="placeholder rounded-1 col-12"></span></div></div><div class="url mb-1 small placeholder rounded-1 col-5"></div></li>'.repeat(10));
    $.ajax({
      url:'https://api.bing.microsoft.com/v7.0/images/search?q='+encodeURIComponent(q)+'&count=150&offset='+encodeURIComponent(offsetimages)+'&mkt='+encodeURIComponent(language)+((Cookies.get('disablesafesearch')!==undefined) ? '&safeSearch=Off' : ''),
      cache:true,
      beforeSend:function(xhr){
        xhr.setRequestHeader('Ocp-Apim-Subscription-Key', a3);
        // Makes it more locally relevant
        if(IP!='')
          xhr.setRequestHeader('X-MSEdge-ClientIP', IP);
      }
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      sitedata[functionid] = data;
      var html = '';
      $.each(data.value, function(key, val){
//        html += '<li><a href="'+val.contentUrl+'" onclick="pagehide()"><div class="frame"><div class="image" title="'+escapeHtml(val.name)+'"><img loading="eager" src="'+((val.contentUrl.indexOf('https://')==0) ? val.contentUrl : val.thumbnailUrl)+'" thumbnail="'+val.thumbnailUrl+'" href="'+val.hostPageUrl+'" w="'+((val.contentUrl.indexOf('https://')==0) ? val.width : val.thumbnail.width)+'" h="'+((val.contentUrl.indexOf('https://')==0) ? val.height : val.thumbnail.height)+'" alt="'+escapeHtml(val.name)+'" title="'+escapeHtml(val.name)+'" onload="bgcolor(this)" onerror="this.src=\''+val.thumbnailUrl+'\'" /><div class="size">'+val.width+' &times; '+val.height+'</div></div></div></a><a href="'+val.hostPageUrl+'" onclick="this.blur();return a(this);" oncontextmenu="this.blur();"><div class="text"><div class="url" title="'+escapeHtml(val.hostPageUrl)+'"><img loading="eager" src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.hostPageUrl.indexOf('https://')==0) ? 'https://' : 'http://')+extractHostname(val.hostPageUrl)+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+extractHostname(val.hostPageUrl).replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div><h3 title="'+escapeHtml(val.name)+'">'+escapeHtml(val.name)+'</h3></div></a></li>';
//        html += '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.hostPageUrl+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-light"><img src="'+val.contentUrl+'" width="288" height="'+Math.round((val.height*288)/val.width)+'" alt="'+escapeHtml(val.name)+'" title="'+escapeHtml(val.name)+'" onerror="this.src=\''+val.thumbnailUrl+'\'" onload="if(this.src.indexOf(\'https://i.ebayimg.com/\')==0 && $(this).naturalWidth()==80 && $(this).naturalHeight()==80)this.src=\''+val.thumbnailUrl+'\';" /><div class="size">'+val.width+' &times; '+val.height+'</div></div><div class="url mb-1 small text-body" title="'+escapeHtml(val.hostPageUrl)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.hostPageUrl.indexOf('https://')==0) ? 'https://' : 'http://')+extractHostname(val.hostPageUrl)+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+extractHostname(val.hostPageUrl).replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div><div class="d-flex w-100 align-items-center justify-content-between"><div class="mb-1 text-body text-opacity-75 small text-truncate" title="'+escapeHtml(val.name)+'">'+escapeHtml(val.name)+'</div></div></a></li>';
// Above old version links directly to website image, which can trigger red chrome danger, can't do...
        html += '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.contentUrl+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-light"><img src="'+val.thumbnailUrl+'" width="100%" height="'+Math.round((val.height*320)/val.width)+'" alt="'+escapeHtml(val.name)+'" title="'+escapeHtml(val.name)+'" /><div class="size">'+val.width+' &times; '+val.height+'</div></div></a><a href="'+val.hostPageUrl+'" onclick="pagehide()"><div class="d-flex w-100 align-items-center justify-content-between"><div class="text-body small text-truncate" title="'+escapeHtml(val.name)+'">'+escapeHtml(val.name)+'</div></div><div class="url mb-1 small text-body text-opacity-50" title="'+escapeHtml(val.hostPageUrl)+'">'+extractHostname(val.hostPageUrl).replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div></a></li>';
      });
      $('#images .loading').remove();
      if(html!='')
      {
        $('#images > ol').append(html);
        $('#images .numresults').html(data.totalEstimatedMatches.toLocaleString());
        offsetimages = data.nextOffset;
        delete siteloading[functionid];
        if($('#images > ol').height()>=$('#images > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#images > ol > li').length==0)
      {
        $('#images').next().remove();
        $('#images').remove();
        $('#item-images').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
// !!! Alternative image API? https://images.search.yahoo.com/search/images?o=js&p=bmw%20m5&b=1 
function images(q)
{
// Because no further q should have site: in it
//q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'images';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100)))
  {
    siteloading[functionid] = true;
    if($('#images').length==0)
    {
      $('#scrollto').append('<li id="item-images" class="list-inline-item"><label for="images" title="'+__('Images')+'" aria-label="'+__('Images')+'" class="btn btn-tab" onclick="scrollto(this);"><img src="/img/logo/images.png"></label></li>');// <i class="fa-regular fa-image" aria-hidden="true"></i>
      // old link: https://www.bing.com/images/search?q=
      $('#main').append('<div id="images" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.google.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+')+'&tbm=isch" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="/img/logo/images.png"> <span class="text">'+__('Images')+'</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#images > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#images > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#images > ol').scroll(scroll);
    }
    $('#images > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="w-100 align-items-center justify-content-between"><div class="small"><span class="placeholder rounded-1 col-12"></span></div></div><div class="url mb-1 small placeholder rounded-1 col-5"></div></li>'.repeat(10));
    $.ajax({
      url:d1+'customsearch/v1?'+a1+c1+'searchType=image&q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+'&hl='+encodeURIComponent(LANG)+'&gl='+encodeURIComponent(COUNTRY)+((Cookies.get('disablesafesearch')!==undefined) ? '&safe=off' : '&safe=active')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true,
      dataType:'jsonp',
      jsonp:'callback',
      jsonpCallback:'googleimages'
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      $.each(data.items, function(key, val){
        var id = 'images-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null)
          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-light"><img src="'+val.link+'" width="100%" height="'+Math.round((val.image.height*320)/val.image.width)+'" alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" onerror="this.src=\''+val.image.thumbnailLink+'\'" onload="if((this.src.indexOf(\'https://i.ebayimg.com/\')==0 && $(this).naturalWidth()==80 && $(this).naturalHeight()==80) || ($(this).naturalWidth()==300 && $(this).naturalHeight()==171) || ($(this).naturalWidth()==1 && $(this).naturalHeight()==1))this.src=\''+val.image.thumbnailLink+'\';" /><div class="size">'+val.image.width+' &times; '+val.image.height+'</div></div></a><a href="'+val.image.contextLink+'" onclick="pagehide()"><div class="d-flex w-100 align-items-center justify-content-between"><div class="text-body small text-truncate" title="'+escapeHtml(val.title)+'">'+escapeHtml(val.title)+'</div></div><div class="url mb-1 small text-body text-opacity-50" title="'+escapeHtml(val.image.contextLink)+'">'+extractHostname(val.displayLink).replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div></a></li>';
      });
      $('#images .loading').remove();
      if(html!='')
      {
        $('#images > ol').append(html);
        $('#images .numresults').html(data.searchInformation.formattedTotalResults);
        delete siteloading[functionid];
        if($('#images > ol').height()>=$('#images > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#images > ol > li').length==0)
      {
        $('#images').next().remove();
        $('#images').remove();
        $('#item-images').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
var offsetrecipes = 0;
function recipes(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'recipes';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || ($('#recipes > ol > li').length<1000 && $('#recipes > ol > li').length<sitedata[functionid].totalEstimatedMatches)))
  {
    siteloading[functionid] = true;
    if($('#recipes').length==0)
    {
      $('#scrollto').append('<li id="item-recipes" class="list-inline-item"><label for="recipes" title="'+__('Allrecipes')+'" aria-label="'+__('Allrecipes')+'" class="btn btn-tab" onclick="scrollto(this);"><i class="fa-solid fa-spoon" aria-hidden="true"></i></label></li>');
      $('#main').append('<div id="recipes" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.google.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+')+'&tbm=isch" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><i class="fa-solid fa-spoon" aria-hidden="true"></i> <span class="text">Allrecipes</span></a><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#recipes > ol').scroll(scroll);
    }
    $('#recipes > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="w-100 align-items-center justify-content-between"><div class="small"><span class="placeholder rounded-1 col-12"></span></div></div><div class="url mb-1 small placeholder rounded-1 col-5"></div></li>'.repeat(10));
    $.ajax({
      url:'https://api.bing.microsoft.com/v7.0/images/search?q='+encodeURIComponent(q)+'&count=10&offset='+encodeURIComponent(offsetrecipes)+'&mkt='+encodeURIComponent(language)+((Cookies.get('disablesafesearch')!==undefined) ? '&safeSearch=Off' : ''),
      cache:true,
      beforeSend:function(xhr){
        xhr.setRequestHeader('Ocp-Apim-Subscription-Key', a3);
        // Makes it more locally relevant
        if(IP!='')
          xhr.setRequestHeader('X-MSEdge-ClientIP', IP);
      }
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      sitedata[functionid] = data;
      var html = '';
      $.each(data.value, function(key, val){
        html += '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.contentUrl+'" onclick="pagehide()"><div class="frame mb-1 rounded-3 bg-light"><img src="'+val.thumbnailUrl+'" width="100%" height="'+Math.round((val.height*320)/val.width)+'" alt="'+escapeHtml(val.name)+'" title="'+escapeHtml(val.name)+'" /></div></a><a href="'+val.hostPageUrl+'" onclick="pagehide()"><div class="d-flex w-100 align-items-center justify-content-between"><div class="text-body small text-truncate" title="'+escapeHtml(val.name)+'">'+escapeHtml(val.name)+'</div></div><div class="url mb-1 small text-body text-opacity-50" title="'+escapeHtml(val.hostPageUrl)+'">'+extractHostname(val.hostPageUrl).replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div></a></li>';








      });
      $('#recipes .loading').remove();
      if(html!='')
      {
        $('#recipes > ol').append(html);
        offsetrecipes = data.nextOffset;
        delete siteloading[functionid];
        if($('#recipes > ol').height()>=$('#recipes > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#recipes > ol > li').length==0)
      {
        $('#recipes').next().remove();
        $('#recipes').remove();
        $('#item-recipes').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function news(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  // Bing options with images https://www.bing.com/news/search?q=%22show+jumping%22&FORM=HDRSC6&format=RSS&first=14
  // https://researchbuzz.me/2017/06/27/cooking-up-lots-of-rss-to-feed-your-news-monitoring-needs/
  // Could use Bing news api later, for paging, might be better
  var functionid = 'news';
  if(typeof siteloading[functionid]==='undefined' && $('#news > ol > li').length<100)
  {
    siteloading[functionid] = true;
    if($('#news').length==0)
    {
      $('#scrollto').append('<li id="item-news" class="list-inline-item"><label for="news" title="'+__('News')+'" aria-label="'+__('News')+'" class="btn btn-tab" onclick="scrollto(this);"><img src="/img/logo/newspaper.png"></label></li>');// <i class="fa-regular fa-newspaper" aria-hidden="true"></i>
      $('#main').append('<div id="news" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://news.google.com/search?q='+encodeURIComponent(q).replaceAll('%20', '+')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="/img/logo/newspaper.png"> <span class="text">'+__('News')+'</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults">100</span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#news > ol\').empty().scrollTop(0);delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#news > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#news > ol').scroll(scroll);
    }
    $('#news > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-4"></span></div></li>'.repeat(5));
    $.ajax({
      url:'/news.php?q='+encodeURIComponent(q)+'&language='+encodeURIComponent(language)+'&first='+($('#news > ol > li:not(.loading)').length+1)+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true
    }).done(function(data){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      var newsnewcount = 0;
      $(data).find('item').each(function(key, val){
        var $val = $(val),
        item = {
          title: $val.find('title').text(),
          description: $val.find('description').text(),
          link: decodeURIComponent($val.find('link').text().match(/&url=([^&]+)/)[1]),
          pubDate: $val.find('pubDate').text(),
          source: $val.find('News\\:Source').text(),
          image: $val.find('News\\:Image').text().replace('http://', 'https://').replace('&pid=News', ''),
          width: $val.find('News\\:ImageMaxWidth').text(),
          height: $val.find('News\\:ImageMaxHeight').text()
        };
        var id = 'news-'+item.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null)
//          html += '<li><a href="'+item.link+'" onclick="pagehide()"><div class="frame"><div class="image" title="'+escapeHtml(item.title)+'"><img loading="eager" src="'+((item.link.match(/^https:\/\/[a-z]+\.youtube\.com\/watch/)===null) ? 'https://api.swurl.com/screenshot?url='+encodeURIComponent(item.link)+'" onload="ocr(this)' : 'https://i.ytimg.com/vi/'+item.link.replace(/^https:\/\/[a-z]+\.youtube\.com\/watch(\?v=|\/)/, '').replace(/&.+/, '')+'/hqdefault.jpg" id="'+item.link.replace(/^https:\/\/[a-z]+\.youtube\.com\/watch(\?v=|\/)/, '').replace(/&.+/, '')+'" onmouseenter="videostart(this)')+'" alt="'+escapeHtml(item.title)+'" title="'+escapeHtml(item.title)+'" onload="ocr(this)" onerror="this.src=\'/404.gif\'" /></div></div><div class="text"><div class="url" title="'+item.link+'"><img loading="eager" src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((item.link.indexOf('https://')==0) ? 'https://' : 'http://')+extractHostname(item.link)+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+extractHostname(item.link).replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</div><h3 title="'+escapeHtml(item.title)+'">'+escapeHtml(item.title)+'</h3><div class="url text-body text-opacity-50" title="'+escapeHtml(new Date(Date.parse(item.pubDate)).toLocaleString())+'">'+timeago(item.pubDate)/* +' &middot; '+escapeHtml(item.source.replace(/\.(com|net|org)$/i, ''))+'</div><div class="snippet">'+escapeHtml(item.title.replace(/ - .+$/, '')) */+'</div><div class="snippet">'+escapeHtml(item.title.replace(/ - .+$/, ''))+'</div></div></a></li>';
          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+item.link+'" onclick="pagehide()">'+((item.image) ? '<div class="frame mb-1 rounded-3 bg-light"><img src="'+item.image+'" width="100%" height="'+((item.height*320)/item.width).toFixed(4)+'" alt="'+escapeHtml(item.title)+'" title="'+escapeHtml(item.title)+'" /></div>' : '')+'<div class="url mb-1 small text-body" title="'+escapeHtml(item.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((item.link.indexOf('https://')==0) ? 'https://' : 'http://')+extractHostname(item.link)+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+extractHostname(item.source)+'</div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(item.title)+'">'+escapeHtml(item.title)+'</h6></div></a><div class="snippet mb-1 text-body text-opacity-75 small">'+escapeHtml(item.description)+'</div><div class="mb-1 text-body text-opacity-50 small" title="'+escapeHtml(new Date(Date.parse(item.pubDate)).toLocaleString())+'">'+timeago(item.pubDate.replace(' GMT', ' PDT')/* Due to bug in feed time */)+'</div></li>';
        if(item.image && Date.now()-Date.parse(item.pubDate.replace(' GMT', ' PDT'))<=86400000*3)
          newsnewcount++;
      });
      $('#news .loading').remove();
      if(html!='')
      {
        // Sometimes can be boosted by simpele words like "cow"
        if(newsnewcount>=9 && $('#news > ol > li').length==0 && $('#dictionary').length==0 && typeof sitedata[functionid].sort==='undefined' /* Don't move if just did change in sort */)
        {
          // If youtube is there, and 2nd in order, push it up after youtube
          if($('#youtube').length!=0 && $('#web').next().next().attr('id')=='youtube')
          {
            $('#youtube').next().after($('#news'), $('#news').next());
            $('#item-youtube').after($('#item-news'));
          }
          else
          {
            $('#web').next().after($('#news'), $('#news').next());
            $('#item-web').after($('#item-news'));
          }
          setmenu();
        }
        $('#news > ol').append(html);
        delete siteloading[functionid];
        if($('#news > ol').height()>=$('#news > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#news > ol > li').length==0)
      {
        $('#news').next().remove();
        $('#news').remove();
        $('#item-news').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function instagram(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'instagram';
  if(Cookies.get('disableinstagram')===undefined && typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100)))
  {
    siteloading[functionid] = true;
    if($('#instagram').length==0)
    {
      $('#scrollto').append('<li id="item-instagram" class="list-inline-item"><label for="instagram" title="Instagram" aria-label="Instagram" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.instagram.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
      $('#main').append('<div id="instagram" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.instagram.com/explore/search/keyword/?q='+encodeURIComponent(q)+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.instagram.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">Instagram</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#instagram > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#instagram > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#instagram > ol').scroll(scroll);
    }
    $('#instagram > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm"><blockquote class="mb-0 border rounded-3"></blockquote></li>'.repeat(10));
    $.ajax({
      url:d1+'customsearch/v1?'+a1+c1+'siteSearch=www.instagram.com&siteSearchFilter=i&q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true,
      dataType:'jsonp',
      jsonp:'callback',
      jsonpCallback:'googleinstagram'
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      $.each(data.items, function(key, val){
        var id = 'instagram-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null && val.link.match(/\/about\//i)===null && val.link.match(/\/developer\//i)===null && val.link.match(/\/channel\/?$/i)===null && val.link.match(/\/feed\/?$/i)===null && val.link.match(/\/reels\/$/i)===null && val.link.match(/\/explore\//i)===null && val.link.match(/\/guides\//i)===null && val.link.match(/\/tagged\//i)===null && val.link.match(/\/invites\//i)===null && val.link.match(/\/accounts\//i)===null && val.link.match(/\/login\//i)===null && val.link.match(/https:\/\/www.instagram.com\/\?/i)===null && val.link.match(/^https:\/\/www\.instagram\.com\/.+/i)!==null)
        {
          // Setup
          if(typeof val.title==='undefined')
            val.title = val.link;
          if(typeof val.htmlSnippet==='undefined')
            val.htmlSnippet = val.title;
          // Make result HTML
          html +=  '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><blockquote class="instagram-media mb-0 border rounded-3"'+((val.link.indexOf('https://www.instagram.com/p/')==0) ? ' data-instgrm-captioned' : '')+' data-instgrm-permalink="'+val.link+'" data-instgrm-version="14" style="min-height:268px;"></blockquote></li>';
        }
      });
      $('#instagram .loading').remove();
      if(html!='')
      {
        $('#instagram > ol').append(html);
        $('#instagram .numresults').html(data.searchInformation.formattedTotalResults);
// If too many embeds, Instagram blocks
        delete siteloading[functionid];
        if($('#instagram > ol').height()>=$('#instagram > ol').height()-100)
        {
          scrolled['instagram'] = true;
          checkscroll();
        }
        if($('#instagramscript').length==0)
        {
          var script = document.createElement('script');
          script.id = 'instagramscript';
          script.type = 'text/javascript';
          script.async = true;
          script.src = 'https://www.instagram.com/embed.js';
          $('#instagram').append(script);
        }
        else
          instgrm.Embeds.process();    // https://stackoverflow.com/questions/32366979/instagram-embeds-js-library-not-loading
      }
      else if($('#instagram > ol > li').length==0)
      {
        $('#instagram').next().remove();
        $('#instagram').remove();
        $('#item-instagram').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function reddit(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'reddit';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100)))
  {
    siteloading[functionid] = true;
    if($('#reddit').length==0)
    {
      $('#scrollto').append('<li id="item-reddit" class="list-inline-item"><label for="reddit" title="Reddit" aria-label="Reddit" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.reddit.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
      $('#main').append('<div id="reddit" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.reddit.com/search/?q='+encodeURIComponent(q).replaceAll('%20', '+')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.reddit.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">Reddit</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#reddit > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#reddit > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#reddit > ol').scroll(scroll);
    }
    $('#reddit > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="url mb-1 small placeholder rounded-1 col-3"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="frame rounded-3 float-end ms-2"><div class="placeholder" style="width:110px;height:82.5px;"></div></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div></li>'.repeat(10));
    $.ajax({
      url:d1+'customsearch/v1?'+a1+c1+'siteSearch=reddit.com&siteSearchFilter=i&q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+((Cookies.get('disablesafesearch')!==undefined) ? '&safe=off' : '&safe=active')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true,
      dataType:'jsonp',
      jsonp:'callback',
      jsonpCallback:'googlereddit'
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      $.each(data.items, function(key, val){
        var id = 'reddit-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null)
        {
          // Setup
          if(typeof val.title==='undefined')
            val.title = val.link;
          if(typeof val.htmlSnippet==='undefined')
            val.htmlSnippet = val.title;
          // Make result HTML
          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()"><div class="url mb-1 small text-body" title="'+escapeHtml(val.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.reddit.com&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> Reddit</div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.title)+'">'+escapeHtml(val.title)+'</h6></div>'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined') ? '<div class="frame rounded-3 bg-light float-end ms-2"><img src="'+val.pagemap.cse_thumbnail[0].src+'" width="110"'+((typeof val.pagemap.cse_thumbnail[0].width!=='undefined' && typeof val.pagemap.cse_thumbnail[0].height!=='undefined') ? ' height="'+((val.pagemap.cse_thumbnail[0].height*110)/val.pagemap.cse_thumbnail[0].width).toFixed(4)+'"' : '')+' alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" /></div>' : '')+'</a><div class="snippet mb-1 text-body text-opacity-75 small">'+((val.htmlSnippet.indexOf(' ago <b>...</b> ')!=-1) ? '<span'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']!=='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0]['article:published_time'])).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].lastpublisheddate)).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].pubdate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].pubdate)).toLocaleString())+'"' : '')+'><span class="text-danger">'+val.htmlSnippet.replace(' ago <b>...</b> ', ' ago</span> — ') : val.htmlSnippet).replace(' <b>...</b> ', ' — ').replace(' ¶', '').replace('&lt;p&gt;', '').replace(/<br>/gi, ' ')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.answer!=='undefined' && typeof val.pagemap.answer[0]!=='undefined' && typeof val.pagemap.answer[0].text!=='undefined') ? '<div class="alert alert-primary mt-1 p-2 small" role="alert"><strong>Answer: </strong>'+escapeHtml(val.pagemap.answer[0].text)+'</div>' : '')+'</div></li>';
        }
      });
      $('#reddit .loading').remove();
      if(html!='')
      {
        $('#reddit > ol').append(html);
        $('#reddit .numresults').html(data.searchInformation.formattedTotalResults);
        delete siteloading[functionid];
        if($('#reddit > ol').height()>=$('#reddit > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#reddit > ol > li').length==0)
      {
        $('#reddit').next().remove();
        $('#reddit').remove();
        $('#item-reddit').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function setdefault()
{
  if($('#setdefault').length==0 && Cookies.get('disabledefaultprompt')===undefined)
  {
    var html = '';
    if(!isIOSChrome && isChromium !== null && typeof isChromium !== "undefined" && vendorName === "Google Inc." && isOpera === false && isIEedge === false)
      html = '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><p>1. Right-click the Chrome browser address bar & select <strong>Manage Search Engines and Site Search</strong><br><a href="/img/default/chrome1.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chrome1.png" /></a></p><p>2. Enter <strong>Swurl</strong> in the top right search field<br><a href="/img/default/chrome2.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chrome2.png" /></a></p><p>3. Find Swurl under <strong>Inactive shortcuts</strong>, click <button type="button" class="btn btn-light btn-sm rounded-pill" style="width:31px;"><i class="fa-solid fa-ellipsis-vertical"></i></button> & select <strong>Make default</strong><br><a href="/img/default/chrome3.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chrome3.png" /></a></p><p>You should now be able to search directly from the address bar of your browser.</p><p><button type="button" class="btn btn-primary rounded-pill" onclick="$(\'#item-setdefault\').fadeOut(400, function(){$(this).remove();});$(\'#setdefault\').fadeOut(400, function(){$(this).remove();});Cookies.set(\'disabledefaultprompt\', 1, {expires:365, path:\'/\'});"><h4 class="m-0 small">&nbsp;&nbsp;'+__('Done')+'&nbsp;&nbsp;</h4></button></p></li>';
    else if(isSafari && !isMobile.any())
      html = '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><p>1. '+__('In the menu choose <strong>Safari</strong> > <strong>Preferences</strong>, click <i class="fa-solid fa-gear"></i> <strong>General</strong>')+'<br><a href="/img/default/safari1.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/safari1.png" /></a></p><p>2. '+__('Under <strong>New windows open with</strong> choose <strong>Homepage</strong>')+'<br><a href="/img/default/safari2.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/safari2.png" /></a></p><p>3. '+__('Under <strong>New tabs open with</strong>, choose <strong>Homepage</strong>')+'<br><a href="/img/default/safari3.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/safari3.png" /></a></p><p>4. '+__('Under <strong>Homepage</strong> enter <strong>swurl.com</strong>')+'<br><a href="/img/default/safari4.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/safari4.png" /></a></p><p><button type="button" class="btn btn-primary rounded-pill" onclick="$(\'#item-setdefault\').fadeOut(400, function(){$(this).remove();});$(\'#setdefault\').fadeOut(400, function(){$(this).remove();});Cookies.set(\'disabledefaultprompt\', 1, {expires:365, path:\'/\'});"><h4 class="m-0 small">&nbsp;&nbsp;'+__('Done')+'&nbsp;&nbsp;</h4></button></p></li>';
    else if(isFirefox)
      html = '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><p>1. Click the Firefox browser address bar and click the <strong>Swurl</strong> icon<br><a href="/img/default/firefox1.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/firefox1.png" /></a></p><p>2. Click the <i class="fa-solid fa-gear"></i> icon on the right side<br><a href="/img/default/firefox2.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/firefox2.png" /></a></p><p>3. In the <strong>Default Search Engine</strong> dropdown, select <strong>Swurl</strong><br><a href="/img/default/firefox3.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/firefox3.png" /></a></p><p>You should now be able to search directly from the address bar of your browser.</p><p><button type="button" class="btn btn-primary rounded-pill" onclick="$(\'#item-setdefault\').fadeOut(400, function(){$(this).remove();});$(\'#setdefault\').fadeOut(400, function(){$(this).remove();});Cookies.set(\'disabledefaultprompt\', 1, {expires:365, path:\'/\'});"><h4 class="m-0 small">&nbsp;&nbsp;'+__('Done')+'&nbsp;&nbsp;</h4></button></p></li>';
    else if(isIOSChrome)
      html = '<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><p>1. Tap <i class="fa-solid fa-ellipsis"></i> on the bottom right<br><a href="/img/default/chromeios1.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chromeios1.png" /></a></p><p>2. Swipe to reveal and tap <i class="fa-solid fa-gear"></i> <strong>Settings</strong><br><a href="/img/default/chromeios2.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chromeios2.png" /></a></p><p>3. Tap <strong>Search Engine</strong><br><a href="/img/default/chromeios3.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chromeios3.png" /></a></p><p>4. Tap <strong>Swurl</strong> and tap <strong>Done</strong> on the top right<br><a href="/img/default/chromeios4.png" onclick="pagehide()"><img class="img-thumbnail" src="/img/default/chromeios4.png" /></a></p><p>You should now be able to search directly from the address bar of your browser.</p><p><button type="button" class="btn btn-primary rounded-pill" onclick="$(\'#item-setdefault\').fadeOut(400, function(){$(this).remove();});$(\'#setdefault\').fadeOut(400, function(){$(this).remove();});Cookies.set(\'disabledefaultprompt\', 1, {expires:365, path:\'/\'});"><h4 class="m-0 small">&nbsp;&nbsp;'+__('Done')+'&nbsp;&nbsp;</h4></button></p></li>';
    if(html!='')
    {
      $('#scrollto').append('<li id="item-setdefault" class="list-inline-item"><label for="setdefault" title="'+__('Set Swurl Search as default')+'" aria-label="'+__('Set Swurl Search as default')+'" class="btn btn-tab" onclick="scrollto(this);"><i class="fa-solid fa-circle-check"></i></label></li>');
      $('#main').append('<div id="setdefault" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="/default.html" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body text-nowrap"><i class="fa-solid fa-circle-check"></i> <span class="text">'+__('Set Swurl Search as default')+'</span></a><ol class="list-group list-group-flush scrollarea">'+html+'</ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled['setdefault'] = false;
      $('#setdefault > ol').scroll(scroll);
    }
  }
}
function site(q, functionid, name, icon, searchlink, sitesearch)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100)))
  {
    siteloading[functionid] = true;
    // Restore params
    if(name=='' && typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid]['name']!=='undefined')
      name = sitedata[functionid]['name'];
    if(sitesearch=='' && typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid]['sitesearch']!=='undefined')
      sitesearch = sitedata[functionid]['sitesearch'];
    if($('#'+functionid).length==0)
    {
      $('#scrollto').append('<li id="item-'+functionid+'" class="list-inline-item"><label for="'+functionid+'" title="'+name+'" aria-label="'+name+'" class="btn btn-tab" onclick="scrollto(this);">'+icon+'</label></li>');
      $('#main').append('<div id="'+functionid+'" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="'+searchlink+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body">'+icon+' <span class="text">'+name+'</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#'+functionid+' > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;site(q, \''+functionid+'\', \'\', \'\', \'\', \'\');return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#'+functionid+' > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';site(q, \''+functionid+'\', \'\', \'\', \'\', \'\');return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#'+functionid+' > ol').scroll(scroll);
    }
    $('#'+functionid+' > ol').append(('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25">'+((name!='Hacker News' && name!='Stack Overflow' && name!='Stack Exchange' && name!='Quora' && name!='W3Schools' && name!='GitHub Gist' && name!='MedlinePlus' && name!='Mayo Clinic' && name!='WebMD') ? '<div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div>' : '')+'<div class="url mb-1 small placeholder rounded-1 col-3"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div></li>').repeat(10));
    $.ajax({
      url:d1+'customsearch/v1?'+a1+c1+'siteSearch='+encodeURIComponent(sitesearch)+'&siteSearchFilter=i&q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+((Cookies.get('disablesafesearch')!==undefined) ? '&safe=off' : '&safe=active')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
      cache:true,
      dataType:'jsonp',
      jsonp:'callback',
      jsonpCallback:'google'+functionid
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      data['name'] = name;
      data['sitesearch'] = sitesearch;
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      $.each(data.items, function(key, val){
        var id = functionid+'-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        if(document.getElementById(id)==null)
        {
          // Setup
          if(typeof val.title==='undefined')
            val.title = val.link;
          if(typeof val.htmlSnippet==='undefined')
            val.htmlSnippet = val.title;
          var extra = '';
          // Needed for Consumer Reports
          if(typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_image==='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined')
            val.pagemap.cse_image = [{src:val.pagemap.metatags[0]['og:image']}];
          if(typeof val.pagemap!=='undefined' && typeof val.pagemap.qapage!=='undefined' && typeof val.pagemap.qapage[0]!=='undefined' && typeof val.pagemap.qapage[0].name!=='undefined')
            val.title = escapeHtml(val.pagemap.qapage[0].name);
          if(typeof val.pagemap!=='undefined' && typeof val.pagemap.qapage!=='undefined' && typeof val.pagemap.qapage[0]!=='undefined' && typeof val.pagemap.qapage[0].description!=='undefined')
            val.htmlSnippet = escapeHtml(val.pagemap.qapage[0].description);
          // Make result HTML
          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()">'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_image!=='undefined' && typeof val.pagemap.cse_image[0]!=='undefined' && typeof val.pagemap.cse_image[0].src!=='undefined' && val.displayLink!='stackoverflow.com' && val.displayLink.indexOf('stackexchange.com')==-1 && val.displayLink!='www.quora.com' && val.displayLink!='www.w3schools.com' && val.displayLink!='gist.github.com' && val.displayLink!='medlineplus.gov' && val.displayLink!='www.mayoclinic.org' && val.displayLink!='www.webmd.com' && val.pagemap.cse_image[0].src!='https://github.githubassets.com/images/modules/open_graph/github-logo.png' && val.pagemap.cse_image[0].src.indexOf('https://avatars.githubusercontent.com/')==-1 && val.pagemap.cse_image[0].src.indexOf('https://')==0) ? '<div class="frame mb-1 rounded-3'+((val.pagemap.cse_image[0].src.indexOf('https://opengraph.githubassets.com/')==0) ? ' border' : '')+' bg-light"><img src="'+val.pagemap.cse_image[0].src.replace('?s=80&', '?')/* Github */+'" width="100%"'+((typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined' && typeof val.pagemap.cse_thumbnail[0].width!=='undefined' && typeof val.pagemap.cse_thumbnail[0].height!=='undefined') ? ' height="'+((val.pagemap.cse_thumbnail[0].height*320)/val.pagemap.cse_thumbnail[0].width).toFixed(4)+'"' : '')+' alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" /></div>' : '')+'<div class="url mb-1 small text-body" title="'+escapeHtml(val.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.link.indexOf('https://')==0) ? 'https://' : 'http://')+val.displayLink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> '+name+'</div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.title)+'">'+escapeHtml(val.title.replace(' - Manual - PHP', ''))+'</h6></div>'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.question!=='undefined' && typeof val.pagemap.question[0]!=='undefined' && typeof val.pagemap.question[0].upvotecount!=='undefined' && typeof val.pagemap.question[0].answercount!=='undefined' && typeof val.pagemap.question[0].datecreated!=='undefined') ? '<div class="mb-1 text-body text-opacity-50 small">'+val.pagemap.question[0].upvotecount.replace(/\B(?=(\d{3})+(?!\d))/g, ",")+' vote'+((val.pagemap.question[0].upvotecount!=1) ? 's' : '')+' &bull; '+val.pagemap.question[0].answercount.replace(/\B(?=(\d{3})+(?!\d))/g, ",")+' answer'+((val.pagemap.question[0].answercount!=1) ? 's' : '')+' &bull; <span title="'+escapeHtml(new Date(Date.parse(val.pagemap.question[0].datecreated)).toLocaleString())+'">'+timeago(val.pagemap.question[0].datecreated)+'</span></div>' : '')+'</a><div class="snippet mb-1 text-body text-opacity-75 small">'+((val.htmlSnippet.indexOf(' ago <b>...</b> ')!=-1) ? '<span'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']!=='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0]['article:published_time'])).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].lastpublisheddate)).toLocaleString())+'"' : '')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0].pubdate!=='undefined' && typeof val.pagemap.metatags[0]['article:published_time']==='undefined' && typeof val.pagemap.metatags[0].lastpublisheddate==='undefined') ? ' title="'+escapeHtml(new Date(Date.parse(val.pagemap.metatags[0].pubdate)).toLocaleString())+'"' : '')+'><span class="text-danger">'+val.htmlSnippet.replace(' ago <b>...</b> ', ' ago</span> — ') : val.htmlSnippet).replace(' <b>...</b> ', ' — ').replace(' ¶', '').replace('&lt;p&gt;', '').replace(/<br>/gi, ' ')+((typeof val.pagemap!=='undefined' && typeof val.pagemap.answer!=='undefined' && typeof val.pagemap.answer[0]!=='undefined' && typeof val.pagemap.answer[0].text!=='undefined') ? '<div class="alert alert-secondary mt-2 mb-1 p-2" role="alert"><h6 class="mb-1 text-body">Answer</h6><div class="mb-1 text-body text-opacity-50">'+escapeHtml(val.pagemap.answer[0].upvotecount)+' vote'+((val.pagemap.answer[0].upvotecount!=1) ? 's' : '')+' &bull; '+timeago(val.pagemap.answer[0].datecreated)+'</div>'+escapeHtml(val.pagemap.answer[0].text)+'</div>' : '')+'</div>'+extra+'</li>';
        }
      });
      $('#'+functionid+' .loading').remove();
      if(html!='')
      {
        $('#'+functionid+' > ol').append(html);
        $('#'+functionid+' .numresults').html(data.searchInformation.formattedTotalResults);
        delete siteloading[functionid];
        if($('#'+functionid+' > ol').height()>=$('#'+functionid+' > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#'+functionid+' > ol > li').length==0)
      {
        $('#'+functionid).next().remove();
        $('#'+functionid).remove();
        $('#item-'+functionid).remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function tweets(q)
{
  if(Cookies.get('disabletwitter')===undefined)
  {
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();
  
    var functionid = 'tweets';
    if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].queries!=='undefined' && typeof sitedata[functionid].queries.nextPage!=='undefined' && sitedata[functionid].queries.nextPage[0].startIndex<=100)))
    {
      siteloading[functionid] = true;
      if($('#tweets').length==0)
      {
        $('#scrollto').append('<li id="item-tweets" class="list-inline-item"><label for="tweets" title="Twitter" aria-label="Twitter" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://twitter.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
        $('#main').append('<div id="tweets" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://twitter.com/search?q='+encodeURIComponent(q)+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://twitter.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">Twitter</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#tweets > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#tweets > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].queries!==\'undefined\' && typeof sitedata[\''+functionid+'\'].queries.nextPage!==\'undefined\')sitedata[\''+functionid+'\'].queries.nextPage[0].startIndex=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
        scrolled[functionid] = false;
        $('#tweets > ol').scroll(scroll);
      }
      $('#tweets > ol').append(('<li class="loading list-group-item border-0 pt-3 pb-4 lh-sm border-top placeholder-glow opacity-25"><div class="url mb-1 small placeholder rounded-1 col-3"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span></h6></div><div class="snippet mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div><div class="frame mb-3 rounded-3 placeholder" style="width:100%;height:180px;"></div></li>').repeat(10));
      $.ajax({
        url:d1+'customsearch/v1?'+a1+c1+'siteSearch=twitter.com%2F%2A%2Fstatus%2F&siteSearchFilter=i&q='+encodeURIComponent(q)+'&num=10&start='+((typeof sitedata[functionid]==='undefined') ? 1 : encodeURIComponent(sitedata[functionid].queries.nextPage[0].startIndex))+((Cookies.get('disablesafesearch')!==undefined) ? '&safe=off' : '&safe=active')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''),
        cache:true,
        dataType:'jsonp',
        jsonp:'callback',
        jsonpCallback:'googletweets'
      }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
        var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
        sitedata[functionid] = data;
        if(sort!='')
          sitedata[functionid].sort = sort;
        var html = '';
// Sort by likes
//if(typeof data.items!=='undefined')
//data.items = data.items.sort(function(a,b){return ((typeof b.pagemap!=='undefined' && typeof b.pagemap.interactioncounter!=='undefined') ? b.pagemap.interactioncounter[3].userinteractioncount : 0)-((typeof a.pagemap!=='undefined' && typeof a.pagemap.interactioncounter!=='undefined') ? a.pagemap.interactioncounter[3].userinteractioncount : 0)});
        $.each(data.items, function(key, val){
          var id = 'tweets-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
          if(document.getElementById(id)==null && typeof val.pagemap.person!=='undefined' && typeof val.pagemap.socialmediaposting!=='undefined' && typeof val.pagemap.interactioncounter!=='undefined')
          {
            if(typeof val.pagemap.socialmediaposting[0].articlebody!=='undefined')
//              val.pagemap.socialmediaposting[0].articlebodyhtml = val.pagemap.socialmediaposting[0].articlebody.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim, '<a href="$1" rel="noopener" target="_blank">$1</a>').replace(/#+([a-z0-9_]{2,})/gim, '<a href="https://twitter.com/hashtag/$1" rel="noopener" target="_blank">#$1</a>').replace(/(?<=^|(?<=[^a-z0-9-_\.]))@([a-z]+[a-z0-9-_]+)/gim, '<a href="https://twitter.com/$1" rel="noopener" target="_blank">@$1</a>');
              val.pagemap.socialmediaposting[0].articlebodyhtml = ((typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:description']!=='undefined') ? val.pagemap.metatags[0]['og:description'] : val.pagemap.socialmediaposting[0].articlebody).replace(/^“/, '').replace(/”$/, '').replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim, '<a href="$1" onclick="pagehide();event.stopPropagation();">$1</a>').replace(/(#|＃)([a-z0-9_\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0100-\u024f\u0253-\u0254\u0256-\u0257\u0300-\u036f\u1e00-\u1eff\u0400-\u04ff\u0500-\u0527\u2de0-\u2dff\ua640-\ua69f\u0591-\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05d0-\u05ea\u05f0-\u05f4\ufb12-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4f\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06de-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u0750-\u077f\u08a2-\u08ac\u08e4-\u08fe\ufb50-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\u200c-\u200c\u0e01-\u0e3a\u0e40-\u0e4e\u1100-\u11ff\u3130-\u3185\ua960-\ua97f\uac00-\ud7af\ud7b0-\ud7ff\uffa1-\uffdc\u30a1-\u30fa\u30fc-\u30fe\uff66-\uff9f\uff10-\uff19\uff21-\uff3a\uff41-\uff5a\u3041-\u3096\u3099-\u309e\u3400-\u4dbf\u4e00-\u9fff]*[a-z_\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0100-\u024f\u0253-\u0254\u0256-\u0257\u0300-\u036f\u1e00-\u1eff\u0400-\u04ff\u0500-\u0527\u2de0-\u2dff\ua640-\ua69f\u0591-\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05d0-\u05ea\u05f0-\u05f4\ufb12-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4f\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06de-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u0750-\u077f\u08a2-\u08ac\u08e4-\u08fe\ufb50-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\u200c-\u200c\u0e01-\u0e3a\u0e40-\u0e4e\u1100-\u11ff\u3130-\u3185\ua960-\ua97f\uac00-\ud7af\ud7b0-\ud7ff\uffa1-\uffdc\u30a1-\u30fa\u30fc-\u30fe\uff66-\uff9f\uff10-\uff19\uff21-\uff3a\uff41-\uff5a\u3041-\u3096\u3099-\u309e\u3400-\u4dbf\u4e00-\u9fff][a-z0-9_\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0100-\u024f\u0253-\u0254\u0256-\u0257\u0300-\u036f\u1e00-\u1eff\u0400-\u04ff\u0500-\u0527\u2de0-\u2dff\ua640-\ua69f\u0591-\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05d0-\u05ea\u05f0-\u05f4\ufb12-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4f\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06de-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u0750-\u077f\u08a2-\u08ac\u08e4-\u08fe\ufb50-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\u200c-\u200c\u0e01-\u0e3a\u0e40-\u0e4e\u1100-\u11ff\u3130-\u3185\ua960-\ua97f\uac00-\ud7af\ud7b0-\ud7ff\uffa1-\uffdc\u30a1-\u30fa\u30fc-\u30fe\uff66-\uff9f\uff10-\uff19\uff21-\uff3a\uff41-\uff5a\u3041-\u3096\u3099-\u309e\u3400-\u4dbf\u4e00-\u9fff]*)/gim, '<a href="https://twitter.com/hashtag/$2" onclick="pagehide();event.stopPropagation();">#$2</a>').replace(/(^|[^@\w])@(\w{1,15})\b/gm, '$1<a href="https://twitter.com/$2" onclick="pagehide();event.stopPropagation();">@$2</a>').replace(/\n/g, '<br>');    //https://stackoverflow.com/questions/8650007/regular-expression-for-twitter-username, https://stackoverflow.com/questions/8451846/actual-twitter-format-for-hashtags-not-your-regex-not-his-code-the-actual, removed due to JS limitation with unicde \u20000-\u2a6df\u2a700-\u2b73f\u2b740-\u2b81f\u2f800-\u2fa1f https://stackoverflow.com/questions/21109011/javascript-unicode-string-chinese-character-but-no-punctuation
            var mediahtml = '';
            // Doesn't work well enough..., can't distinguish between media from replies...
            if(0&&typeof val.pagemap!=='undefined' && typeof val.pagemap.imageobject!=='undefined' && val.pagemap.imageobject.length>1 && val.pagemap.imageobject.length<4)    // If more than 4, then some bug/error, so just do 1
            {
              mediahtml += '<a href="'+val.link+'" onclick="pagehide();event.stopPropagation();">';
              for(var i=0, len=val.pagemap.imageobject.length; i<len && i<4; i++)
                mediahtml += '<div class="frame mt-2 mb-1 rounded-3 bg-light"><img src="'+val.pagemap.imageobject[i].contenturl+'" width="100%" alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" onerror="$(this).parent().remove()" /></div>';
              mediahtml += '</a>';
            }
            else if(typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_image!=='undefined' && typeof val.pagemap.cse_image[0]!=='undefined' && typeof val.pagemap.cse_image[0].src!=='undefined' && val.pagemap.cse_image[0].src.indexOf('https://pbs.twimg.com/profile_images/')==-1 && typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined')
              mediahtml = '<a href="'+val.link+'" onclick="pagehide();event.stopPropagation();"><div class="frame mt-2 mb-1 rounded-3 bg-light"><img src="'+val.pagemap.cse_image[0].src.replace('.jpg:large', '?format=webp&name=small').replace('?format=jpg&name=4096x4096', '?format=webp&name=small')+'" width="100%"'+((typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined' && typeof val.pagemap.cse_thumbnail[0].width!=='undefined' && typeof val.pagemap.cse_thumbnail[0].height!=='undefined') ? ' height="'+((val.pagemap.cse_thumbnail[0].height*320)/val.pagemap.cse_thumbnail[0].width).toFixed(4)+'"' : '')+' alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" onerror="'+((typeof val.pagemap.cse_thumbnail!=='undefined') ? 'this.src=\''+val.pagemap.cse_thumbnail[0].src+'\'' : '$(this).parent().remove()')+'" /></div></a>';
            // Sometimes first 3 are missing for some reason...
            if(val.pagemap.interactioncounter.length==4)
            {console.log(val);
              val.pagemap.interactioncounter.unshift('', '', '');
            }
            // Make result HTML
            html += '<li id="'+id+'" class="list-group-item border-0 pt-3 pb-1 lh-sm border-top" onclick="pagehide();window.location.href=\''+escapeHtml(val.link)+'\';"><a href="'+val.link+'" onclick="pagehide();event.stopPropagation();"><div class="url mb-1 small text-body" title="'+escapeHtml(val.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.link.indexOf('https://')==0) ? 'https://' : 'http://')+val.displayLink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> Twitter</div></a><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body fw-bold"><a class="text-body" href="https://twitter.com/'+encodeURIComponent(val.pagemap.person[0].additionalname)+'" onclick="pagehide();event.stopPropagation();"><span class="givenname">'+escapeHtml(val.pagemap.person[0].givenname)+'</span>'+((typeof val.pagemap.person[0].disambiguatingdescription!=='undefined' && val.pagemap.person[0].disambiguatingdescription.indexOf('verified')!=-1) ? ' <svg width="18" height="18" fill="#1d9bf0" viewBox="0 0 24 24" aria-label="Verified account" role="img" class="align-bottom"><g><path d="M22.25 12c0-1.43-.88-2.67-2.19-3.34.46-1.39.2-2.9-.81-3.91s-2.52-1.27-3.91-.81c-.66-1.31-1.91-2.19-3.34-2.19s-2.67.88-3.33 2.19c-1.4-.46-2.91-.2-3.92.81s-1.26 2.52-.8 3.91c-1.31.67-2.2 1.91-2.2 3.34s.89 2.67 2.2 3.34c-.46 1.39-.21 2.9.8 3.91s2.52 1.26 3.91.81c.67 1.31 1.91 2.19 3.34 2.19s2.68-.88 3.34-2.19c1.39.45 2.9.2 3.91-.81s1.27-2.52.81-3.91c1.31-.67 2.19-1.91 2.19-3.34zm-11.71 4.2L6.8 12.46l1.41-1.42 2.26 2.26 4.8-5.23 1.47 1.36-6.2 6.77z"></path></g></svg>' : '')+'</a><span class="text-body text-opacity-50 fw-normal small"><a class="additionalname text-body text-opacity-50" href="https://twitter.com/'+encodeURIComponent(val.pagemap.person[0].additionalname)+'" onclick="pagehide();event.stopPropagation();"> @'+escapeHtml(val.pagemap.person[0].additionalname)+'</a> &middot; <a class="datepublished text-body text-opacity-50" href="'+val.link+'" onclick="pagehide();event.stopPropagation();" title="'+escapeHtml(new Date(Date.parse(val.pagemap.socialmediaposting[0].datepublished)).toLocaleString())+'">'+timeago2(val.pagemap.socialmediaposting[0].datepublished)+'</a></span></h6></div>'+((typeof val.pagemap.socialmediaposting[0].articlebody!=='undefined') ? '<div class="snippet mb-1 text-body">'+val.pagemap.socialmediaposting[0].articlebodyhtml+'</div>' : '')+mediahtml+((val.pagemap.interactioncounter.length>=7) ? '<div class="text-body text-opacity-50 small"><a class="tweet text-body text-opacity-50" href="https://twitter.com/intent/tweet?in_reply_to='+encodeURIComponent(val.pagemap.socialmediaposting[0].identifier)+'" onclick="pagehide();event.stopPropagation();" title="'+escapeHtml(val.pagemap.interactioncounter[6].userinteractioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'"><i class="fa-regular fa-comment"></i> '+nFormatter(val.pagemap.interactioncounter[6].userinteractioncount)+'</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="retweet text-body text-opacity-50" href="https://twitter.com/intent/retweet?tweet_id='+encodeURIComponent(val.pagemap.socialmediaposting[0].identifier)+'" onclick="pagehide();event.stopPropagation();" title="'+escapeHtml(val.pagemap.interactioncounter[4].userinteractioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'"><i class="fa-solid fa-retweet"></i> '+nFormatter(val.pagemap.interactioncounter[4].userinteractioncount)+'</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="like text-body text-opacity-50" href="https://twitter.com/intent/like?tweet_id='+encodeURIComponent(val.pagemap.socialmediaposting[0].identifier)+'" onclick="pagehide();event.stopPropagation();" title="'+escapeHtml(val.pagemap.interactioncounter[3].userinteractioncount.replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'"><i class="fa-regular fa-heart"></i> '+nFormatter(val.pagemap.interactioncounter[3].userinteractioncount)+'</a></div>' : '')+'</li>';
          }
        });
        $('#tweets .loading').remove();
        if(html!='')
        {
          $('#tweets > ol').append(html);
          $('#tweets .numresults').html(data.searchInformation.formattedTotalResults);
          delete siteloading[functionid];
          if($('#tweets > ol').height()>=$('#tweets > ol').height()-100)
          {
            scrolled[functionid] = true;
            checkscroll();
          }
        }
        else if($('#tweets > ol > li').length==0)
        {
          $('#tweets').next().remove();
          $('#tweets').remove();
          $('#item-tweets').remove();
          delete scrolled[functionid];
          setmenu();
        }
      });
    }
  }
}
function tiktok(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'tiktok';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (typeof sitedata[functionid].totalEstimatedMatches!=='undefined' && $('#tiktok > ol > li').length<1000 && $('#tiktok > ol > li').length<sitedata[functionid].totalEstimatedMatches)))
  {
    siteloading[functionid] = true;
    if($('#tiktok').length==0)
    {
      $('#scrollto').append('<li id="item-tiktok" class="list-inline-item"><label for="tiktok" title="TikTok" aria-label="TikTok" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.tiktok.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
      $('#main').append('<div id="tiktok" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.tiktok.com/discover/'+encodeURIComponent(q).replaceAll('%20', '-')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.tiktok.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">TikTok</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#tiktok > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].nextOffset!==\'undefined\')sitedata[\''+functionid+'\'].nextOffset=0;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#tiktok > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].nextOffset!==\'undefined\')sitedata[\''+functionid+'\'].nextOffset=0;sitedata[\''+functionid+'\'].sort=\'date\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by date')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#tiktok > ol').scroll(scroll);
    }
    $('#tiktok > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:570px;"></div><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="mb-1 small"><span class="placeholder rounded-1 col-5"></span></div></li>'.repeat(10));
    $.ajax({
      //&freshness=Year
      url:'https://api.bing.microsoft.com/v7.0/videos/search?q='+encodeURIComponent('site:www.tiktok.com '+((nospellingcorrection==1||1) ? '+' : '')+q)+'&count=105&offset='+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].nextOffset!=='undefined') ? sitedata[functionid].nextOffset : 0)+'&mkt='+encodeURIComponent(language)+'&textDecorations=true&textFormat=HTML'+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&freshness=Month' : ''),
      cache:true,
      beforeSend:function(xhr){
        xhr.setRequestHeader('Ocp-Apim-Subscription-Key', a4);
        if(IP!='')
          xhr.setRequestHeader('X-MSEdge-ClientIP', IP);
        if(isMobile.any())
          xhr.setRequestHeader('User-Agent', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36');    // Need to set user agent so Bing API returns desktop URLS, not mobile!!!
      }
    }).done(function(data, textStatus, request){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      if(typeof data.items==='undefined')
      {
        data.items = [];
        data.searchInformation = {formattedTotalResults:'0'};
        if(typeof data.value!=='undefined')
        {
          data.items = data.value;
          if(typeof data.totalEstimatedMatches!=='undefined')
            data.searchInformation.formattedTotalResults = data.totalEstimatedMatches.toLocaleString();
        }
      }
// Sort by viewcount
if(typeof data.items!=='undefined')
data.items = data.items.sort(function(a,b){return ((typeof b.viewCount!=='undefined') ? b.viewCount : 0)-((typeof a.viewCount!=='undefined') ? a.viewCount : 0)});
      $.each(data.items, function(key, val){
        // Bing
        if(typeof val.contentUrl!=='undefined')
        {
          val.link = val.contentUrl;
          val.displayLink = extractHostname(val.link);
          val.title = val.name.replace(/<\/?[^>]+(>|$)/g, '');
          val.htmlSnippet = val.description;
          if(typeof val.thumbnailUrl!=='undefined')
            val.pagemap = {cse_thumbnail:[{src:val.thumbnailUrl}]};
        }
        var id = 'tiktok-'+val.link.toLowerCase().replace(/\?.+$/i, '').replace(/^https?:\/\//, '').replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '').replace(/\/$/, '');
        var match = val.link.match(/^https:\/\/www\.tiktok\.com\/[^\/]+\/video\/([0-9]+)$/);
        if(match!=null && match.length==2 && document.getElementById(id)==null)
        {
          // Setup
          if(typeof val.title==='undefined')
            val.title = val.link;
          if(typeof val.htmlSnippet==='undefined')
            val.htmlSnippet = val.title;
          // Make result HTML
          html += '<li id="'+id+'" class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()">'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_thumbnail!=='undefined' && typeof val.pagemap.cse_thumbnail[0]!=='undefined' && typeof val.pagemap.cse_thumbnail[0].src!=='undefined') ? '<div class="frame mb-1 rounded-3 bg-light"><img src="'+val.pagemap.cse_thumbnail[0].src+'" width="100%" alt="'+escapeHtml(val.title)+'" title="'+escapeHtml(val.title)+'" /></div>' : '')+'<div class="url mb-1 small text-body" title="'+escapeHtml(val.link)+'"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((val.link.indexOf('https://')==0) ? 'https://' : 'http://')+val.displayLink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> TikTok'+((typeof val.creator!=='undefined' && typeof val.creator.name!=='undefined') ? '<span class="text-body text-opacity-50"> &bull; '+escapeHtml(val.creator.name)+'</span>' : '')+'</div><div class="d-flex w-100 align-items-center justify-content-between"><h6 class="mb-1 text-body" title="'+escapeHtml(val.title)+'">'+escapeHtml(val.title.replace(' - Manual - PHP', ''))+'</h6></div><div class="mb-1 text-body text-opacity-50 small">'+((typeof val.viewCount!=='undefined') ? '<span title="'+escapeHtml(val.viewCount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","))+'">'+nFormatter(val.viewCount)+' view'+((val.viewCount!=1) ? 's' : '')+'</span> &bull; ' : '')+'<span title="'+escapeHtml(new Date(Date.parse(val.datePublished)).toLocaleString())+'">'+timeago(val.datePublished)+'</span></div></li>';
        }
      });
      $('#tiktok .loading').remove();
      if(html!='')
      {
        $('#tiktok > ol').append(html);
        $('#tiktok .numresults').html(data.searchInformation.formattedTotalResults);
        delete siteloading[functionid];
        if($('#tiktok > ol').height()>=$('#tiktok > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#tiktok > ol > li').length==0)
//      if($('#tiktok > ol > li').length==0 || (data.currentOffset==0 && (data.totalEstimatedMatches<=50 || (typeof data.value[0].viewCount!=='undefined' && data.value[0].viewCount<=1500000))))
      {
        $('#tiktok').next().remove();
        $('#tiktok').remove();
        $('#item-tiktok').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function trending()
{
  var functionid = 'trending';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || typeof sitedata[functionid].default.endDateForNextRequest!=='undefined'))
  {
    siteloading[functionid] = true;
    if($('#trending').length==0)
      $('#main').append('<ul id="trending" class="list-unstyled" style="margin:430px auto 0;padding-left:92px;"></ul>');
    $.getJSON('/trending.php?language='+encodeURIComponent(language)+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].default.endDateForNextRequest!=='undefined') ? '&ed='+sitedata[functionid].default.endDateForNextRequest : ''), function(data){if(Cookies.get('debug')!==undefined)console.log(data);
      sitedata[functionid] = data;
      var html = '';
      for(var i=0, len=data.default.trendingSearchesDays.length; i<len; i++)
      {
        $.each(data.default.trendingSearchesDays[i].trendingSearches, function(key, val){
          html += '<li><a class="q text-decoration-none" href="/?q='+encodeURIComponent(val.title.query.toLowerCase()).replace(/['()]/g, escape).replace(/%20/g, '+')+'" title="'+escapeHtml(val.formattedTraffic)+'">'+escapeHtml(val.title.query)+'</a><span class="text-body text-opacity-50 small"> - '+unescapeHtml(val.articles[0].title.replace(' &lt;em&gt;', ' ')).replace(/(<([^>]+)>)/gi, '')+'</span></li>';
        });
      }
      $('#trending').append(html);
      delete siteloading[functionid];
      if($('#trending li').length<25)
        trending();
    });
  }
}
function amazon(q)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'amazon';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || ($('#amazon > ol > li').length<100 && $('#amazon > ol > li').length<sitedata[functionid].SearchResult.TotalResultCount)))
  {
    siteloading[functionid] = true;
    if($('#amazon').length==0)
    {
      $('#scrollto').append('<li id="item-amazon" class="list-inline-item"><label for="amazon" title="Amazon" aria-label="Amazon" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.amazon.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
      $('#main').append('<div id="amazon" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.amazon.com/s?k='+encodeURIComponent(q).replaceAll('%20', '+')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.amazon.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">Amazon</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#amazon > ol\').empty().scrollTop(0);delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#amazon > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].sort=\'Price:LowToHigh\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by lowest price')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#amazon > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].sort=\'Price:HighToLow\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by highest price')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#amazon > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].sort=\'AvgCustomerReviews\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by avg. customer review')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#amazon > ol\').empty().scrollTop(0);sitedata[\''+functionid+'\'].sort=\'NewestArrivals\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by newest arrivals')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#amazon > ol').scroll(scroll);
    }
    $('#amazon > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-4"></span></div></li>'.repeat(5));
    $.getJSON('/amazon.php?q='+encodeURIComponent(q)+'&count=10&page='+(Math.floor($('#amazon > ol > li:not(.loading)').length/10)+1)+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''), function(data){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      if(typeof data.SearchResult!=='undefined')
      {
        for(var i=0, len=data.SearchResult.Items.length; i<len; i++)
        {
          var value = data.SearchResult.Items[i];
          var id = 'amazon-'+value.ASIN;
          if(document.getElementById(id)==null && typeof value['Images']['Primary']['Large']['URL']!=='undefined')
          {
            var titlehtml = escapeHtml(value['ItemInfo']['Title']['DisplayValue']);
            var pricehtml = (typeof value['Offers']!=='undefined' && typeof value['Offers']['Listings']!=='undefined' && typeof value['Offers']['Listings'][0]['Price']!=='undefined' && typeof value['Offers']['Listings'][0]['Price']['DisplayAmount']!=='undefined') ? value['Offers']['Listings'][0]['Price']['DisplayAmount'].replace(/\s*\(.*\)/, '') : '';
//            var details = '';//' <img src="/img/logo/amazon.svg" width="43" height="12" style="position:relative;top:2px;">';//' <small class="text-body text-opacity-50">Amazon</small>';
            var details = ' <small><img src="/img/logo/amazon.svg" width="49" style="position:relative;top:3px;">'+((typeof value['Offers']!=='undefined' && typeof value['Offers']['Listings']!=='undefined' && typeof value['Offers']['Listings'][0]['DeliveryInfo']['IsPrimeEligible']!=='undefined' && value['Offers']['Listings'][0]['DeliveryInfo']['IsPrimeEligible']) ? ' <span class="prime">prime</span>' : '')+'</small>';
            html += '<li id="'+id+'" class="amazon list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+value['DetailPageURL']+'" onclick="pagehide()" title="'+titlehtml+' • '+pricehtml+'"><div class="frame mb-1 py-1 rounded-3 text-center s-image-overlay-grey border"><img src="'+((typeof value['Images']['Primary']['Large']['URL']!=='undefined') ? value['Images']['Primary']['Large']['URL'] : 'https://picclick.com/img/imgNoImg.gif')+'" alt="'+titlehtml+'" height="170" /></div>'+
                '<div class="d-flex w-100 align-items-center justify-content-between text-body small mb-1">'+titlehtml+'</div></a>'+
                '<div class="snippet mb-1 text-body small"><h6 class="fw-bold">'+pricehtml+''+details+'</h6></div>'+
                '</li>';
          }
        }
      }
      $('#amazon .loading').remove();
      if(html!='')
      {
        $('#amazon > ol').append(html);
        $('#amazon .numresults').html(data.SearchResult.TotalResultCount.toLocaleString());
        delete siteloading[functionid];
        if($('#amazon > ol').height()>=$('#amazon > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#amazon > ol > li').length==0)
      {
        $('#amazon').next().remove();
        $('#amazon').remove();
        $('#item-amazon').remove();
        delete scrolled[functionid];
        setmenu();
      }
    }).fail(function(){
if(Cookies.get('debug')!==undefined)console.log('amazon fail...');
      $('#amazon .loading').remove();
      if($('#amazon > ol > li').length==0)
      {
        $('#amazon').next().remove();
        $('#amazon').remove();
        $('#item-amazon').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function ebay(q, val)
{
// Because no further q should have site: in it
q = q.replace(/site:[^\s]+\s/i, '').trim();

  var functionid = 'ebay';
  if(typeof siteloading[functionid]==='undefined' && (typeof sitedata[functionid]==='undefined' || (sitedata[functionid].offset+10<=10000 && sitedata[functionid].offset+10<sitedata[functionid].total)))
  {
    siteloading[functionid] = true;
    if($('#ebay').length==0)
    {
      $('#scrollto').append('<li id="item-ebay" class="list-inline-item"><label for="ebay" title="eBay" aria-label="eBay" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.ebay.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
      $('#main').append('<div id="ebay" class="d-flex flex-column align-items-stretch flex-shrink-0" site="'+escapeHtml(val.displayLink)+'"><a href="https://www.ebay.com/sch/i.html?_nkw='+encodeURIComponent(q).replaceAll('%20', '+')+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.ebay.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">eBay</span></a><div class="dropdown position-absolute top-0 end-0"><button type="button" class="btn btn-clear btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><div class="px-3 py-1 text-body text-opacity-50 text-nowrap">'+__('About <span class="numresults"></span> results')+'</div></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#ebay > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].offset!==\'undefined\')sitedata[\''+functionid+'\'].offset=-10;delete sitedata[\''+functionid+'\'].sort;window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check"></i> '+__('Sort by relevance')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#ebay > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].offset!==\'undefined\')sitedata[\''+functionid+'\'].offset=-10;sitedata[\''+functionid+'\'].sort=\'price\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by lowest price')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#ebay > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].offset!==\'undefined\')sitedata[\''+functionid+'\'].offset=-10;sitedata[\''+functionid+'\'].sort=\'-price\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by highest price')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#ebay > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].offset!==\'undefined\')sitedata[\''+functionid+'\'].offset=-10;sitedata[\''+functionid+'\'].sort=\'endingSoonest\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by ending soonest')+'</a></li><li><a class="dropdown-item" href="" onclick="$(this).parent().parent().find(\'.fa-check\').addClass(\'invisible\');$(this).children(\'.fa-check\').removeClass(\'invisible\');$(\'#ebay > ol\').empty().scrollTop(0);if(typeof sitedata[\''+functionid+'\'].offset!==\'undefined\')sitedata[\''+functionid+'\'].offset=-10;sitedata[\''+functionid+'\'].sort=\'newlyListed\';window[\''+functionid+'\'](q);return false;"><i class="fa-solid fa-check invisible"></i> '+__('Sort by newly listed')+'</a></li></ul></div><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled[functionid] = false;
      $('#ebay > ol').scroll(scroll);
    }
    $('#ebay > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="url mb-1 small placeholder rounded-1 col-5"></div><div class="w-100 align-items-center justify-content-between"><h6 class="mb-1"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></h6></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></div><div class="snippet mb-1 small"><span class="placeholder rounded-1 col-4"></span></div></li>'.repeat(5));
    $.getJSON('/ebay.php?q='+encodeURIComponent(q)+'&offset='+((typeof sitedata[functionid]==='undefined') ? 0 : encodeURIComponent(sitedata[functionid].offset+10))+'&site='+$('#ebay').attr('site')+((typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? '&sort='+encodeURIComponent(sitedata[functionid].sort) : ''), function(data){if(Cookies.get('debug')!==undefined){console.log(functionid);console.log(data);}
      var sort = (typeof sitedata[functionid]!=='undefined' && typeof sitedata[functionid].sort!=='undefined') ? sitedata[functionid].sort : '';
      sitedata[functionid] = data;
      if(sort!='')
        sitedata[functionid].sort = sort;
      var html = '';
      if(typeof data.itemSummaries!=='undefined' && typeof data.itemSummaries==='object')
      {
        for(var i=0, len=data.itemSummaries.length; i<len; i++)
        {
          var value = data.itemSummaries[i];
          var id = 'ebay-'+value['legacyItemId'];
          if(document.getElementById(id)==null)
          {
            var lower = value['title'].toLowerCase();
            if(lower.indexOf('nsfw')!=-1 ||
               lower.indexOf(' xxx ')!=-1 ||
               lower.indexOf('erotic ')!=-1 ||
               lower.indexOf(' boobs ')!=-1 ||
               lower.indexOf('nude ')!=-1 ||
               lower.indexOf('nudes')!=-1 ||
               lower.indexOf('nipples')!=-1 ||
               lower.indexOf('pin-up')!=-1 ||
               lower.indexOf('hot babe')!=-1 ||
               lower.indexOf(' dong ')!=-1 ||
               lower.indexOf(' pussy ')!=-1 ||
               lower.indexOf('penis')!=-1 ||
               lower.indexOf('dildo')!=-1 ||
               lower.indexOf('acai ')!=-1 ||
               lower.indexOf('pinup')!=-1 ||
               lower.indexOf('testosterone ')!=-1)
              continue;
            if(typeof value['title']==='undefined') value['title'] = '';    // Possible error if no title, has happened
            value['title'] = $.trim(value['title']);
            if(value['title'].toUpperCase()==value['title'])
              value['title'] = value['title'].toLowerCase().replace(/^[\u00C0-\u1FFF\u2C00-\uD7FF\w]|\s[\u00C0-\u1FFF\u2C00-\uD7FF\w]/g, function(letter){ return letter.toUpperCase(); });
            var titlehtml = escapeHtml(value['title']);
            // Fix error when only BEST_OFFER
            if(typeof value['price']==='undefined')
              value['price'] = {'value':0, 'currency':''};
            var price = (typeof value['currentBidPrice']!=='undefined') ? value['currentBidPrice'] : value['price'];
            var pricehtml = ((price['currency']!='USD' && price['currency']!='GBP' && price['currency']!='AUD' && price['currency']!='CAD') ? price['currency']+' ' : '')+((price['currency']=='USD' || price['currency']=='CAD' || price['currency']=='AUD') ? '$' : '')+((price['currency']=='GBP') ? '£' : '')+parseFloat(price['value']).toFixed(2).toString().replace('.', ((price['currency']=='EUR') ? ',' : '.')).replace(/\B(?=(\d{3})+(?!\d))/g, ((price['currency']=='EUR') ? '.' : ','));
            var discounthtml = '';
            if(typeof value['marketingPrice']!=='undefined' && typeof value['marketingPrice']['originalPrice']!=='undefined')
            {
              var discount = value['marketingPrice']['originalPrice'];
              discounthtml = ((discount['currency']!='USD' && discount['currency']!='GBP' && discount['currency']!='AUD' && discount['currency']!='CAD') ? discount['currency']+' ' : '')+((discount['currency']=='USD' || discount['currency']=='CAD' || discount['currency']=='AUD') ? '$' : '')+((discount['currency']=='GBP') ? '£' : '')+parseFloat(discount['value']).toFixed(2).toString().replace('.', ((discount['currency']=='EUR') ? ',' : '.')).replace(/\B(?=(\d{3})+(?!\d))/g, ((discount['currency']=='EUR') ? '.' : ','));
              discounthtml = '<small><strike class="text-danger">'+discounthtml+'</strike></small> ';
            }
            var details = '';
            if(typeof value['bidCount']!=='undefined')
              details = ' <small> '+value['bidCount']+' '+((value['bidCount']!=1) ? __('Bids') : __('Bid'))+(($.inArray('FIXED_PRICE', value['buyingOptions'])!=-1) ? ' '+__('or')+' '+__('Buy It Now') : '')+'</small>';
            else if($.inArray('FIXED_PRICE', value['buyingOptions'])!=-1)
              details = ' <small>'+__('Buy It Now')+'</small>';
            if($.inArray('CLASSIFIED_AD', value['buyingOptions'])!=-1)
              details = ' <small>'+__('Classified Ad')+'</small>';
            if($.inArray('BEST_OFFER', value['buyingOptions'])!=-1)
              details += ' <small>'+__('or Best Offer')+'</small>';               
            html += '<li id="'+id+'" class="ebay list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+value['itemAffiliateWebUrl']+'" onclick="pagehide()" title="'+titlehtml+' • '+pricehtml+'"><div class="frame mb-1 py-1 rounded-3 text-center s-image-overlay-grey border"><img src="'+((typeof value['image']!=='undefined' && typeof value['image']['imageUrl']!=='undefined') ? value['image']['imageUrl'].replace('/s-l225.jpg', '/s-l500.jpg') : 'https://picclick.com/img/imgNoImg.gif')+'" alt="'+titlehtml+'" height="170" /></div>'+
                '<div class="d-flex w-100 align-items-center justify-content-between text-body small mb-1">'+titlehtml+'</div></a>'+
                '<div class="snippet mb-1 text-body small"><h6 class="fw-bold">'+((discounthtml!='') ? discounthtml : '')+pricehtml+' <img src="/img/logo/ebay.svg" width="40" style="position:relative;top:-.5px;"> '+details+'</h6></div>'+
                '</li>';
          }
        }
      }
      $('#ebay .loading').remove();
      if(html!='')
      {
        $('#ebay > ol').append(html);
        $('#ebay .numresults').html(data.total.toLocaleString());
        delete siteloading[functionid];
        if($('#ebay > ol').height()>=$('#ebay > ol').height()-100)
        {
          scrolled[functionid] = true;
          checkscroll();
        }
      }
      else if($('#ebay > ol > li').length==0)
      {
        $('#ebay').next().remove();
        $('#ebay').remove();
        $('#item-ebay').remove();
        delete scrolled[functionid];
        setmenu();
      }
    }).fail(function(){
      $('#ebay .loading').remove();
      if($('#ebay > ol > li').length==0)
      {
        $('#ebay').next().remove();
        $('#ebay').remove();
        $('#item-ebay').remove();
        delete scrolled[functionid];
        setmenu();
      }
    });
  }
}
function wikipedia(val)
{
// Wikipedia doesn't have hard API limits, can be used later for getting more data
  // https://www.mediawiki.org/wiki/API:Main_page
  // https://en.wikipedia.org/w/api.php?action=help&modules=main
  // https://www.mediawiki.org/wiki/API:Properties
  // https://www.mediawiki.org/wiki/Extension:TextExtracts#API
  if($('#wikipedia').length==0)
  {
//    $('#scrollto').append('<li id="item-wikipedia" class="list-inline-item"><label for="wikipedia" title="Wikipedia" aria-label="Wikipedia" class="btn btn-tab" onclick="scrollto(this);"><i class="fa-brands fa-wikipedia-w" aria-hidden="true"></i></label></li>');
//    $('#main').append('<div id="wikipedia" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="'+val.link+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><i class="fa-brands fa-wikipedia-w" aria-hidden="true"></i> <span class="text">Wikipedia</span></a><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
// Try grounding Wikipedia 2nd more
$('#item-web').after('<li id="item-wikipedia" class="list-inline-item"><label for="wikipedia" title="Wikipedia" aria-label="Wikipedia" class="btn btn-tab" onclick="scrollto(this);"><i class="fa-brands fa-wikipedia-w" aria-hidden="true"></i></label></li>');
$('#web').next().after('<div id="wikipedia" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="'+val.link+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><i class="fa-brands fa-wikipedia-w" aria-hidden="true"></i> <span class="text">Wikipedia</span></a><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
    scrolled['wikipedia'] = false;
    $('#wikipedia > ol').scroll(scroll);
    $('#wikipedia > ol').append('<li class="loading list-group-item border-0 pt-0 pb-3 lh-sm placeholder-glow opacity-25"><div class="frame mb-1 rounded-3 placeholder" style="width:100%;height:180px;"></div><div class="w-100 align-items-center justify-content-between"><h5 class="mb-2"><span class="placeholder rounded-1 col-12"></span></h5></div><div class="mb-1 small">'+'<p><span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span> <span class="placeholder rounded-1 col-12"></span></p>'.repeat(10)+'</div></li>');
// https://stackoverflow.com/questions/3312346/how-to-get-the-infobox-data-from-wikipedia
// wbgetentities???
// Wikidata seems like what I need...
// https://swurl.com/?q=van+nuys
    $.getJSON('https://'+val.displayLink+'/w/api.php?action=query&prop=extracts%7Cpageimages&pithumbsize=640&exsentences-off=10&exlimit=1&titles='+val.link.match(/^https:\/\/[a-z]+\.wikipedia\.org\/wiki\/([^#]+)/i)[1]+'&exintro-off=1&exsectionformat=plain&formatversion=2&origin=*&format=json', function(data){if(Cookies.get('debug')!==undefined){console.log('wikipedia');console.log(data);}
      $('#wikipedia .loading').remove();
//      $('#wikipedia ol').html('<div class="row no-gutters">'+((typeof val.pagemap!=='undefined' && typeof val.pagemap.cse_image!=='undefined') ? '<div class="'+((typeof val.pagemap.cse_thumbnail!=='undefined' && val.pagemap.cse_thumbnail[0].width/val.pagemap.cse_thumbnail[0].height<=1.2) ? 'col-auto ' : '')+'col-md-auto"><a href="'+val.link+'" onclick="pagehide()"><img loading="eager" src="'+((typeof val.pagemap.cse_thumbnail!=='undefined' && val.pagemap.cse_thumbnail[0].height>=172) ? val.pagemap.cse_thumbnail[0].src : val.pagemap.cse_image[0].src)+'" '+((typeof val.pagemap.cse_thumbnail!=='undefined') ? 'onerror="if(this.src!=\''+val.pagemap.cse_thumbnail[0].src+'\')this.src=\''+val.pagemap.cse_thumbnail[0].src+'\'" ' : '')+'alt="'+escapeHtml(data.query.pages[0].title)+'" title="'+escapeHtml(data.query.pages[0].title)+'" /></a></div>' : '')+'<div class="col"><div class="card-body"><h5 class="card-title">'+escapeHtml(data.query.pages[0].title)+'</h5><p class="card-text">'+escapeHtml(data.query.pages[0].extract.replace('(; ', '(').replace(' () ', ' ').slice(0, (($(window).width()<768) ? 500 : 10000) /* Fixes problem with https://swurl.com/?q=Kellyanne+Conway on mobile, the .replace fixes problem with pronunciation link missing */))+'</p><a href="'+val.link+'" onclick="pagehide()">Wikipedia</a></div></div>').css('min-height', '0');
      // Bing
      if(typeof data.query.pages[0].thumbnail!=='undefined')
        val.pagemap = {cse_image:[{src:data.query.pages[0].thumbnail.source}], cse_thumbnail:[{src:data.query.pages[0].thumbnail.source, width:data.query.pages[0].thumbnail.width, height:data.query.pages[0].thumbnail.height}]};
      if(typeof data.query.pages[0].extract!=='undefined')
        $('#wikipedia ol').append('<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><a href="'+val.link+'" onclick="pagehide()">'+((typeof val.pagemap!=='undefined' && (typeof val.pagemap.cse_image!=='undefined' || (typeof val.pagemap.metatags!=='undefined' && typeof val.pagemap.metatags[0]!=='undefined' && typeof val.pagemap.metatags[0]['og:image']!=='undefined'))) ? '<div class="frame mb-2 rounded-3"><img src="'+escapeHtml((typeof val.pagemap.cse_image!=='undefined') ? val.pagemap.cse_image[0].src : val.pagemap.metatags[0]['og:image'])+'" width="320" alt="'+escapeHtml(data.query.pages[0].title)+'" title="'+escapeHtml(data.query.pages[0].title)+'" /></div>' : '')+'<div class="d-flex w-100 align-items-center justify-content-between"><h5 class="mb-2 text-body">'+escapeHtml(data.query.pages[0].title)+'</h5></div></a><div class="mb-1 text-body text-opacity-75 small">'+data.query.pages[0].extract.replace(/\s*<p>\s*<span>\s*<\/span>\s*<\/p>\s*/, '').replace('(; ', '(').replace(' (<span></span>)', '').replace(' () ', ' ').replace(/\<p class="mw-empty-elt">\n*<\/p>\n*/g, '').replace(/<h2[^\>]*>/ig, '<h6 class="text-body">').replaceAll('</h2>', '</h6>').replaceAll('<h3>', '<div class="mb-2 text-body" style="font-weight:500;">').replaceAll('</h3>', '</div>').replaceAll('<h4>', '<div class="mb-2 text-body fst-italic">').replaceAll('</h4>', '</div>').replaceAll('<p><br>', '<p>')+'<p class="mt-3"><a class="btn btn-outline-secondary btn-sm rounded-pill" href="'+val.link+'" role="button" onclick="pagehide()">Wikipedia</a></p></div></li>');
      else
        $('#wikipedia').remove();
    }).fail(function(){
      $('#wikipedia').remove();
    });
  }
}
function twitter(val)
{
  if(Cookies.get('disabletwitter')===undefined)
  {
    if($('#twitter').length==0)
    {
      $('#scrollto').append('<li id="item-twitter" class="list-inline-item"><label for="twitter" title="Twitter" aria-label="Twitter" class="btn btn-tab" onclick="scrollto(this);"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://twitter.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"></label></li>');
      $('#main').append('<div id="twitter" class="d-flex flex-column align-items-stretch flex-shrink-0" href="'+val.link.replace('https://mobile.', 'https://www.')+'"><a href="https://twitter.com/search?q='+encodeURIComponent(q)+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://twitter.com&client=chrome&size=64&type=FAVICON&fallback_opts=TYPE,SIZE,URL"> <span class="text">Twitter</span></a><ol class="list-group list-group-flush scrollarea"></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
      scrolled['twitter'] = false;
      $('#twitter > ol').scroll(scroll);
    }
    // data-height="368" 
    $('#twitter > ol').html('<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><a class="twitter-timeline" data-dnt="true" data-theme="'+(((window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) || Cookies.get('enabledark')!==undefined) ? 'dark' : 'light')+'" href="'+$('#twitter').attr('href')+'"></a></li>');
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.async = true;
    script.src = 'https://platform.twitter.com/widgets.js';
    $('.twitter-timeline').after(script);
  }
}
// https://developer.wordnik.com/ alternative for later??? the below API is getting not as good?  Using Wiktionary now....
function dictionary(word)
{
  $('#web > ol').prepend('<li id="dictionary" class="list-group-item border-0 pt-0 pb-3 lh-sm"><div class="card rounded-3"><div class="card-body small"><h5 class="card-title">'+escapeHtml(decodeURIComponent(word))+'</h5></div></div></li>');
  $.getJSON('https://api.dictionaryapi.dev/api/v2/entries/'+encodeURIComponent(LANG)+'/'+word, function(data){console.log('dictionary');if(Cookies.get('debug')!==undefined){console.log('dictionary');console.log(data);}
    if(data[0].meanings.length)
    {
      var html = '';
      for(var i=0, len=data[0].meanings.length; i<len; i++)
      {
        if(i==0)
        {
          html += '<h5 class="card-title">'+escapeHtml(data[0].word);
          if(typeof data[0].phonetics!=='undefined')
          {
            for(var j=0, len2=data[0].phonetics.length; j<len2; j++)
            {
              if(typeof data[0].phonetics[j].text!=='undefined')
                html += ' '+((typeof data[0].phonetics[j].audio!=='undefined' && data[0].phonetics[j].audio!=='') ? '<button type="button" class="btn btn-link btn-sm" onclick="new Audio(\''+data[0].phonetics[j].audio+'\').play();"><i class="fa-solid fa-volume-high" aria-hidden="true"></i></button>' : '')+'<small>'+escapeHtml(data[0].phonetics[j].text)+((j<len2-1) ? ', ' : '')+'</small>';
            }
          }
          html += '</h5>';
        }
        html += '<i>'+escapeHtml(data[0].meanings[i].partOfSpeech)+'</i><ol>';
        for(var j=0, len2=data[0].meanings[i].definitions.length; j<len2; j++)
        {
          html += '<li'+((len2==1) ? ' style="list-style:none;"' : '')+'>'+escapeHtml(data[0].meanings[i].definitions[j].definition)+((typeof data[0].meanings[i].definitions[j].example!=='undefined') ? '<br><span class="text-body text-opacity-50">"'+escapeHtml(data[0].meanings[i].definitions[j].example)+'"</span>' : '')+'</li>';
          if(typeof data[0].meanings[i].definitions[j].synonyms!=='undefined' && data[0].meanings[i].definitions[j].synonyms.length)
          {
            html += '<ol class="list-inline"><li class="list-inline-item">Synonyms:</li>';
            for(var k=0, len3=data[0].meanings[i].definitions[j].synonyms.length; k<len3; k++)
              html += '<li class="list-inline-item">'+escapeHtml(data[0].meanings[i].definitions[j].synonyms[k])+'</li>';
            html += '</ol>';
          }
        }
        html += '</ol>';
      }
      $('#dictionary .card').html('<div class="card-body small">'+html+'</div>');
    }
    else
      $('#dictionary').remove();
    // if($('#web > ol > li').length!=0 && $(window).height()>=$(document).height())
    // {
    //  scrolled = true;
    //  checkscroll();
    // }
  }).fail(function(){
    $('#dictionary').remove();
    // if($('#web > ol > li').length!=0 && $(window).height()>=$(document).height())
    // {
    //  scrolled = true;
    //  checkscroll();
    // }
  });
}
function map(location)
{
//  $('#main').append('<div id="map" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="https://www.google.com/maps/search/'+encodeURIComponent(location).replace(/['()]/g, escape).replace(/%20/g, '+')+'/" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><i class="fa fa-map-marker" aria-hidden="true"></i> Map</a><ol class="list-group list-group-flush scrollarea h-100"><iframe class="h-100" src="https://www.google.com/maps?q='+encodeURIComponent(location).replace(/['()]/g, escape).replace(/%20/g, '+')+'&output=embed"></iframe></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
  $('#web > ol').prepend('<li id="map" class="list-group-item border-0 mx-3 mb-3 p-0 rounded-3 overflow-hidden bg-light"><iframe src="https://www.google.com/maps?q='+encodeURIComponent(location).replace(/['()]/g, escape).replace(/%20/g, '+')+'&output=embed"></iframe></li>');
}
function iframe(displaylink, link)
{
  $('#main').append('<div class="iframe d-flex flex-column align-items-stretch flex-shrink-0"><a href="'+link+'" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url='+((link.indexOf('https://')==0) ? 'https://' : 'http://')+displaylink+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" /> <span class="text">'+displaylink.replace(/^www[0-9]?\./, '').replace(/^web\./, '').replace(/^m\./, '').replace(/^mobile\./, '').replace(/^[a-z]{2}\.wik/, 'wik').replace(/^[a-z]{2}\.m\./, '')+'</span></a><ol class="list-group list-group-flush scrollarea h-100"><iframe class="h-100" src="'+link+'"></iframe></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
}
function stock(stocksymbol)
{/*
  $('#web > ol').append('<li id="stock" class="list-group-item border-0 p-0 pb-3"></li>');
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.onload = function(){
    $('#stock').html('<div class="tradingview-widget-container"><div id="tradingview_86fba"></div></div>');
    new TradingView.widget({
      "width":"100%",
      "height":"100%",
      "symbol":encodeURIComponent(stocksymbol),
      "interval":"D",
      "timezone":"exchange",
      "theme":"light",
      "style":"3",
      "locale":LANG,
      "toolbar_bg":"#f1f3f6",
      "enable_publishing":false,
//      "hide_top_toolbar":true,
      "withdateranges":true,
      "range":"1D",
      "allow_symbol_change":true,
      "save_image": false,
      "container_id":"tradingview_86fba"
    });
  };
  script.src = 'https://s3.tradingview.com/tv.js';
  document.getElementsByTagName('head')[0].appendChild(script);*/

/*  $('#web > ol').append('<li id="stock" class="list-group-item border-0 pt-0 pb-3"><div class="tradingview-widget-container"><div class="tradingview-widget-container__widget"></div></div></li>');
  var script = document.createElement('script');
    script.type = 'text/javascript';
    script.async = true;
    script.text = '{"colorTheme":"light","dateRange":"1D","showChart":true,"locale":"'+LANG+'","showSymbolLogo":true,"showFloatingTooltip":true,"width":"100%","height":"100%","tabs":[{"symbols":[{"s":"'+encodeURIComponent(stocksymbol)+'"}]}]}';
    script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js';
  $('#stock').append(script);*/
  
/*  $('#web > ol').append('<li id="stock" class="list-group-item border-0 pt-0 pb-3"><div class="tradingview-widget-container"><div id="tradingview_a66eb"></div></div></li>');
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.onload = function(){
    new TradingView.MediumWidget({
      "symbols":[encodeURIComponent(stocksymbol)],
      "chartOnly": false,
      "width":"100%",
      "height":"100%",
      "locale":LANG,
      "colorTheme":"light",
      "autosize":false,
      "showVolume":false,
      "hideDateRanges":false,
      "scalePosition":"left",
      "scaleMode":"Normal",
      "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",
      "noTimeScale":false,
      "valuesTracking":"1",
      "chartType":"line",
      "fontColor":"#787b86",
      "gridLineColor":"rgba(42, 46, 57, 0.06)",
      "backgroundColor":"#ffffff",
      "lineWidth":3,
      "container_id":"tradingview_a66eb"
    });
  };
  script.src = 'https://s3.tradingview.com/tv.js';
  document.getElementsByTagName('head')[0].appendChild(script);*/
  
  $('#web > ol').prepend('<li id="stock" class="list-group-item border-0 pt-0 pb-3 lh-sm"><div class="tradingview-widget-container border border-dark rounded-3 overflow-hidden bg-dark"><div id="tradingview_a66eb"></div></div><div class="mt-1 text-body text-opacity-50 small"><a href="https://www.tradingview.com/symbols/'+encodeURIComponent(stocksymbol.toUpperCase())+'/" onclick="pagehide()" rel="nofollow" style="font-weight:500;">'+encodeURIComponent(stocksymbol.toUpperCase())+'</a> by TradingView</div></li>');
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.onload = function(){
    new TradingView.MediumWidget({
      "symbols":[encodeURIComponent(stocksymbol)],
      "chartOnly": false,
      "width":"320",
      "height":"320",
      "locale":LANG,
      "colorTheme":"dark",
      "autosize":false,
      "showVolume":true,
      "hideDateRanges":false,
      "scalePosition":"right",
      "scaleMode":"Normal",
      "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",
      "noTimeScale":false,
      "valuesTracking": "1",
      "chartType": "line",
      "backgroundColor": "#111",
      "container_id":"tradingview_a66eb"
    });
  };
  script.src = 'https://s3.tradingview.com/tv.js';
  document.getElementsByTagName('head')[0].appendChild(script);
}
// Alternative option later??? https://www.tomorrow.io/weather/widget/
function weather(location)
{if(Cookies.get('debug')!==undefined)console.log(location); 
//  $('#main').append('<div id="weather" class="d-flex flex-column align-items-stretch flex-shrink-0"><a href="" onclick="pagehide()" class="align-items-center flex-shrink-0 p-3 pt-0 text-decoration-none text-body"><i class="fa fa-cloud" aria-hidden="true"></i> Weather</a><ol class="list-group list-group-flush scrollarea h-100"><li class="list-group-item border-0 pt-3 pb-3 lh-sm"></li></ol>'+backtotophtml+'</div><div class="b-example-divider b-example-vr"></div>');
  $('#web > ol').prepend('<li id="weather" class="list-group-item border-0 mx-3 mb-3 p-0 rounded-3 overflow-hidden bg-light"></li>');
  location = location.split(' ').splice(0, 5).join(' ');    // Sometimes international city searches fail if too long, !!! could improve later
  $.getJSON('/weather.php?q='+encodeURIComponent(location), function(data){if(Cookies.get('debug')!==undefined)console.log(data);
//    $('#weather > ol > li').html('<a class="weatherwidget-io rounded-3" style="-webkit-mask-image:-webkit-radial-gradient(white, black);" href="https://forecast7.com/en/'+data.id+'/'+((COUNTRY=='us') ? '?unit=us"' : '')+'" onclick="pagehide()" data-label_1="'+escapeHtml(data.term)+'" data-label_2="WEATHER" data-font="Helvetica" data-icons="Climacons Animated" data-theme="weather_one"></a>');
    $('#weather').html('<a class="weatherwidget-io" href="https://forecast7.com/en/'+data.id+'/'+((COUNTRY=='us') ? '?unit=us"' : '')+'" onclick="pagehide()" data-label_1="'+escapeHtml(data.term)+'" data-label_2="WEATHER" data-font="Helvetica" data-icons="Climacons Animated" data-theme="weather_one"></a>');
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = 'https://weatherwidget.io/js/widget.min.js';
    document.getElementsByTagName('head')[0].appendChild(script);
  }).fail(function(){
    $('#weather').remove();
  });
}
function checkscroll()
{
  for(const key in scrolled)
  {
    if(scrolled[key])
    {
      scrolled[key] = false;
      var el = $('#'+key+' > ol');
      if(el.scrollTop()+el.height()>=el[0].scrollHeight-400 && key!='twitter' && key!='setdefault')    // Don't load more Twitter, not possible
      {
        if(typeof window[key]==='function')
          window[key](q);
        else
          site(q, key, '', '', '', '');
      }
      (el.scrollTop()>=100) ? el.next().fadeIn('fast') : el.next().fadeOut('fast');
      (el.scrollTop()>0) ? el.parent().children(':first').addClass('shadowbelow') : el.parent().children(':first').removeClass('shadowbelow');
    }
  }
}
// https://stackoverflow.com/questions/3007480/determine-if-user-navigated-from-mobile-safari
var ua = window.navigator.userAgent;
var iOS = !!ua.match(/iPad/i) || !!ua.match(/iPhone/i);
var webkit = !!ua.match(/WebKit/i);
var iOSSafari = iOS && webkit && !ua.match(/CriOS/i);
var suggestions = new Bloodhound({
  datumTokenizer:Bloodhound.tokenizers.obj.whitespace('value'),
  queryTokenizer:Bloodhound.tokenizers.whitespace,
  limit:20,
  remote:{
    url:((!iOSSafari) ? 'https://suggestqueries.google.com/complete/search?client=firefox&hl='+encodeURIComponent(LANG)+'&gl='+encodeURIComponent(COUNTRY)+'&q=%QUERY' : '/suggestions.php?q=%QUERY'),
    ajax:{
      dataType:((!iOSSafari) ? 'jsonp' : 'json'),
      cache:true,
      jsonp:'callback',
      jsonpCallback:'suggest',
      // Fix 400 error when using client firefox and empty q, client chrome works fine with empty q
      beforeSend:function(jqXHR, settings){
        if(settings.url.indexOf('&q=&callback=')!=-1)
          settings.url = settings.url.replace('?client=firefox&', '?client=chrome&');
      }
    },
    filter:function(data){if(Cookies.get('debug')!==undefined)console.log(data);
      var suggestions = [];
      if(Cookies.get('disablerecentsearches')===undefined)
      {
        var recentsearches = (typeof localStorage!=='undefined' && localStorage.getItem('recentsearches')!==null) ? JSON.parse(localStorage.getItem('recentsearches')) : [];
        suggestions = $.merge(suggestions, $.map(recentsearches, function(value){return (data[0]=='' || (data[0]!='' && (value.toLowerCase().indexOf(data[0].toLowerCase())==0/* || value.toLowerCase().indexOf(' '+data[0].toLowerCase())!=-1*/))) ? {value:value, type:'recent'} : null;}));
        suggestions = suggestions.slice(0, (data[0]=='') ? 20 : 3);
      }
      if(typeof data[1]!=='undefined')
      {
        if(data[1].length && typeof data[1][0]==='object')
        {
          var singlearray = [];
          for(var i=0, len=data[1].length; i<len; i++)
            singlearray.push(data[1][i][0]);
          data[1] = singlearray;
        }
        if(Cookies.get('disablerecentsearches')===undefined)
        {
          var singlearray = [];
          for(var i=0, len=data[1].length; i<len; i++)
            if(!recentsearches.includes(data[1][i]))
              singlearray.push(data[1][i]);
          data[1] = singlearray;
        }
        suggestions = $.merge(suggestions, $.map(data[1], function(value){return {value:value, type:'suggestion'};}));
      }
      return suggestions;
    }
  }
});
suggestions.initialize();
var domains = new Bloodhound({
  datumTokenizer:Bloodhound.tokenizers.obj.whitespace('value'),
  queryTokenizer:Bloodhound.tokenizers.whitespace,
  limit:1,
  remote:{
    url:'https://suggestions.semrush.com/?q=%QUERY&type=domain',
    ajax:{
      cache:true,
      dataType:'json',
      // Fix 412 error with empty q
      beforeSend:function(jqXHR, settings){
        if(document.getElementById('q').value=='' || document.getElementById('q').value.indexOf(' ')!=-1)
          jqXHR.abort();
      }
    },
    filter:function(data){if(Cookies.get('debug')!==undefined)console.log(data);
      var domains = [];
      if(typeof data.results=='object' && data.results.length)
      {
        var end = [];
        for(var i=data.results.length-1; i>=0; i--)
        {
          if(data.results[i].country.toLowerCase()==((COUNTRY=='uk') ? 'gb' : COUNTRY))
            domains.unshift(data.results[i]);
          else
            end.unshift(data.results[i]);
        }
        domains = domains.concat(end);
      }
      return domains;
    }
  }
});
domains.initialize();
$(document).ready(function(){
  document.getElementById('main').style.height = window.innerHeight+'px';    // Fix for 100vh bug in Android https://chanind.github.io/javascript/2019/09/28/avoid-100vh-on-mobile-web.html
  if(q)
  {
    if(q.charAt(0)=='!' && q.length>1 && q.indexOf(' ')>=0)
    {
      $.getJSON('https://duckduckgo.com/?q='+encodeURIComponent(q)+'&format=json&callback=?&no_redirect=1&skip_disambig=1', function(data){if(Cookies.get('debug')!==undefined)console.log(data);
        if(data.Redirect!='')    // https://duckduckgo.com/api !bang redirect
        {
          pagehide();
          window.location.replace(data.Redirect);
        }
      });
    }
    else
      web(q);
    // https://stackoverflow.com/questions/391979/how-to-get-clients-ip-address-using-javascript
/*    $.get('https://cdnjs.cloudflare.com/cdn-cgi/trace', function(data){if(Cookies.get('debug')!==undefined)console.log(data);
      var match = data.match(/^ip=(.+)$/m);
      if(match!=null && match.length==2)
        IP = match[1];
      if(!COUNTRY)
      {
        var match = data.match(/^loc=(.+)$/m);
        if(match!=null && match.length==2)
        {
          COUNTRY = match[1].toLowerCase();
          if(COUNTRY=='gb')
            COUNTRY = 'uk';
        }
      }
    });*/
  }
//  else
//    trending();
  if(Cookies.get('disableautocomplete')===undefined)
  {
    $('#q').typeahead({
      highlight:true,
      hint:false,
      minLength:1//(Cookies.get('disablerecentsearches')===undefined) ? 0 : 1
    },
  /*  {
      name:'domains',
      displayKey:'value',
      source:domains.ttAdapter(),
      templates:{
        suggestion:function(data){
          return '<p><img src="https://encrypted-tbn2.gstatic.com/faviconV2?url=https://www.'+escapeHtml(data.value)+'&client=chrome&size=32&type=FAVICON&fallback_opts=TYPE,SIZE,URL" onload="var img = new Image();img.src = this.src;if(img.height==16 && this.src.indexOf(\'?url=https://www.\')!==-1)this.src=this.src.replace(\'?url=https://www.\', \'?url=https://\');" /> <a href="http://'+data.value+'/" onclick="pagehide()">'+escapeHtml(data.value)+'</a></p>';
        }
      }
    },*/
    {
      name:'suggestions',
      displayKey:'value',
      source:suggestions.ttAdapter(),
      templates:{
        suggestion:function(data){
  //        return '<p '+((data.type=='recent') ? ' class="recent"' : '')+'>'+((data.type=='recent') ? '<i class="fa fa-clock-o" aria-hidden="true"></i>' : '<i class="fa fa-search" aria-hidden="true"></i>')+' '+escapeHtml(data.value)+'</p>';
          return '<p '+((data.type=='recent') ? ' class="recent"' : '')+'><img class="rounded me-1" src="https://th.bing.com/th?q='+encodeURIComponent(data.value).replaceAll('%20', '+')+'&w=42&h=42&c=7&rs=1&p=0&o=5&dpr=2&pid=1.7&mkt='+encodeURIComponent(language)+'&cc='+encodeURIComponent((COUNTRY=='uk') ? 'GB' : COUNTRY.toUpperCase())+'&setlang='+encodeURIComponent(LANG)+'&adlt=moderate&t=1" /> '+escapeHtml(data.value)+'</p>';
        }
      }
    }).on('typeahead:selected', function(ev, data){if(Cookies.get('debug')!==undefined)console.log(data);
      if(data.type!='domain')    // ################ change to type support later!!!!!!!!
        $('#search').submit();
      else
      {
        pagehide();
        window.location.href = 'http://'+data.value+'/';
        //window.open('http://'+data.value+'/', '_blank').opener = null;
        //document.getElementById('q').value = '';
        return false;
      }
    }).on('typeahead:close', function(ev, data){
//      $(this).prev().animate({scrollTop:0});
    });
  }
  if((!isTouch || (!isMobile.iOS() && !isMobile.Android())) && document.getElementById('q'))
    moveCursorToEnd();
  // Only do this on desktop keyboards
  if(!isMobile.any())
  {
    // Fix problem with autosuggestion selected if mouse around that area
    $('#q').on('keyup', function(ev){
      if(ev.which!==38 && ev.which!==40)
      {
        $('.tt-cursor').removeClass('tt-cursor');
        setTimeout(function(){
          $('.tt-cursor').removeClass('tt-cursor');
        }, 200);
        setTimeout(function(){
          $('.tt-cursor').removeClass('tt-cursor');
        }, 300);
        setTimeout(function(){
          $('.tt-cursor').removeClass('tt-cursor');
        }, 400);
      }
    });
  }
  $('#q').on('input', function(e){      
    if(document.getElementById('q').value=='')
      $('#search').removeClass('filled');
    else
      $('#search').addClass('filled');
  });
  var newfocus = false;
  $('#q').on('click', function(e){
    if(isMobile.any() && $(window).width()<=428 && e.target.value.length>20 && newfocus)
      moveCursorToEnd();
    newfocus = false;
    if($('.tt-dropdown-menu').css('display')=='none')
    {
      ev = $.Event('keydown');
      ev.keyCode = ev.which = 40;
      $(this).trigger(ev);
    }
  });
  $('#q').on('focus', function(e){
    newfocus = true;
  });
  $('#reset').on('click', function(e){
    document.getElementById('q').value = '';
    $('#search').removeClass('filled');
    if(Cookies.get('disableautocomplete')===undefined)
      $('#q').typeahead('val', '');    // Need this here, or else if you blur #q it will reset old value
    moveCursorToEnd();
  });
  $('#main').scroll(setmenu);
  $(window).resize(setmenu);
  setInterval(checkscroll, 100);

  // Renew cookies
  if(Cookies.get('disablesafesearch')!==undefined)
    Cookies.set('disablesafesearch', 1, {expires:365, path:'/'});
  if(Cookies.get('disableautocomplete')!==undefined)
    Cookies.set('disableautocomplete', 1, {expires:365, path:'/'});
  if(Cookies.get('disablerecentsearches')!==undefined)
    Cookies.set('disablerecentsearches', 1, {expires:365, path:'/'});
  if(Cookies.get('disabledefaultprompt')!==undefined)
    Cookies.set('disabledefaultprompt', 1, {expires:365, path:'/'});
  if(Cookies.get('disableinstagram')!==undefined)
    Cookies.set('disableinstagram', 1, {expires:365, path:'/'});
  if(Cookies.get('disabletwitter')!==undefined)
    Cookies.set('disabletwitter', 1, {expires:365, path:'/'});
  if(Cookies.get('enablebing')!==undefined)
    Cookies.set('enablebing', 1, {expires:365, path:'/'});
  if(Cookies.get('enabledark')!==undefined)
    Cookies.set('enabledark', 1, {expires:365, path:'/'});
});
// NEED TO FIX FOR RTL
// $(window).on('load', function (){
//  var bodyhtml = $('body').html();
//  $('#web > ol >li.result').first().after('<li class="list-group-item border-0 pt-0 pb-3 lh-sm"><div id="screenshot" class="border rounded-3"><iframe></iframe></div></li>');
//  $('#screenshot iframe').attr('srcdoc' , '<!doctype html><html><head>'+$('link[rel="stylesheet"]')[0].outerHTML+$('link[rel="stylesheet"]')[1].outerHTML+$('head style')[0].outerHTML+'</head><body id="iframe">'+bodyhtml.replace(/<script.+<\/script>/g, '').replace(/ onload="[^\""]+"/g, '')+'</body></html>');
// });
var htmlinstagram = '';
var htmltwitter = '';
function pagehide()
{
  // Needed for Firefox only
  // https://web.dev/bfcache/#only-add-beforeunload-listeners-conditionally
  if(navigator.userAgent.toLowerCase().indexOf('firefox')>-1 && $('#instagram').length)
  {
    if($('#instagram > ol').html()!='')
    {
      htmlinstagram = $('#instagram > ol').html();
      $('#instagram > ol').empty();
    }
    // Need this one because no iframes in Firefox https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/1.5/Using_Firefox_1.5_caching
    if($('#twitter > ol').html()!='')
    {
      htmltwitter = $('#twitter > ol').html();
      $('#twitter > ol').empty();
    }
  }
}
// Needed for Chrome only
// https://web.dev/bfcache/#only-add-beforeunload-listeners-conditionally
// Found also needed for Safari, it will blank Instagram iframes
if(!!window.chrome || navigator.userAgent.toLowerCase().indexOf('safari')>-1)
{
  window.addEventListener('beforeunload', (event)=>{
    if($('#instagram').length)
    {
      if($('#instagram > ol').html()!='')
      {
        htmlinstagram = $('#instagram > ol').html();
        $('#instagram > ol').empty();
      }
    }
  });
}
// Backup code if we don't get it in beforeunload, this hits only in Safari iOS for some reason... 
window.addEventListener('pagehide', (event)=>{
  if(event.persisted && $('#instagram').length && $('#instagram > ol > li').length)
  {
    if($('#instagram > ol').html()!='')
    {
      htmlinstagram = $('#instagram > ol').html();
      $('#instagram > ol').empty();
    }
  }
});
window.addEventListener('pageshow', (event)=>{
  if(event.persisted)
  {
    if($('#instagram').length)
      $('#instagram > ol').html(htmlinstagram);
    if(htmltwitter!='' && $('#twitter').length)
      $('#twitter > ol').html(htmltwitter);
    setTimeout(function(){
      // So when click back, the last original search shows, not what was last typed
      if(q)
        document.getElementById('q').value=q;
      if((!isTouch || (!isMobile.iOS() && !isMobile.Android())) && document.getElementById('q'))
        moveCursorToEnd();
    });
  }
});
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e){
  if(e.matches)
  {
    $('body').attr('data-theme', 'dark');
    $('#darktoggle').addClass('d-none');
    
  }
  else if(Cookies.get('enabledark')===undefined)
  {
    $('body').removeAttr('data-theme');
    $('#darktoggle').removeClass('d-none');
  }
  if($('#twitter').length)
    twitter('');    // Refresh, only way
});
function scrollto(el)
{
  $('#main').css('scroll-snap-type', 'none').animate(
    {scrollLeft:$('#main').scrollLeft()+$('#'+el.getAttribute('for')).offset().left},
    400,
    function(){$('#main').css('scroll-snap-type', 'x mandatory');}
  );
}
function setmenu()
{
  document.getElementById('main').style.height = window.innerHeight+'px';    // Fix for 100vh bug in Android https://chanind.github.io/javascript/2019/09/28/avoid-100vh-on-mobile-web.html
  document.querySelectorAll('#scrollto .btn').forEach((el)=>{
    var column = document.getElementById(el.getAttribute('for'));
    if(column)
    {
      var columnleft = column.getBoundingClientRect().left+document.body.scrollLeft;
      if(columnleft>=-16 && columnleft+320<=window.innerWidth)    // 16 is the padding, so it highlights faster on easing
        el.classList.add('active');
      else
        el.classList.remove('active');
    }
  });
}
// Only do this on desktop keyboards
if(!isMobile.any())
{
  document.onkeypress = function(e){
    e = e || window.event;
    if((e.keyCode==47 || e.keyCode==104) && document.activeElement.id!='q')
      setTimeout(function(){moveCursorToEnd();}, 100);
  };
}
</script>
</head>
<script>document.write('<body'+((!q) ? ' class="homepage"' : '')+(((window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) || Cookies.get('enabledark')!==undefined) ? ' data-theme="dark"' : '')+'>');</script>
 <nav class="navbar fixed-top navbar-expand">
    <div class="container-fluid px-3 pe-2">
      <a class="navbar-brand me-2" href="https://swurl.com/" onclick="pagehide()" tabindex="-1"><img class="logo" src="https://swurl.com/swurl.png" alt="Swurl" title="Swurl" width="32" height="32"></a>
      <form id="search" class="w-100" role="search" action="https://swurl.com/" method="get" onsubmit="if(document.getElementById('q').value==''){document.getElementById('q').focus(); return false;}">
        <script>document.write('<input type="text" name="q" id="q" class="form-control form-control-lg rounded-pill" placeholder="'+__('Search everything')+'" aria-label="'+__('Search everything')+'" value="'+((q) ? escapeHtml(q) : '')+'" autocapitalize="off" autocorrect="off" spellcheck="false" autocomplete="off"'+((LANG=='ar') ? ' dir="rtl"' : '')+'>');</script>
        <button type="button" id="reset" class="btn btn-lg position-absolute top-0 end-0 pt-2 pb-2 ps-1 pe-3" tabindex="-1" title="Clear"/><i class="fa-solid fa-xmark"></i></button>
        <button type="submit" class="btn btn-link btn-lg position-absolute top-0 start-0 pt-2 pb-2 ps-3 pe-0" tabindex="-1" title="Search"><i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i></button>
      </form>
      <script>if(q){$('#search').addClass('filled');}</script>
      <ul class="navbar-nav">
        <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"></a>
        <ul class="dropdown-menu dropdown-menu-end shadow">
          <li><a class="dropdown-item" href="https://swurl.com/default.html" onclick="pagehide()"><script>document.write(__('Set Swurl Search as default'));</script></a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="#safesearchtoggle" title="Filter out explicit content" onclick="if(Cookies.get('disablesafesearch')===undefined){Cookies.set('disablesafesearch', 1, {expires:365, path:'/'});location.reload();}else{Cookies.remove('disablesafesearch');location.reload();}return false;"><script>document.write(((Cookies.get('disablesafesearch')===undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' '+__('SafeSearch'));</script></a></li>
          <!--<li><a class="dropdown-item" href="#autocompletetoggle" title="Autocomplete" onclick="if(Cookies.get('disableautocomplete')===undefined){Cookies.set('disableautocomplete', 1, {expires:365, path:'/'});if(typeof localStorage!=='undefined')localStorage.removeItem('recentsearches');location.reload();}else{Cookies.remove('disableautocomplete');location.reload();}return false;"><script>document.write(((Cookies.get('disableautocomplete')===undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' '+__('Autocomplete'));</script></a></li>-->
          <li><a class="dropdown-item" href="#recentsearchestoggle" title="Use search history for autocomplete" onclick="if(Cookies.get('disablerecentsearches')===undefined){Cookies.set('disablerecentsearches', 1, {expires:365, path:'/'});if(typeof localStorage!=='undefined')localStorage.removeItem('recentsearches');location.reload();}else{Cookies.remove('disablerecentsearches');location.reload();}return false;"><script>document.write(((Cookies.get('disablerecentsearches')===undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' '+__('Personalization'));</script></a></li>
          <li><a class="dropdown-item" href="#instagramtoggle" title="Instagram enable/disable" onclick="if(Cookies.get('disableinstagram')===undefined){Cookies.set('disableinstagram', 1, {expires:365, path:'/'});location.reload();}else{Cookies.remove('disableinstagram');location.reload();}return false;"><script>document.write(((Cookies.get('disableinstagram')===undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' Instagram');</script></a></li>
          <li><a class="dropdown-item" href="#twittertoggle" title="Twitter enable/disable " onclick="if(Cookies.get('disabletwitter')===undefined){Cookies.set('disabletwitter', 1, {expires:365, path:'/'});location.reload();}else{Cookies.remove('disabletwitter');location.reload();}return false;"><script>document.write(((Cookies.get('disabletwitter')===undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' Twitter');</script></a></li>
          <li><a class="dropdown-item" href="#bingtoggle" title="Bing enable/disable " onclick="if(Cookies.get('enablebing')===undefined){Cookies.set('enablebing', 1, {expires:365, path:'/'});location.reload();}else{Cookies.remove('enablebing');location.reload();}return false;"><script>document.write(((Cookies.get('enablebing')!==undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' Bing');</script></a></li>
          <li><script>document.write('<a id="darktoggle" class="dropdown-item'+((window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) ? ' d-none' : '')+'" href="#darktoggle" title="Dark Mode enable/disable" onclick="if(Cookies.get(\'enabledark\')===undefined){Cookies.set(\'enabledark\', 1, {expires:365, path:\'/\'});location.reload();}else{Cookies.remove(\'enabledark\');location.reload();}return false;">'+((Cookies.get('enabledark')!==undefined) ? '<i class="fa-solid fa-toggle-on text-primary" aria-hidden="true"></i>' : '<i class="fa-solid fa-toggle-on text-body text-opacity-25" style="transform: scaleX(-1);" aria-hidden="true"></i>')+' '+__('Dark Mode'));</script></a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="https://swurl.com/about.html" onclick="pagehide()"><script>document.write(__('About Us'));</script></a></li>
          <li><a class="dropdown-item" href="https://swurl.com/terms.html" onclick="pagehide()"><script>document.write(__('Terms of Service'));</script></a></li>
          <li><a class="dropdown-item" href="https://swurl.com/privacy.html" onclick="pagehide()"><script>document.write(__('Privacy Policy'));</script></a></li>
        </ul>
        </li>
      </ul>
    </div>
  </nav>
  <ul id="scrollto" class="list-inline text-nowrap overflow-scroll mb-0 px-3 fixed-top"></ul>
  <script>document.write('<ul id="share" class="d-none d-md-block list-inline mb-0 ps-0 pe-3 position-fixed end-0" style="padding-top:6px;"><li class="list-inline-item small text-body text-opacity-50"><i class="fa-solid fa-heart text-danger"></i> '+__('Help Spread Swurl')+' <i class="fa-solid fa-arrow-'+((LANG=='ar') ? 'left' : 'right')+'"></i></li><li class="list-inline-item"><a class="btn btn-sm rounded-pill" style="display:block;padding:1px 0;width:25px;color:#fff;background-color:#1778f2;border-color:#1778f2;" role="button" href="https://www.facebook.com/dialog/share?app_id=651139363411277&href='+encodeURIComponent(window.location.href)+'&display=popup" rel="noopener" target="_blank"><i class="fa-brands fa-facebook-f"></i></a></li><li class="list-inline-item"><a class="btn btn-sm rounded-pill" style="display:block;padding:1px 0;width:25px;color:#fff;background-color:#1DA1F2;border-color:#1DA1F2;" role="button" href="https://twitter.com/intent/tweet?url='+encodeURIComponent(window.location.href)+'" rel="noopener" target="_blank"><i class="fa-brands fa-twitter"></i></a></li></ul>');</script>
  <main id="main" class="d-flex flex-nowrap"></main>
  <script>
    var updateversion='10';
//    var updatemessage = '<ul class="mb-1"><li>Question & People search intent added</li><li>Type / or h — go to search box</li><li><a href="https://swurl.com/?q=oblivion+trailer">Video</a> search intent added</li><li><a href="https://swurl.com/?q=apple+computer">Navigational</a> search intent added</li><li><a href="https://swurl.com/?q=best+laundry+detergent">Review</a> search intent added</li><li><span style="background-color:#333;color:#eee;">&nbsp;<strong>Dark Mode</strong>&nbsp;</span> support added!</li><li><a href="https://swurl.com/?q=chicken+recipes">Recipe</a>/<a href="https://swurl.com/?q=javascript+audio+player">Coding</a>/<a href="https://swurl.com/?q=intermittent+fasting">Health</a>/<a href="https://swurl.com/?q=Gabapentin">Medicine</a> added</li><li><a href="mailto:&#x73;&#x77;&#x75;&#x72;&#x6C;&#x68;&#x65;&#x6C;&#x70;&#x40;&#x70;&#x69;&#x63;&#x63;&#x6C;&#x69;&#x63;&#x6B;&#x2E;&#x63;&#x6F;&#x6D;?subject=Swurl"><strong>Email us</strong></a> - We <i class="fa-solid fa-heart text-danger"></i> your feedback!</li></ul>';
    var updatemessage = '<ul class="mb-1"><li>Share buttons added, but will hopefully<br>get screenshot images next...</li><li>Sort by date & other sorts now added</li><li><a href="https://swurl.com/?q=twitter">Twitter</a> search redesigned & improved</li><li><a href="mailto:&#x73;&#x77;&#x75;&#x72;&#x6C;&#x68;&#x65;&#x6C;&#x70;&#x40;&#x70;&#x69;&#x63;&#x63;&#x6C;&#x69;&#x63;&#x6B;&#x2E;&#x63;&#x6F;&#x6D;?subject=Swurl"><strong>Email us</strong></a> - We <i class="fa-solid fa-heart text-danger"></i> your feedback!</li></ul>';
// This messes up on Android...
    updatemessage = '';
    if(!q && Cookies.get('hideupdate'+updateversion)===undefined && updatemessage)
      document.write('<div class="ms-3 mb-0 alert alert-secondary alert-dismissible fade show small" role="alert"><h6><strong>Updates:</strong></h6>'+updatemessage+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" onclick="Cookies.set(\'hideupdate'+updateversion+'\', 1, {expires:90, path:\'/\'});"></button></div>');
  </script>
</body>
</html>
